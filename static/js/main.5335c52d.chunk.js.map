{"version":3,"sources":["assets/images/mylogo.png","assets/images/preloader1.gif","components/common/Preloader/Preloader.module.scss","assets/images/user.png","components/Profile/MyPosts/Post/Post.module.scss","components/common/FormsControls/FormsControls.module.scss","components/Navbar/Navbar.module.scss","components/common/utils/indexedDB.js","api/api.js","redux/auth-reducer.js","components/Header/Header.jsx","components/Navbar/Navbar.jsx","hoc/WithAuthRedirect.jsx","components/common/utils/quotes.js","redux/chats-reducer.js","components/common/Preloader/Preloader.js","components/common/utils/convertTime.js","components/common/FormsControls/FormsControls.jsx","utils/validators/validators.js","components/common/utils/backupQuotes.js","components/common/utils/object-helpers.js","redux/users-reducer.js","components/Users/User.jsx","components/common/Paginator/Paginator.jsx","components/Users/Users.jsx","redux/users-selectors.js","components/Users/UsersSearch.jsx","components/Users/UsersContainer.jsx","components/Chats/ChatItem/ChatItem.jsx","redux/chats-selector.js","redux/app-reducer.js","components/Chats/ChatsContainer.jsx","redux/profile-reducer.js","customHooks/hotEditing.jsx","components/Profile/ProfileInfo/ProfileStatusWithHooks.jsx","components/Profile/ProfileInfo/ProfileInfo.jsx","components/Profile/MyPosts/Post/Post.jsx","components/Profile/MyPosts/MyPosts.jsx","components/Profile/Profile.jsx","customHooks/reduceUnsafeMethods.jsx","components/Login/Login.jsx","components/Profile/UpdateDeleteProfile/UpdateProfile.jsx","components/Chats/Message/EditMessage.jsx","components/Chats/Message/Message.jsx","components/Chats/Message/CreateMessage.jsx","components/Chats/ChatItem/ChatDetail.jsx","App.js","serviceWorker.js","redux/sidebar-reducer.js","redux/redux-store.js","index.js","components/Profile/ProfileInfo/ProfileInfo.module.scss","components/Chats/Message/Message.module.scss","components/Profile/Profile.module.scss","components/Chats/Chats.module.scss","components/Profile/MyPosts/MyPosts.module.scss","components/Header/Header.module.scss","components/common/Paginator/paginator.module.scss","components/Users/Users.module.scss"],"names":["module","exports","dbPromise","openDB","upgrade","db","createObjectStore","idbKeyval","key","get","val","put","delete","getAllKeys","instance","axios","baseURL","headers","interceptors","request","use","config","a","token","error","Promise","reject","authAPI","login","password","console","log","post","profileAPI","userId","profileData","status","photo","usersAPI","getUsers","currentPage","query","follow","unfollow","getfollow","chatsAPI","chatPut","chatTypeId","chatId","putType","secondArgName","secondArg","putData","getChats","page","createChat","snusers","name","getChat","deleteChat","clearChat","clearType","this","renameChat","newChatName","updateUnreadMsgs","lastGlobalReadMsgId","toogleMemberStatusForConversation","addMemberForConversation","removeMemberFromConversation","removeMemberMsgsForConversation","removeOneMemberMsgForConversation","setChatPhoto","newChatPhoto","getMessages","readFromIndex","readFromIndexBefore","numOfDeletedMsgs","createMessage","messageBody","fileId","getFile","uploadFile","fileURL","fileName","editMessage","messageId","newMessageBody","deleteMessage","initialState","email","isAuth","setAuthUserData","type","payload","destructAUD","data","dispatchSAUD","dispatch","authReducer","state","action","Header","props","className","s","header","src","mylogo","loginBlock","onClick","logout","to","HeaderContainer","React","Component","connect","auth","Navbar","nav","item","activeClassName","activeLink","active","mapStateToPropsForRedirect","withAuthRedirect","WrappedComponent","RedirectComponent","replaceQuotes","string","JSON","parse","replace","chatsAliases","messages","chats","currentChat","isFetching","isUnmount","membersToSelect","readFromIndexNext","IsFetchingMsgs","loadingFilesIds","windowScrollOnMsgCreate","isMessageCreating","isRefreshedAfterMC","setCurrentChatMembers","members","setCurrentChatName","setCurrentChatPhoto","chatPhoto","setCurrentChatIdsToStore","currentChatDataFetching","saveImageToIDB","blobObj","urltoFile","url","filename","mimeType","fetch","then","res","arrayBuffer","buf","File","setChats","setMessages","setReadFromIndexes","setFetchingMoreMsgs","shouldWindowScrollDown","setMessageCreating","setRefreshMessageCreating","refreshCurrentChatData","method","requiredDataKey","parseInt","localStorage","getItem","response","resultCode","getChatHelper","chatArray","all","map","chat","id","chatTimeStamp","unfilteredArray","sort","chat1","chat2","getMessagesHelper","array","msg","isRefreshAfterMsgCreating","allKeysForImgs","allMsgs","items","tryIdbKey","includes","length","createMessageSnippent","message","stopSubmit","_error","clearChatTypes","cleared","clearChatMyLocal","clearChatMyGlobal","clearChatAllLocal","clearChatAllGlobal","createChatRequest","created","renameChatRequest","renamed","addMember","chatPutParts","bind","setChatPhotoRequest","apiMethod","onSuccStr","onSuccDataKey","onErrorStr","storeDispatchMethod","chatsReducer","nodm","idbFileMessageKey","body","Preloader","container","preloader","convertTime","unix_timestamp","time","Date","hours","getHours","mins","getMinutes","FormControl","input","meta","touched","warning","children","hasError","hasWarn","styles","formControl","TextArea","restProps","child","onCTRLEnt","onKeyUp","Input","FileInput","getBase64","file","resolve","reader","FileReader","readAsDataURL","onload","result","onerror","onFileChange","e","targetFile","target","files","onChange","fileInputKey","value","createField","placeholder","component","validators","text","Field","validate","ReduxFormSnippet","pristine","reset","submitting","sumbitButtonName","formSummaryError","disabled","requiredField","maxLength","max","undefined","maxLength30","maxLength50","maxLength200","maxLength1000","backupQuotes","stringify","updateObjectInArray","itmes","itemId","objPropName","newObjProps","users","pageSize","totalUsersCount","followingInProgress","setQuery","followUnfollowSuccess","userRelation","setUsers","setCurrentPage","setTotalUsersCount","count","toggleIsFetching","toggleFollowingProgress","searchUsers","totalCount","followUnfollowFlow","actionCreator","response2","usersReducer","l","filter","User","user","photos","small","userPhoto","some","ForChatUser","setSelectedForChatUsers","setSelectedForChatUser","selectedForChatUsers","chatUsersIds","styleForUser","userChoosePhoto","alt","selUserId","style","color","Paginator","totalItemsCount","onPageChanged","portionSize","pagesCount","Math","ceil","pages","i","push","portionCount","useState","portionNumber","setPortionNumber","leftPortionPageNumber","rightPortionPageNumber","paginator","p","cn","selectedPage","pageNumber","Users","forChat","styleForUsers","u","fWAUFC","clearCurrentFocusedWindow","createSelector","usersPage","getQuery","getPageSize","getTotalUsersCount","getCurrentPage","getIsFetching","getFollowingInProgress","UsersSearchReduxForm","reduxForm","form","handleSubmit","onSubmit","autoComplete","defaultValue","htmlFor","formData","search","UsersContainer","fWUFCID","compose","ChangeChatPhotoFormRedux","msgStyle","ChangeChatPhoto","newPhotoObject","RenameChatFormRedux","RenameChat","Member","member","memberStyle","chatMemberSettings","setMemberOperShow","setSelectedMember","memberName","memberPhoto","event","Members","membersShow","memberOperShow","selectedMember","memberOpers","styleMessages","chatsMembersActive","chatsMembers","smthElseListActive","smthElseList","memberOper","subElemMSBs","infoItemMSBs","membOperLink","SelectMemberToChat","getMemberList","stopPropagation","selectedForChatUser","usersForChatActive","userForChat","LastMessage","sended","authorName","chatLMAuthorName","chatLMAuthorNameDotted","chatLMBody","chatLMSended","ChatItem","lastMessage","getCountOfNewGlobalMsgs","chatType","setCurrentChatData","chatPhotoSmall","deleteChatRequest","clearChatByMethod","path","subElem2","addMemberHeader","chatItem","chatItemData","chatItemPhoto","Object","keys","chatItemNewMsgsNum","chatItemName","chatSettings","chatSettingsHeader","chatSettingsMembersListHeader","chatSettingsMembersList","smthElseHeader","subElem","infoItem","renameChatHeader","renameChatItem","changePhotoChat","addMemberItem","addFocusedWindow","selectChats","chatsPage","selectChatMessages","selectCTIPS","selectCIPS","selectCurrentChat","selectFocusedWindowsPS","app","focusedWindows","selectFocusedWindowsIdsPS","focusedWindowsIds","selectFocusedWindow","windowIdKey","find","window","selectFocusedWindowUsersForChat","selectFocusedWindowAddUserForChat","selectFocusedWindowMembersForChat","selectFocusedWindowMemberOperationsForChat","initialized","fWUsersFCId","fWAddUserFCId","fWMembersId","fWMemberOperationsId","newFocusedWindow","currentWindowId","appReducer","CreateChatReduxForm","chatsStyles","createChatForm","myUserId","OLDsnusers","usersToSelect","fWUFC","fWMFC","fWMOFC","setItem","unSetCurrentChatData","createDialog","createConversation","withRouter","iF","setIF","callbackMethod","useUsersSelector","useEffect","fetchData","setTimeout","chatsElements","chats_header","createChatHeader","toogleFocuseElem","chatsItems","posts","likesCount","profile","setUserProfile","setStatus","setUpdateUserProfile","getUserProfile","contacts","updateUserProfile","profileReducer","newPost","newPostText","postId","useHotEditing","startFieldValue","apiFunction","editMode","setEditMode","fieldValue","setFieldValue","isInvalid","setisInvalid","charCount","setCharCount","activateEditMode","deactivateEditMode","onFieldValueChange","every","valid","currentTarget","chars","currLen","ProfileStatusWithHooks","updateStatus","onStatusChange","ENSM","onDoubleClick","autoFocus","onBlur","ProfileInfo","updatePhoto","large","profile_info","landi_block","descriptionBlock","ava_block","username","userinfo","href","Post","AddNewPostFormRedux","profilePage","addPost","postsElements","postsBlock","myPostsHeader","createPost","deleteUserProfile","exchangeNotSafeMethods","setExchangeNotSafeMethods","shown","setShown","isReduced","useForbidUnsafeMethods","reduceMethods","match","params","history","profile_wrapper","LoginReduxForm","UpdateProfileReduxForm","lookingForAJob","lFAJ","setLFAJ","redux_form","checked","lookingForAJobDescription","fullname","github","vk","facebook","instagram","twitter","website","youtube","mainLink","profileRedirect","setProfileRedirect","addProfleFilledProperty","obj","prop","subObjects","start","startsWith","split","profileStyles","profile_update","profile_update_header","profProp","reduce","EditMessageActive","onMBChange","editedMessage","editField","errorField","countChars","EditMessageInactive","fileImageURL","loadFile","messageFile","fileImageDeactivate","fileImageActivate","EditMessage","fileIDBKey","loadImageFromIDB","setFIU","loadFromIdb","fileIDBValue","forwardRef","ref","inputRef","useRef","useImperativeHandle","node","current","editMessageRequest","deleteMessageRequest","downloadFile","messageAuthorName","authorId","messageSendedEdited","messageSended","messageEdited","edited","CreateMessageReduxForm","refSubmit","keyCode","ctrlKey","click","formButtons","createMessageRequest","fileUploadResponse","createMessageFormH","getMessageTagWithRef","refCondition","withNewMsgsTag","NMTRefCondition","newMsgsStartTag","local","_chatTypeId","_chatId","getCurrentChatData","isUpdated","toogleMemberStatus","removeMemberMsgs","removeOneMemberMsg","removeMember","downloadedFile","format","fileConv","isImage","upload","blob","URL","createObjectURL","saveAs","revokeObjectURL","ImgKey","_readFromIndexNext","_readFromIndex","oldMsgsDonwload","setOldMsgsDonwload","preFetch","setPreFetch","refToTopAtStart","setRTTAS","positioningScrollRefScroll","setPSRS","refOMDPSR","refAtStart","refToObserve","refreshIsRunning","setRIR","refLastMsg","ULTIMATE_CALLBACK","firstNewMsgID","scrollIntoView","steps","observer","IntersectionObserver","entries","forEach","entry","isIntersecting","innerText","unobserve","threshold","Array","fill","_","index","observe","nodeToScrollType","nodeToScroll","conditionNTS","nodeToObserve","scrollTop","scrollHeight","populatePreFetchData","sTOID","clearTimeout","fetchOldMsgs","beforeMsgsDiv","loadOldMsgsDiv","startChatDiv","dataToMsg","flat","unshift","chatMember","styleChats","selectedMemberId","chatsHeader","chatsHeaderPhoto","chatsHeaderPhotoAlt","chatsHeaderName","chatsHeaderSettings","chatsSettings","chatsSettingsItem","chatsSettingsItemH","chatsSettingsItemForm","createMessageForm","App","memo","initializeApp","clearAllFocusedWindows","render","Profile","exact","detail","catch","Boolean","location","hostname","sidebarReducer","reducers","combineReducers","sidebar","formReducer","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","store","createStore","applyMiddleware","thunkMiddleware","__store__","reactDebugHooks","ReactDOM","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.5335c52d.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/mylogo.cdc50227.png\";","module.exports = __webpack_public_path__ + \"static/media/preloader1.d5c02aa6.gif\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Preloader_container__2JuV0\"};","module.exports = __webpack_public_path__ + \"static/media/user.8b1dbb1f.png\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"item\":\"Post_item__3jvmD\",\"posts\":\"Post_posts__2fzGB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"formControl\":\"FormsControls_formControl__GCRRp\",\"error\":\"FormsControls_error__1SZfH\",\"warning\":\"FormsControls_warning__81yOC\",\"redux_form\":\"FormsControls_redux_form__3TVMV\",\"formButtons\":\"FormsControls_formButtons__2_HCy\",\"formSummaryError\":\"FormsControls_formSummaryError__1wuvH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"nav\":\"Navbar_nav__3btH3\",\"item\":\"Navbar_item__3SCzC\"};","// let db;\r\n// // let indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB\r\n// let dbReq = indexedDB.open('myDB', 1);\r\n// dbReq.onupgradeneeded = (event) => {\r\n//     // Зададим переменной db ссылку на базу данных\r\n//     db = event.target.result;\r\n//     // Создадим хранилище объектов с именем notes.\r\n//     let authorization = db.createObjectStore('authorization', { autoIncrement: true });\r\n// }\r\n// dbReq.onsuccess = (event) => {\r\n//     db = event.target.result;\r\n// }\r\n// dbReq.onerror = (event) => {\r\n//     console.log('error opening database ' + event.target.errorCode);\r\n// }\r\n\r\n\r\n// async function putSomeData() {\r\n//     let db = await idb.open('db-name', 1, upgradeDB => upgradeDB.createObjectStore('objectStoreName', { autoIncrement: true }))\r\n\r\n//     let tx = db.transaction('objectStoreName', 'readwrite')\r\n//     let store = tx.objectStore('objectStoreName')\r\n\r\n//     await store.put({ firstname: 'John', lastname: 'Doe', age: 33 })\r\n\r\n//     await tx.complete\r\n//     db.close()\r\n// }\r\n\r\n\r\n// async function getAllData() {\r\n//     let db = await idb.open('db-name', 1)\r\n\r\n//     let tx = db.transaction('objectStoreName', 'readonly')\r\n//     let store = tx.objectStore('objectStoreName')\r\n\r\n//     // add, clear, count, delete, get, getAll, getAllKeys, getKey, put\r\n//     let allSavedItems = await store.getAll()\r\n\r\n//     console.log(allSavedItems)\r\n\r\n//     db.close()\r\n// }\r\n\r\n\r\n// const setToken = (db, token) => {\r\n//     let tx = db.transaction(['authorization'], 'readwrite');\r\n//     let store = tx.objectStore('authorization');\r\n//     let tokenNote = { token: token };\r\n//     store.add(tokenNote);\r\n//     tx.oncomplete = () => {\r\n//         console.log('stored token!')\r\n//     }\r\n//     tx.onerror = (event) => {\r\n//         console.log('error storing token ' + event.target.errorCode);\r\n//     }\r\n// }\r\n\r\n// const getToken = (db) => {\r\n//     let tx = db.transaction(['authorization'], 'readonly');\r\n//     let store = tx.objectStore('authorization');\r\n//     let req = store.get('token');\r\n//     req.onsuccess = (event) => {\r\n//         let token = event.target.result;\r\n//         if (token) {\r\n//             return token\r\n//         } else {\r\n//         //   console.log(`token not found`)\r\n//         return null\r\n//         }\r\n//       }\r\n//       req.onerror = (event) => { // if user blocked to store in indexDB in browser\r\n//         console.log('error getting note' + event.target.errorCode);\r\n//       }\r\n// }\r\n\r\n// const clearToken = (db) => {\r\n//     let tx = db.transaction(['authorization'], 'readwrite');\r\n//     let store = tx.objectStore('authorization');\r\n//     const req = store.getKey('token');\r\n//     req.onsuccess = (event) => {  \r\n//         const key = req.result;\r\n//         // выполняем запрос на удаление указанной записи из хранилища объектов\r\n//         let deleteRequest = store.delete(key);\r\n//         deleteRequest.onsuccess = (event) => {\r\n//         // обрабатываем успех нашего запроса на удаление\r\n//         console.log('Delete request for token successful')\r\n//         };\r\n//     }\r\n// }\r\n\r\n// export const setAuthToken = (token) => {\r\n//     let oldToken = getToken(db)\r\n//     if(oldToken!==null){\r\n//         clearToken(db)\r\n//     }\r\n//     setToken(db, token)\r\n// }\r\n\r\n\r\n\r\n\r\n\r\nimport { openDB } from 'idb';\r\n \r\nconst dbPromise = openDB('keyval-store', 1, {\r\n  upgrade(db) {\r\n    db.createObjectStore('keyval');\r\n  },\r\n});\r\n \r\nexport const idbKeyval = {\r\n  async get(key) {\r\n    return (await dbPromise).get('keyval', key);\r\n  },\r\n  async set(key, val) {\r\n    return (await dbPromise).put('keyval', val, key);\r\n  },\r\n  async delete(key) {\r\n    return (await dbPromise).delete('keyval', key);\r\n  },\r\n  async clear() {\r\n    return (await dbPromise).clear('keyval');\r\n  },\r\n  async keys() {\r\n    return (await dbPromise).getAllKeys('keyval');\r\n  },\r\n};\r\n\r\n// idbKeyval.set('token', token)\r\n// let token = idbKeyval.get('token')","import * as axios from 'axios'\r\nimport { idbKeyval } from '../components/common/utils/indexedDB';\r\n\r\n\r\nconst instance = axios.create({\r\n    // baseURL: 'http://127.0.0.1:8000/',\r\n    baseURL: 'https://socnet97.herokuapp.com/',\r\n    headers: {\r\n        \"Content-type\": \"application/json\"\r\n      }\r\n})\r\n\r\ninstance.interceptors.request.use(\r\n    async (config) => {\r\n        // Do something before request is sent\r\n        let token = await idbKeyval.get('token')\r\n        // let token = localStorage.getItem('token') // if expired -> delete too\r\n        if (token){\r\n            config.headers[\"Authorization\"] = \"Bearer \" + token;\r\n        } else {\r\n            delete config.headers[\"Authorization\"]\r\n            // debugger\r\n        }\r\n        // console.log(config)\r\n        // debugger\r\n        return config;\r\n    },\r\n    error => {\r\n        Promise.reject(error);\r\n    }\r\n);\r\n\r\n\r\nexport const authAPI = {\r\n    me(){\r\n        return instance.get('api/auth/me/')\r\n    },\r\n    login(login, password){\r\n        console.log(login, '    ' , password)\r\n        return instance.post('api/auth/login/', {\"username\": login, \"password\": password})\r\n    },\r\n    signup(login, email, email2, password){\r\n        return instance.post('api/auth/register/', {\r\n        \"username\": login,\r\n        \"email\": email,\r\n        \"email2\": email2,\r\n        \"password\": password\r\n    })\r\n    }\r\n} \r\n\r\n\r\nexport const profileAPI = {\r\n    getProfile(userId){\r\n        return instance.get(`api/profile/${userId}/`)\r\n    },\r\n    // проверка на то что имена переменных будут заданы соответственно с АПИ\r\n    updateProfile(profileData){ // send here an object ( auto-sized update )\r\n        // let {name=null, slug=null, status=null, photos=null, lookingForAJob=null, lookingForAJobDescription=null, fullname=null, contacts=null} = profileData\r\n        return instance.put('api/profile/', profileData)\r\n    },\r\n    deleteProfile(){ // delete self profile -> so user too\r\n        return instance.delete('api/profile/')\r\n    },\r\n    // getStatus(userId){\r\n    //     return instance.get(`api/profile/status/${userId}`)\r\n    // },\r\n    updateStatus(status){\r\n        return instance.put('api/profile/status/', {'status': status}) // like {status:status}\r\n    },\r\n    // getPhoto(userId){\r\n    //     return instance.get(`api/profile/photo/${userId}`)\r\n    // },\r\n    updatePhoto(photo){\r\n        // getHeaders()\r\n        return instance.put('api/profile/photo/', {\"photos\": photo})\r\n    }\r\n}\r\n\r\n\r\nexport const usersAPI = {\r\n    getUsers(currentPage = 1, query=null){\r\n        // debugger // i dont know why i get query str -> then query==null /??????\r\n        console.log(`api/users?page=${currentPage}&q=${query}`) // dont use &count=${pageSize}\r\n        return query===null ? instance.get(`api/users?page=${currentPage}`) : instance.get(`api/users?page=${currentPage}&q=${query}`) \r\n    },\r\n    // getUser(userId){\r\n    //     return instance.get(`api/users/${userId}`)\r\n    // },\r\n    follow(userId){\r\n        // debugger\r\n        return instance.post(`api/follow/${userId}/`)\r\n    },\r\n    unfollow(userId){\r\n        return instance.delete(`api/follow/${userId}/`)\r\n    },\r\n    getfollow(userId){\r\n        return instance.get(`api/follow/${userId}/`)\r\n    }\r\n}\r\n\r\nexport const chatsAPI = {\r\n\r\n    chatPut(chatTypeId, chatId, putType, secondArgName, secondArg){\r\n        // debugger\r\n        let putData = {\"putType\": putType}\r\n        putData[secondArgName] = secondArg\r\n        return instance.put(`api/chats/${chatTypeId}/${chatId}/`, putData)\r\n    },\r\n\r\n\r\n    getChats(page, query){\r\n        return query===null ? \r\n            instance.get(`api/chats/?page=${page}`) :\r\n            instance.get(`api/chats/?page=${page}&query=${query}`)\r\n    },\r\n    createChat(snusers, name=null){ // snusers can be list of integers or integer\r\n        return name!==null ? \r\n                            instance.post('api/chats/create/', {snusers, name}) : \r\n                            instance.post('api/chats/create/', {snusers})\r\n    },\r\n    getChat(chatTypeId, chatId){ // chatTypeId = 0 - dialogs\r\n        return instance.get(`api/chats/${chatTypeId}/${chatId}/`)\r\n    },\r\n    deleteChat(chatTypeId, chatId){\r\n        return instance.delete(`api/chats/${chatTypeId}/${chatId}/`)\r\n    },\r\n    // TODO try to unify all calls below\r\n    clearChat(chatTypeId, chatId, putType, clearType){ \r\n        return this.chatPut(chatTypeId, chatId, putType, 'clearType', clearType) // 'clear'     clearType -> 'myLocal' 'myGlobal' 'allLocal' 'allGlobal' \r\n    },\r\n    renameChat(chatTypeId, chatId, putType, newChatName){ \r\n        return this.chatPut(chatTypeId, chatId, putType, 'newChatName', newChatName) // 'rename'\r\n    },\r\n    updateUnreadMsgs(chatTypeId, chatId, putType, lastGlobalReadMsgId){ // ---------------------------------------------------------------------------------------------\r\n        return this.chatPut(chatTypeId, chatId, putType, 'lastGlobalReadMsgId', lastGlobalReadMsgId) // 'updateUnreadMsgs'\r\n    },\r\n    // for conv only\r\n    toogleMemberStatusForConversation(chatTypeId, chatId, putType, userId){  // 'toogleMemberStatus'\r\n        return this.chatPut(chatTypeId, chatId, putType, 'userId', userId)\r\n    },\r\n    addMemberForConversation(chatTypeId, chatId, putType, userId){  // 'addMember'\r\n        return this.chatPut(chatTypeId, chatId, putType, 'userId', userId)\r\n    },\r\n    removeMemberFromConversation(chatTypeId, chatId, putType, userId){  // 'removeMember'\r\n        return this.chatPut(chatTypeId, chatId, putType, 'userId', userId)\r\n    },\r\n    removeMemberMsgsForConversation(chatTypeId, chatId, putType, userId){  // 'removeMemberMsgs'\r\n        return this.chatPut(chatTypeId, chatId, putType, 'userId', userId)\r\n    },\r\n    removeOneMemberMsgForConversation(chatTypeId, chatId, putType, userId){  // 'removeOneMemberMsg'\r\n        return this.chatPut(chatTypeId, chatId, putType, 'userId', userId)\r\n    },\r\n\r\n    setChatPhoto(chatTypeId, chatId, putType, newChatPhoto){ // putType = setChatPhoto // 'setChatPhoto'\r\n        return this.chatPut(chatTypeId, chatId, putType, 'newChatPhoto', newChatPhoto)\r\n    },\r\n\r\n    //messages\r\n    getMessages(chatTypeId, chatId, readFromIndex, readFromIndexBefore, query, numOfDeletedMsgs){\r\n        // console.log(query)\r\n        return  numOfDeletedMsgs === null ?\r\n            query===null ?\r\n            instance.get(`api/chats/${chatTypeId}/${chatId}/messages/?readFromIndex=${readFromIndex}&readFromIndexBefore=${readFromIndexBefore}`) :\r\n            instance.get(`api/chats/${chatTypeId}/${chatId}/messages/?readFromIndex=${readFromIndex}&readFromIndexBefore=${readFromIndexBefore}&query=${query}`) \r\n            :\r\n            query===null ?\r\n            instance.get(`api/chats/${chatTypeId}/${chatId}/messages/?readFromIndex=${readFromIndex}&readFromIndexBefore=${readFromIndexBefore}&numOfDeletedMsgs=${numOfDeletedMsgs}`) :\r\n            instance.get(`api/chats/${chatTypeId}/${chatId}/messages/?readFromIndex=${readFromIndex}&readFromIndexBefore=${readFromIndexBefore}&query=${query}&numOfDeletedMsgs=${numOfDeletedMsgs}`) \r\n            // instance.get(`api/chats/${chatTypeId}/${chatId}/messages/?page=${page}`) :\r\n            // instance.get(`api/chats/${chatTypeId}/${chatId}/messages/?page=${page}&query=${query}`)\r\n    },\r\n    createMessage(chatTypeId, chatId, messageBody, fileId=null){\r\n        // console.log({messageBody, fileId})\r\n        return instance.post(`api/chats/${chatTypeId}/${chatId}/messages/create/`, {messageBody, fileId})\r\n    },\r\n\r\n\r\n    // uploadFile(file){\r\n    //     let formData = new FormData();\r\n    //     formData.append(\"file\", file);\r\n    //     return instance.post(`api/file/`, formData, {\r\n    //         headers: {\r\n    //             \"Content-Type\": \"multipart/form-data\",\r\n    //           }\r\n    //         //   ,\r\n    //         //   onUploadProgress,\r\n    //     })\r\n    // },\r\n\r\n    // can ask for files only from current chat to load \r\n    getFile( fileId ) {\r\n        return instance.get(`api/files/${fileId}`);\r\n    },\r\n    // downloadFile(filePath) {\r\n    //     return instance.get(`media/${filePath}`);\r\n    // },\r\n\r\n\r\n    // may just change it to json file:blob\r\n    // uploadFile( file ){\r\n    //     let formData = new FormData();\r\n    //     formData.append(\"file\", file);\r\n    //     return instance.post(`api/files/`, formData, {\r\n    //         headers: {\r\n    //             \"Content-Type\": \"multipart/form-data\",\r\n    //           }\r\n    //     })\r\n    // },\r\n    uploadFile( fileURL, fileName ){\r\n        return instance.post(`api/files/`, {fileURL, fileName})\r\n    },\r\n    // TIP there is problems\r\n    // uploadFile( file, onUploadProgress ){\r\n    //         let formData = new FormData();\r\n    //         formData.append(\"file\", file);\r\n    //         return instance.post(`api/files/`, formData, {\r\n    //             headers: {\r\n    //                 \"Content-Type\": \"multipart/form-data\",\r\n    //               }\r\n    //               ,\r\n    //               onUploadProgress,\r\n    //         })\r\n    //     },\r\n\r\n\r\n    editMessage(chatTypeId, chatId, messageId, newMessageBody){\r\n        // debugger\r\n        console.log(`api/chats/${chatTypeId}/${chatId}/messages/${messageId}/`)\r\n        console.log({newMessageBody})\r\n        return instance.put(`api/chats/${chatTypeId}/${chatId}/messages/${messageId}/`, {newMessageBody})\r\n    },\r\n    deleteMessage(chatTypeId, chatId, messageId){\r\n        return instance.delete(`api/chats/${chatTypeId}/${chatId}/messages/${messageId}/`)\r\n    },\r\n}\r\n\r\n// if there is no yet msgs\r\n// looks like there is no messages in chat yet\r\n// MyConversationMessage has no globalMsg.\r\n// looks like there is no messages in chat yet\r\n// MyConversationMessage has no globalMsg.","// // import Axios from 'axios';\r\n\r\nimport { usersAPI } from \"../api/api\";\r\n\r\n// // let sendSignUpRequest = (username, email, email2, password) => {\r\n// //     // no obtained tokens ( cause only register // not login )\r\n// //     let signup_data =\r\n// //     {\r\n// //         \"username\": username,\r\n// //         \"email\": email,\r\n// //         \"email2\": email2,\r\n// //         \"password\": password\r\n// //     }\r\n// //     // link // data // config {headers} == 0\r\n// //     Axios.post(`http://127.0.0.1:8000/api/auth/register/`, signup_data).then(response => {\r\n// //         console.log(response.data);\r\n// //         return response.data;\r\n// //         // return { \"username\": response.data.username, \"email\": response.data.email};\r\n\r\n// //     }).catch(function (error) { // errror impossible // cause always positive answers with status_code 200_ok\r\n// //         console.log(error);\r\n// //         return {};\r\n// //     });\r\n// //     // we always can handle email and username from response.data and error.data from \r\n// //     }\r\n\r\n// // let sendIsLoginRequest = (token) => {\r\n// //     let config = {\r\n// //         headers: {\r\n// //             'Authorization': 'Bearer ' + token\r\n// //           }\r\n// //         }\r\n// //     // link // data // config {headers} == 0\r\n// //     Axios.post(`http://127.0.0.1:8000/api/auth/me/`, config).then(response => {\r\n// //         console.log(response.data);\r\n// //         return response.data;\r\n\r\n// //     }).catch(function (error) {\r\n// //         console.log(error);\r\n// //         return {};\r\n// //     });\r\n// //     }\r\n\r\n// // let sendLoginRequest = (username,  password) => {\r\n// //     let login_data =\r\n// //     {\r\n// //         \"username\": username,\r\n// //         \"password\": password\r\n// //     }\r\n// //     // link // data // config {headers} == 0\r\n// //     return Axios.post(`http://127.0.0.1:8000/api/auth/login/`, login_data);\r\n// //     }\r\n\r\n// import Cookies from 'js-cookie';\r\n\r\n// const SIGNUP = 'SIGNUP';\r\n// const LOGIN = 'LOGIN';\r\n// // const IS_LOGIN = 'IS_LOGIN';\r\n\r\n// const SET_USERNAME = 'SET_USERNAME';\r\n// const SET_EMAIL = 'SET_EMAIL';\r\n// const SET_EMAIL2 = 'SET_EMAIL2';\r\n// const SET_PASSWORD = 'SET_PASSWORD';\r\n\r\n// const TOGGLE_IS_FETCHING = 'TOGGLE_IS_FETCHING';\r\n// const SET_REDIRECT_LOGIN = 'SET_REDIRECT';\r\n// const SET_REDIRECT_SIGNUP = 'SET_REDIRECT_SIGNUP';\r\n// const SET_REDIRECT_LOGOUT = 'SET_REDIRECT_LOGOUT'; \r\n\r\n// const DROP_STATE = 'DROP_STATE';\r\n\r\n// // const SET_COOKIES = 'SET_COOKIES';\r\n\r\n// let initialState = {\r\n//     // auth data ( that will be nulled after operation )\r\n//     username: '',\r\n//     email: '',\r\n//     email2: '',\r\n//     password: '',\r\n//     // resident data \r\n//     token: Cookies.get('token') || null,\r\n//     userId: Cookies.get('userId') || null,\r\n\r\n//     // invalidSignUpData: false, // signup // not appropriate data (or not all data)\r\n//     // invalidLoginData: false, // login // not appropriate data (or not all data)\r\n\r\n//     // userAlreadyExists: false, // signup //  unique field email or username wasnt passed\r\n//     // mailAlreadyRegistered: false, // signup //  unique field email or username wasnt passed\r\n//     // // isFetching: true,\r\n//     // fatalError: false\r\n//     errorMessage: null,\r\n\r\n//     isFetching: false,\r\n//     redirect_login: null,\r\n//     redirect_signup: null,\r\n//     redirect_logout: null\r\n// };\r\n\r\n\r\n// const authReducer = (state = initialState, action) => {\r\n\r\n//     switch(action.type) {\r\n//         case DROP_STATE:\r\n//             return {\r\n//                 ...state,\r\n//                 username: '',\r\n//                 email: '',\r\n//                 email2: '',\r\n//                 password: '',\r\n//                 token: null,\r\n//                 userId: null,\r\n//                 errorMessage: null,\r\n//                 isFetching: false,\r\n//                 redirect_login: null,\r\n//                 redirect_signup: null,\r\n//                 redirect_logout: null\r\n//             }\r\n\r\n//         case SET_USERNAME:\r\n//             return { ...state, username: action.username}\r\n//         case SET_EMAIL:\r\n//             return { ...state, email: action.email}\r\n//         case SET_EMAIL2:\r\n//             return { ...state, email2: action.email2}\r\n//         case SET_PASSWORD:\r\n//             return { ...state, password: action.password}\r\n\r\n\r\n\r\n//         // case SIGNUP:\r\n//         //     {\r\n//         //     let response = sendSignUpRequest(state.username, state.email, state.email2, state.password);\r\n//         //     if ('username' in response && 'email' in response){\r\n//         //         if (!Array.isArray(response.username) && !Array.isArray(response.email)){\r\n//         //             return { ...state, username: '', email: '', email2: '', password: '', errorMessage: null}; // чтобы не хранить в стейте постоянно все данные кроме токена (который получим потом)\r\n//         //         }\r\n//         //     }\r\n//         //     // can contain username and email or both\r\n//         //     // Оператор опциональной последовательности ?.\r\n//         //     return { ...state, errorMessage: {username: response.username?.[0], email: response.email?.[0]}}; // it will just undef if there is no email or no username\r\n//         //     }\r\n\r\n\r\n//             // if ('username' in response && 'email' in response){\r\n//             //     if (!Array.isArray(response.username) && !Array.isArray(response.email)){\r\n//             //         return { ...state, invalidSignUpData: false, userAlreadyExists: false, mailAlreadyRegistered: false, fatalError: false }; // обнулим все ерроры шоб можно было перейти на логин\r\n//             //     } else if (Array.isArray(response.username) && Array.isArray(response.email)){\r\n//             //         return { ...state, userAlreadyExists: true, mailAlreadyRegistered: true };\r\n//             //     } else {\r\n//             //         return { ...state, fatalError: true }; // cannot be one field str and another list\r\n//             //     }\r\n//             // } else if ('username' in response){\r\n//             //     if (Array.isArray(response.username)){\r\n//             //         // that means that this is an error message only in username\r\n//             //         return { ...state, userAlreadyExists: true };\r\n//             //     } else {\r\n//             //         return { ...state, fatalError: true }; // cannot be only username in positive signup return\r\n//             //     }\r\n//             // } else if ('email' in response){\r\n//             //     if (Array.isArray(response.email)){\r\n//             //         // that means that this is an error message only in email\r\n//             //         return { ...state, mailAlreadyRegistered: true };\r\n//             //     } else {\r\n//             //         return { ...state, fatalError: true }; // cannot be only email in positive signup return\r\n//             //     }\r\n//             // } else {\r\n//             //     return { ...state, fatalError: true };\r\n//             // }\r\n//         case SIGNUP:\r\n//             {\r\n//                 // if \r\n//                 // let send = sendLoginRequest(state.username, state.password);\r\n//                 if (action.errorMessage === null){\r\n//                     return { ...state, email: '', email2: '', errorMessage: action.errorMessage, username: '', password: '' }; //  зануляем еррор и кредишнлс\r\n//                 } else {\r\n//                     return { ...state, errorMessage: action.errorMessage }; //  зануляем токен и юзер ид\r\n//                 }\r\n//             }\r\n//         case LOGIN:\r\n//             {\r\n//                 if (action.errorMessage === null){\r\n//                     return { ...state, token: action.token, userId: action.userId, errorMessage: action.errorMessage, username: '', password: '' }; //  зануляем еррор и кредишнлс\r\n//                 } else {\r\n//                     return { ...state, token: action.token, userId: action.userId, errorMessage: action.errorMessage }; //  зануляем токен и юзер ид\r\n//                 }\r\n//             }\r\n//         case TOGGLE_IS_FETCHING:\r\n//             return {...state, isFetching: action.isFetching}\r\n//         case SET_REDIRECT_LOGIN:\r\n//             return {...state, redirect_login: action.redirect_login}\r\n//         case SET_REDIRECT_SIGNUP:\r\n//                 return {...state, redirect_signup: action.redirect_signup}\r\n//         case SET_REDIRECT_LOGOUT:\r\n//                     return {...state, redirect_logout: action.redirect_logout}\r\n//         default:\r\n//             return state;\r\n//     }\r\n// }\r\n\r\n\r\n// export const signup = (errorMessage) => ({type: SIGNUP, errorMessage});\r\n// export const login = (token, userId, errorMessage) => ({type: LOGIN, token, userId, errorMessage});\r\n\r\n\r\n\r\n// export const setUsername = (username) => ({type: SET_USERNAME, username});\r\n// export const setEmail = (email) => ({type: SET_EMAIL, email});\r\n// export const setEmail2 = (email2) => ({type: SET_EMAIL2, email2});\r\n// export const setPassword = (password) => ({type: SET_PASSWORD, password});\r\n\r\n// export const toggleIsFetching = (isFetching) => ({type: TOGGLE_IS_FETCHING, isFetching});\r\n\r\n// export const setRedirectLogin = (redirect_login) => ({type: SET_REDIRECT_LOGIN, redirect_login});\r\n// export const setRedirectSignUp = (redirect_signup) => ({type: SET_REDIRECT_SIGNUP, redirect_signup});\r\n\r\n// export const setRedirectLogout = (redirect_logout) => ({type: SET_REDIRECT_LOGOUT, redirect_logout});\r\n\r\n\r\n// export const dropState = () => ({type: DROP_STATE});\r\n\r\n\r\n// export default authReducer;\r\n\r\n\r\n// // email // email2 // password\r\n\r\n\r\nimport {authAPI} from \"../api/api\";\r\nimport { stopSubmit } from \"redux-form\";\r\nimport { idbKeyval } from \"../components/common/utils/indexedDB\";\r\n\r\nconst SET_USER_DATA = 'my-app/auth/SET_USER_DATA';\r\n\r\n\r\nlet initialState = {\r\n    userId: null,\r\n    email: null,\r\n    login: null,\r\n    isAuth: false,\r\n    // tokenError: false\r\n};\r\n\r\nconst authReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case SET_USER_DATA:\r\n            return {\r\n                ...state,\r\n                ...action.payload\r\n            }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\n\r\nexport const setAuthUserData = (userId, email, login, isAuth) => ({type: SET_USER_DATA, payload:{userId, email, login, isAuth}})\r\n\r\nlet destructAUD = (data) => {\r\n    // debugger\r\n    return [data.userId, data.email, data.login]\r\n}\r\nlet dispatchSAUD = (dispatch, data, isAuth=true) => {\r\n    return dispatch(setAuthUserData(...destructAUD(data), isAuth))\r\n}\r\n\r\n\r\nexport const getAuthUserData = () => async(dispatch) => {\r\n    let response = await authAPI.me()\r\n    // debugger\r\n    if(\"detail\" in response.data){\r\n        if([\"Signature has expired.\", \"Error decoding signature.\", \"Invalid Authorization header. No credentials provided.\"].includes(response.data.detail)){\r\n            console.log(response.data.detail)\r\n            // dispatch(setAuthUserData(null, null, null, false, true))\r\n        } else {\r\n            console.log('its amaizing error - server error')\r\n        }\r\n    } else {\r\n        if(response.data.resultCode === 0){\r\n            dispatchSAUD(dispatch, response.data.data)\r\n        }\r\n    }\r\n    return response\r\n}\r\n\r\nexport const login = (login, password) => async(dispatch) => {\r\n    // console.log(login)\r\n    // console.log(password)\r\n    // delete localStorage['token']\r\n    await idbKeyval.delete('token')\r\n    let response = await authAPI.login(login, password)\r\n    if (response.data.resultCode === 0){\r\n        // console.log('3')\r\n        // localStorage.setItem('token', response.data.data.token)\r\n        await idbKeyval.set('token', response.data.data.token)\r\n        // localStorage.setItem('userId', response.data.data.userId)\r\n        // console.log('4')\r\n        dispatchSAUD(dispatch, response.data.data) // here we set user auth data ( but we dont call any api calls with token yet)\r\n        // console.log('5')\r\n    } else {\r\n        let message = response.data.messages.length  ? response.data.messages[0] : 'Some error';\r\n        dispatch(stopSubmit(\"login\", {_error: message}));\r\n    }\r\n}\r\n\r\n// or async type????\r\nexport const logout = () => async(dispatch) => {\r\n    // we just cant logout from API server ( we can do this on frontend by deleting our localStorage TOKEN  - thats all folks)\r\n    // localStorage.setItem('token', null)\r\n    // delete localStorage['token']\r\n    await idbKeyval.delete('token')\r\n    // delete localStorage['userId']\r\n    // localStorage.setItem('userId', null)\r\n    dispatch(setAuthUserData(null, null, null, false, false))\r\n}\r\n\r\nexport const signup = (login, password) => async(dispatch) => {\r\n    let response = await authAPI.signup(login, password)\r\n    if (response.data.resultCode !== 0){\r\n        let message = response.data.messages.length  ? response.data.messages[0] : 'Some error';\r\n        dispatch(stopSubmit(\"signup\", {_error: message}));\r\n    }\r\n}\r\n\r\n\r\n\r\nexport default authReducer","import React from 'react';\r\n// import Header from \"./Header\";\r\nimport {connect} from \"react-redux\";\r\nimport {logout} from \"../../redux/auth-reducer\";\r\n\r\nimport s from './Header.module.scss';\r\nimport {NavLink} from \"react-router-dom\";\r\nimport mylogo from '../../assets/images/mylogo.png';\r\nconst Header = (props) => {\r\n    return <header className={s.header}>\r\n        <img src={mylogo}/>\r\n\r\n        { props.isAuth ? \r\n        <div className={s.loginBlock}>{props.login} - <a onClick={props.logout}>Logout</a></div>\r\n                        : \r\n        <div className={s.loginBlock}><NavLink to={'/login'}>Login</NavLink></div> \r\n        }\r\n    \r\n\r\n    </header>\r\n}\r\n\r\n// export default Header;\r\n\r\n\r\nclass HeaderContainer extends React.Component {\r\n    // componentDidMount() {\r\n    //   this.props.getAuthUserData();\r\n    // }\r\n\r\n    render() {\r\n        return <Header {...this.props} />\r\n    }\r\n}\r\nconst mapStateToProps = (state) => ({\r\n    login: state.auth.login,\r\n    isAuth: state.auth.isAuth,\r\n});\r\n\r\nexport default connect(mapStateToProps, {logout})(HeaderContainer);","import React from 'react';\r\nimport s from './Navbar.module.scss';\r\nimport {NavLink} from \"react-router-dom\";\r\n\r\nconst Navbar = () => {\r\n    return (\r\n        <nav className={s.nav}>\r\n            <div className={s.item}>\r\n                <NavLink to=\"/profile\" activeClassName={s.activeLink}>Profile</NavLink>\r\n            </div>\r\n            <div className={`${s.item} ${s.active}`}>\r\n                <NavLink to=\"/users\" activeClassName={s.activeLink}>Users</NavLink>\r\n            </div>\r\n            <div className={`${s.item} ${s.active}`}>\r\n                <NavLink to=\"/chats\" activeClassName={s.activeLink}>Chats</NavLink>\r\n            </div>\r\n            {/* <div className={`${s.item} ${s.active}`}>\r\n                <NavLink to=\"/dialogs\" activeClassName={s.activeLink}>Messages</NavLink>\r\n            </div>\r\n            <div className={`${s.item} ${s.active}`}>\r\n                <NavLink to=\"/users\" activeClassName={s.activeLink}>Users</NavLink>\r\n            </div>\r\n            <div className={s.item}>\r\n                <a>News</a>\r\n            </div>\r\n            <div className={s.item}>\r\n                <a>Music</a>\r\n            </div>\r\n            <div className={s.item}>\r\n                <a>Settings</a>\r\n            </div> */}\r\n\r\n            <div className={`${s.item} ${s.active}`}>\r\n                <NavLink to=\"/login\" activeClassName={s.activeLink}>Login</NavLink>\r\n            </div>\r\n            {/* <div className={`${s.item} ${s.active}`}>\r\n                <NavLink to=\"/logout\" activeClassName={s.activeLink}>Logout</NavLink>\r\n            </div> */}\r\n\r\n        </nav>\r\n    )\r\n}\r\n\r\nexport default Navbar;","import React from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport {Redirect} from \"react-router-dom\";\r\n\r\nlet mapStateToPropsForRedirect = (state) => ({\r\n    isAuth: state.auth.isAuth,\r\n    userId: state.auth.userId\r\n});\r\n\r\nconst withAuthRedirect = (WrappedComponent) =>  {\r\n\r\n    class RedirectComponent extends React.Component{\r\n        // constructor(props){\r\n        //     super(props);\r\n        // }\r\n        render() {\r\n            // debugger\r\n            if (!this.props.isAuth) return <Redirect to='/login' />\r\n            return <WrappedComponent {...this.props} />\r\n        }\r\n    }\r\n    return connect(mapStateToPropsForRedirect)(RedirectComponent);\r\n}\r\n\r\nexport default withAuthRedirect;\r\n\r\n// export default connect(mapStateToPropsForRedirect)(withAuthRedirect);","const replaceQuotes = (string) => {\r\n    // debugger\r\n    string = JSON.parse(string.replace(/'/g, '\"'));\r\n    return string;\r\n};\r\nexport default replaceQuotes","import { chatsAPI, usersAPI } from \"../api/api\";\r\nimport { stopSubmit, reset } from \"redux-form\";\r\nimport replaceQuotes from \"../components/common/utils/quotes\";\r\nimport { idbKeyval } from \"../components/common/utils/indexedDB\";\r\nimport {saveAs} from \"file-saver\";\r\n\r\nconst SET_CHATS = 'SET_CHATS';\r\nconst SET_CHATS_ALIAS_MAP = 'SET_CHATS_ALIAS_MAP';\r\nconst SET_MESSAGES = 'SET_MESSAGES';\r\nconst SET_CURRENT_CHAT_DATA = 'SET_CURRENT_CHAT_DATA';\r\nconst EDIT_MESSAGE = 'EDIT_MESSAGE';\r\n\r\nconst CURRENT_CHAT_DATA_FETCHING = 'CURRENT_CHAT_DATA_FETCHING';\r\nconst TOOGLE_IS_UNMOUNT = 'TOOGLE_IS_UNMOUNT';\r\n\r\n// const ADD_USERS_TO_SELECT = 'ADD_USERS_TO_SELECT'\r\nconst SET_CURRENT_CHAT_MEMBERS ='SET_CURRENT_CHAT_MEMBERS'\r\nconst SET_CURRENT_CHAT_PHOTO = 'SET_CURRENT_CHAT_PHOTO'\r\nconst SET_CURRENT_CHAT_NAME = 'SET_CURRENT_CHAT_NAME'\r\n\r\n\r\n// const SET_READ_FROM_INDEX = 'SET_READ_FROM_INDEX'\r\n// const SET_READ_FROM_INDEX_NEXT = 'SET_READ_FROM_INDEX_NEXT'\r\nconst SET_READ_FROM_INDEXES = 'SET_READ_FROM_INDEXES'\r\n// const SET_LOADING_ON_SCROLL = 'SET_LOADING_ON_SCROLL'\r\nconst SET_FETCHING_MSGS = 'SET_FETCHING_MSGS'\r\n\r\n// const SET_OLD_MSGS_DOWNLOAD = 'SET_OLD_MSGS_DOWNLOAD'\r\n\r\n// const SET_FIRST_OF_LAST_SET_MSGS_ID = 'SET_FIRST_OF_LAST_SET_MSGS_ID'\r\n// const SET_FIRST_OF_SET_MSGS_ID = 'SET_FIRST_OF_SET_MSGS_ID'\r\n\r\n// const SET_FIRST_AND_LAST_OF_SET_MSGS_ID = 'SET_FIRST_AND_LAST_OF_SET_MSGS_ID'\r\n// const SET_PREFETCH_CC = 'SET_PREFETCH_CC'\r\n// const ADD_FILE_AS_LOADING = 'ADD_FILE_AS_LOADING'\r\n// const REMOVE_FILE_AS_LOADING = 'REMOVE_FILE_AS_LOADING'\r\n\r\nconst SHOULD_WINDOW_SCROLL_DOWN = 'SHOULD_WINDOW_SCROLL_DOWN'\r\nconst SET_MESSAGE_CREATING = 'SET_MESSAGE_CREATING'\r\nconst SET_REFRESH_AFTER_MESSAGE_CREATING = 'SET_REFRESH_AFTER_MESSAGE_CREATING'\r\n\r\n\r\n// // const SET_REFRESH_AFTER_DM = 'SET_REFRESH_AFTER_DM' \r\nconst INC_NUM_OF_DELETED_MSGS = 'INC_NUM_OF_DELETED_MSGS'\r\nconst NULL_NUM_OF_DELETED_MSGS = 'NULL_NUM_OF_DELETED_MSGS'\r\n\r\nconst SET_IDB_KEY_IN_MESSAGE = 'SET_IDB_KEY_IN_MESSAGE'\r\n\r\nlet initialState = {\r\n    chatId: null,\r\n    chatTypeId: null,\r\n    chatsAliases: [],\r\n    messages: [],\r\n    chats: [], //  \"dialogs\": [{\"id\": 1,\"name\": \"Mexus_1\"}],\"conversations\": [{ \"id\": 1,\"name\": \"HERE WE GO AGAIN\" }]\r\n    // messages: [], \r\n    // newMessageBody: \"\"\r\n    currentChat: null, // + 'readFromIndex'\r\n    isFetching: false,\r\n    isUnmount: false,\r\n\r\n    // usersToSelect: [],\r\n\r\n    membersToSelect: [],\r\n\r\n    readFromIndex: null,\r\n    readFromIndexNext: null,\r\n    readFromIndexBefore: null,\r\n    // loadingOnScroll: true,\r\n    IsFetchingMsgs: false,\r\n    loadingFilesIds: [],\r\n\r\n    // oldMsgsDonwload: false,\r\n\r\n    // firstOfLastSetOfMsgsId: null,\r\n    // firstOfSetOfMsgsId: null,\r\n\r\n\r\n    windowScrollOnMsgCreate: false,\r\n    // preFetchCC: false,\r\n    isMessageCreating: false,\r\n\r\n    isRefreshedAfterMC: false,\r\n\r\n    // isRefreshedAfterDM: false,\r\n    numOfDeletedMsgs: 0,\r\n};\r\n\r\n\r\nconst chatsReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n\r\n        case INC_NUM_OF_DELETED_MSGS: {\r\n            let nodm = state.numOfDeletedMsgs + 1\r\n            return {...state, numOfDeletedMsgs: nodm} // SET_NUM_OF_DELETED_MSGS\r\n        }\r\n        case NULL_NUM_OF_DELETED_MSGS: {\r\n            let nodm = 0\r\n            return {...state, numOfDeletedMsgs: nodm} // SET_NUM_OF_DELETED_MSGS\r\n        }\r\n\r\n\r\n\r\n        case SET_CHATS: {\r\n            return {...state, chats: action.chats} //\r\n        }\r\n        case SET_CHATS_ALIAS_MAP: {\r\n            return {...state, chatsAliases: action.chatsAliases}\r\n        }\r\n        case SET_MESSAGES: {\r\n            return {...state, messages: action.messages}\r\n        }\r\n        case SET_CURRENT_CHAT_DATA: {\r\n            return {...state, chatId: action.chatId, chatTypeId: action.chatTypeId, currentChat: action.currentChat}\r\n        }\r\n        case TOOGLE_IS_UNMOUNT: {\r\n            return {...state, isUnmount: action.isUnmount}\r\n        }\r\n\r\n        case CURRENT_CHAT_DATA_FETCHING: {\r\n            return {...state, isFetching: action.isFetching}\r\n        }\r\n\r\n        case SET_CURRENT_CHAT_MEMBERS: {\r\n            return {...state, currentChat: {...state.currentChat, members: action.members}}\r\n        }\r\n        case SET_CURRENT_CHAT_NAME: {\r\n            return {...state, currentChat: {...state.currentChat, name: action.name}}\r\n        }\r\n        case SET_CURRENT_CHAT_PHOTO: {\r\n            return {...state, currentChat: {...state.currentChat, chatPhoto: action.chatPhoto}}\r\n        }\r\n\r\n        // case SET_READ_FROM_INDEX: {\r\n        //     return {...state, readFromIndex: action.readFromIndex}\r\n        // }\r\n        // case SET_READ_FROM_INDEX_NEXT: {\r\n        //     return {...state, readFromIndexNext: action.readFromIndexNext}\r\n        // }\r\n\r\n        case SET_READ_FROM_INDEXES: {\r\n            return {...state, readFromIndex: action.readFromIndex, readFromIndexNext: action.readFromIndexNext, readFromIndexBefore: action.readFromIndexBefore}  \r\n        }\r\n        // case SET_LOADING_ON_SCROLL: {\r\n        //     return {...state, loadingOnScroll: action.loadingOnScroll}\r\n        // }\r\n        case SET_FETCHING_MSGS : {\r\n            return {...state, IsFetchingMsgs: action.IsFetchingMsgs} \r\n        }\r\n\r\n        // case SET_OLD_MSGS_DOWNLOAD: {\r\n        //     return {...state, oldMsgsDonwload: action.oldMsgsDonwload}\r\n        // }\r\n\r\n\r\n        // case SET_FIRST_AND_LAST_OF_SET_MSGS_ID: {\r\n        //     return {...state, firstOfSetOfMsgsId: action.firstOfSetOfMsgsId, firstOfLastSetOfMsgsId: action.firstOfLastSetOfMsgsId}\r\n        // }\r\n\r\n        case SHOULD_WINDOW_SCROLL_DOWN : {\r\n            return {...state, windowScrollOnMsgCreate: action.windowScrollOnMsgCreate} \r\n        }\r\n\r\n        // case SET_FIRST_OF_SET_MSGS_ID: {\r\n        //     return {...state, firstOfSetOfMsgsId: action.firstOfSetOfMsgsId}\r\n        // }\r\n\r\n        // case SET_FIRST_OF_LAST_SET_MSGS_ID: {\r\n        //     return {...state, firstOfLastSetOfMsgsId: action.firstOfLastSetOfMsgsId}\r\n        // }\r\n\r\n        case SET_MESSAGE_CREATING : {\r\n            return {...state, isMessageCreating: action.isMessageCreating} \r\n        }\r\n        case SET_REFRESH_AFTER_MESSAGE_CREATING: {\r\n            return {...state, isRefreshedAfterMC: action.isRefreshedAfterMC} \r\n        }\r\n\r\n        case SET_IDB_KEY_IN_MESSAGE: {\r\n            return {...state, messages: action.idbFileMessageKey} \r\n        }\r\n        // case SET_REFRESH_AFTER_DM: {\r\n        //     return {...state, isRefreshedAfterDM: action.isRefreshedAfterDM} \r\n        // }\r\n        // case SET_PREFETCH_CC : {\r\n        //     return {...state, preFetchCC: action.preFetchCC}\r\n        // }\r\n        // case ADD_USERS_TO_SELECT: {\r\n        //     return {...state, usersToSelect: action.usersToSelect}\r\n        // }\r\n\r\n        // case ADD_FILE_AS_LOADING: {\r\n        //     return {...state, loadingFilesIds: action.fileId}\r\n        // }\r\n        // case REMOVE_FILE_AS_LOADING: {\r\n        //     return {...state, loadingFilesIds: action.fileId} // delete from list of loading and then add url of file to download ( if photo to <img src='api/file/{fileId}'> else only url <a href='api/file/{fileId}')\r\n        // }\r\n\r\n        case EDIT_MESSAGE: {\r\n            return {...state, messages: state.messages.map(msg => (msg.id === action.messageId ? { ...msg, body: action.newMessageBody} : msg) ) }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\n\r\n\r\nexport const setCurrentChatMembers = (members) => ({type: SET_CURRENT_CHAT_MEMBERS, members})\r\nexport const setCurrentChatName = (name) => ({type: SET_CURRENT_CHAT_NAME, name})\r\nexport const setCurrentChatPhoto = (chatPhoto) => ({type: SET_CURRENT_CHAT_PHOTO, chatPhoto})\r\n\r\n\r\n\r\nexport const setCurrentChatIdsToStore = (chatTypeId, chatId, currentChat) => ({type: SET_CURRENT_CHAT_DATA, chatId, chatTypeId, currentChat})\r\n\r\nexport const currentChatDataFetching = (isFetching) => ({type: CURRENT_CHAT_DATA_FETCHING, isFetching})\r\n\r\nexport const toogleIsUnmount = (isUnmount) => ({type: TOOGLE_IS_UNMOUNT, isUnmount})\r\n\r\n\r\n\r\nexport const setIDBKeyInMessage = (idbFileMessageKey, message) => ({type: SET_IDB_KEY_IN_MESSAGE, idbFileMessageKey})\r\n\r\n// при каждом рефреще страницы мб запускать юзэффект для \r\n\r\n// const createKeyFor = (str) => {\r\n//     let timestamp = + new Date()\r\n//     return `${str}-${timestamp}`\r\n// }\r\n\r\nexport const saveImageToIDB = (blobObj, fileId) =>  async(dispatch) => { // add message.id and chatid and cahtTypeid for that key\r\n    // let imgKey = createKeyFor('image')\r\n    \r\n    // let chatId = parseInt(localStorage.getItem('chatId') )\r\n    // let chatTypeId = parseInt(localStorage.getItem('chatTypeId') )\r\n \r\n    // await idbKeyval.set(`image-${chatTypeId}-${chatId}-${fileId}`, blobObj)\r\n    await idbKeyval.set(`image-${fileId}`, blobObj)\r\n    // dispatch(setImg)\r\n}\r\n\r\nexport const loadImageFromIDB = (ImgKey) =>  async(dispatch) => { // get that blob add it to the img: src\r\n    return await idbKeyval.get(ImgKey)\r\n} \r\n\r\n\r\nfunction urltoFile(url, filename, mimeType){\r\n    console.log(\"url to file\" + url)\r\n    console.log(url)\r\n    return (fetch(url)\r\n        .then(function(res){return res.arrayBuffer();})\r\n        .then(function(buf){return new File([buf], filename,{type:mimeType});})\r\n    );\r\n}\r\n\r\n\r\nexport const getFile = (fileId) => async(dispatch) => {\r\n    let downloadedFile = await chatsAPI.getFile(fileId)\r\n    // console.log(\"downloadedFile\")\r\n    // console.log(downloadedFile)\r\n    // return downloadedFile.data\r\n    // return downloadedFile\r\n    let file = downloadedFile.data\r\n    console.log(file);\r\n    if(file.name){ \r\n        urltoFile(file.file, file.name, file.format)\r\n            .then(function(fileConv){   \r\n                    if(file.isImage){\r\n                        console.log('file.isImage');  \r\n                        \r\n                        let reader = new FileReader();\r\n                        reader.onload = function(upload) { \r\n                            console.log(\"Uploaded\");\r\n                            dispatch(saveImageToIDB(upload.target.result, fileId))   //  dispatch(loadImageFromIDB())\r\n                        }\r\n                        reader.readAsDataURL(fileConv); // Нет необходимости что-либо отзывать. Отозвать мы не сможем блоб иибо он к фотке прикручен\r\n\r\n                    } else {\r\n                        let blob = URL.createObjectURL(fileConv); // Прямой доступ к Blob, без «кодирования/декодирования». ( для загрузки большых блобов быстрее гораздо)\r\n                        saveAs(fileConv);\r\n                        URL.revokeObjectURL(blob)\r\n                    } \r\n                    \r\n                 })\r\n    } else {\r\n        console.log('error in getting file from api')\r\n    }\r\n}\r\n \r\n\r\n\r\n\r\n// export const addUsersToSelect = (usersToSelect) => ({type: ADD_USERS_TO_SELECT, usersToSelect})\r\n\r\n\r\n\r\n// export const requestUsersForChat = () => async(dispatch) => {\r\n//     // let result = []\r\n//     // let error = false//{data:{resultCode:0}}\r\n//     // let page = 1 \r\n//     // debugger\r\n//     // do\r\n//     // {\r\n//     //     let response = await usersAPI.getUsers(page);\r\n//     //     debugger\r\n//     //     console.log(response)\r\n//     //     if(response.data.resultCode!==0){\r\n//     //         debugger\r\n//     //         // result.push({'photos': (replaceQuotes(response.data.data.photos)).small,  \"userId\": response.data.data.userId,  'name': response.data.data.name})\r\n//     //         result.push({\"userId\": response.data.data.userId,  'name': response.data.data.name})\r\n//     //         page++;\r\n//     //     } else {\r\n//     //         error = true;\r\n//     //     }\r\n//     // } while(!error)\r\n//     // debugger\r\n//     let response = await usersAPI.getUsers(1);\r\n//     let result = []\r\n//     // debugger\r\n//     if(response.data.users.error===null){\r\n//         // debugger\r\n//         // result.push({'photos': (replaceQuotes(response.data.data.photos)).small,  \"userId\": response.data.data.userId,  'name': response.data.data.name})\r\n//         result = response.data.users.items.map(user => ({\"userId\": user.userId,  'name': user.name}))\r\n//         // page++;\r\n//     }\r\n//     dispatch(addUsersToSelect(result))\r\n// }\r\n\r\nexport const setChats = (chats) => ({type: SET_CHATS, chats})\r\nexport const setMessages = (messages) => ({type: SET_MESSAGES, messages})\r\nexport const editMessage = (messageId, newMessageBody) => ({type: EDIT_MESSAGE, messageId, newMessageBody})\r\n\r\n\r\nexport const setChatsAliasMap = (chatsAliases) => ({type: SET_CHATS_ALIAS_MAP, chatsAliases})\r\n\r\n\r\n// export const setReadFromIndexMsgs = (readFromIndex) => ({type: SET_READ_FROM_INDEX, readFromIndex}) \r\n// export const setReadFromIndexNextMsgs = (readFromIndexNext) => ({type: SET_READ_FROM_INDEX_NEXT, readFromIndexNext}) \r\n\r\nexport const setReadFromIndexes = (readFromIndex, readFromIndexNext, readFromIndexBefore) => ({type: SET_READ_FROM_INDEXES, readFromIndex, readFromIndexNext, readFromIndexBefore}) \r\n\r\n\r\n// export const setLoadingOnScroll = (loadingOnScroll) => ({type: SET_LOADING_ON_SCROLL, loadingOnScroll})\r\nexport const setFetchingMoreMsgs = (IsFetchingMsgs) => ({type: SET_FETCHING_MSGS, IsFetchingMsgs})\r\n\r\n// export const setOldMsgsDonwload = (oldMsgsDonwload) =>({type: SET_OLD_MSGS_DOWNLOAD, oldMsgsDonwload})\r\n\r\n\r\n// export const setFirsANDLastSetOfMsgsId = (firstOfSetOfMsgsId, firstOfLastSetOfMsgsId) =>({type: SET_FIRST_AND_LAST_OF_SET_MSGS_ID, firstOfSetOfMsgsId, firstOfLastSetOfMsgsId})\r\n\r\n\r\n\r\nexport const shouldWindowScrollDown =  (windowScrollOnMsgCreate) => ({type: SHOULD_WINDOW_SCROLL_DOWN, windowScrollOnMsgCreate})\r\n// export const setFirstOfSetOfMsgsId = (firstOfSetOfMsgsId) =>({type: SET_FIRST_OF_SET_MSGS_ID, firstOfSetOfMsgsId})\r\n// export const setFirstOfLastSetOfMsgsId = (firstOfLastSetOfMsgsId) =>({type: SET_FIRST_OF_LAST_SET_MSGS_ID, firstOfLastSetOfMsgsId})\r\nexport const setMessageCreating = (isMessageCreating) => ({type: SET_MESSAGE_CREATING, isMessageCreating})\r\nexport const setRefreshMessageCreating = (isRefreshedAfterMC) => ({type: SET_REFRESH_AFTER_MESSAGE_CREATING, isRefreshedAfterMC})\r\n\r\nexport const incNumOfDeletedMsgs = () => ({type: INC_NUM_OF_DELETED_MSGS})\r\nexport const nullNumOfDeletedMsgs = () => ({type: NULL_NUM_OF_DELETED_MSGS})\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// export const setRefreshAfterDM = (isRefreshedAfterDM) => ({type: SET_REFRESH_AFTER_DM, isRefreshedAfterDM})\r\n// export const setPreFetchCC = (preFetchCC) => ({type: SET_PREFETCH_CC, preFetchCC})\r\n\r\n// export const addFileAsLoading = (fileId) => ({type: ADD_FILE_AS_LOADING, fileId}) \r\n// export const removeFileAsLoading = (fileId) => ({type: REMOVE_FILE_AS_LOADING, fileId}) \r\n\r\n\r\n\r\n// export const fetchMoreOldMsgs = (chatTypeId, chatId, readFromIndexNext, firstOfSetOfMsgsId ) => async(dispatch) => { \r\n//     await dispatch(getMessages(chatTypeId, chatId, readFromIndexNext, firstOfSetOfMsgsId ))\r\n//     // dispatch(setOldMsgsDonwload(false))\r\n// }\r\n\r\nexport const setCurrentChatData = (chatTypeId, chatId) => (dispatch) =>{\r\n    dispatch(currentChatDataFetching(true))\r\n    localStorage.setItem('chatTypeId', chatTypeId)\r\n    localStorage.setItem('chatId', chatId)\r\n    dispatch(currentChatDataFetching(false))\r\n}\r\n\r\nexport const unSetCurrentChatData = () => (dispatch) =>{\r\n    delete localStorage['chatId']\r\n    delete localStorage['chatTypeId']\r\n    dispatch(setCurrentChatIdsToStore(null, null, null))\r\n}\r\n\r\n\r\n// const checkOnScrollTop = (response, readFromIndex, dispatch) => {\r\n//     if(response.data.resultCode === 0){\r\n//         if(response.data.data.readFromIndexNext === readFromIndex){\r\n//             dispatch(setLoadingOnScroll(false)) // if scrolled to the top - infinity scroll stop\r\n//         }\r\n//         dispatch(setReadFromIndexMsgs(readFromIndex))\r\n//         dispatch(setReadFromIndexNextMsgs(response.data.data.readFromIndexNext))\r\n//     }\r\n// }\r\n\r\n\r\nexport const getCurrentChatData = () => async(dispatch) => {\r\n    dispatch(setFetchingMoreMsgs(true))\r\n    // console.log('getCurrentChatData call')\r\n    // debugger\r\n    let chatId = parseInt(localStorage.getItem('chatId') )\r\n    let chatTypeId = parseInt(localStorage.getItem('chatTypeId') )\r\n    \r\n\r\n    let response = await chatsAPI.getChat(chatTypeId, chatId)\r\n    if(response.data.resultCode === 0){\r\n        // debugger\r\n        // console.log(`firstNewMsgID: ${response.data.data.firstNewMsgID}`)\r\n        let isUpdated = 'local';\r\n        // console.log(response.data.data)\r\n        if(!('local' in response.data.data.lastMessage)){\r\n            console.log('not local lastMessage in getCurrentChatData')\r\n        }\r\n        else if (!response.data.data.lastMessage.local){\r\n            // console.log('not here')\r\n            isUpdated = await dispatch(updateUnreadMsgs(chatTypeId, chatId, response.data.data.lastMessage.id))\r\n        }\r\n        // debugger\r\n        if(isUpdated==='local' || isUpdated.data.resultCode === 0){\r\n            let chatType = chatTypeId===0? 'dialog': 'conversation'\r\n            response.data.data[\"chatTypeId\"]=chatTypeId\r\n            response.data.data[\"chatType\"]=chatType\r\n            response.data.data[\"chatId\"]=chatId\r\n            dispatch(setCurrentChatIdsToStore(chatTypeId, chatId, response.data.data)) \r\n            await dispatch(getMessages(chatTypeId, chatId, response.data.data.readFromIndex, response.data.data.readFromIndexBefore)) // отсюда получили readFromIndex (равен 0 в первый раз???) (проперти rfi получило значение 0 ( так как зарядило None))\r\n        }  else {\r\n            console.log('getCurrentChatData Error in updateUnreadMsgs'+ isUpdated.data.messages[0])\r\n        }\r\n    } else {\r\n        console.log('getCurrentChatData Error in getChat'+ response.data.messages[0])\r\n    }\r\n    // debugger\r\n    // console.log('getCurrentChatData end call')\r\n    // dispatch(setPreFetchCC(true))\r\n    // console.log('setPreFetchCC as true')\r\n    // debugger\r\n    dispatch(setFetchingMoreMsgs(false))\r\n}\r\n\r\n\r\n// setCurrentChatMembers\r\n\r\nexport const refreshCurrentChatData = (method, requiredDataKey) => async(dispatch) => {\r\n    let chatId = parseInt(localStorage.getItem('chatId') )\r\n    let chatTypeId = parseInt(localStorage.getItem('chatTypeId') )\r\n    let response = await chatsAPI.getChat(chatTypeId, chatId)\r\n    if(response.data.resultCode === 0){\r\n        dispatch(method(response.data.data[requiredDataKey]))\r\n    } else {\r\n        console.log('refreshCurrentChatData Error in getChat'+ response.data.messages[0])\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n// const getChatHelper = async(chatType, chatTypeId, chatArray) => {\r\n//     let unfilteredArray = await Promise.all(chatArray\r\n//         .map(async (chat) => {\r\n//         let response = await chatsAPI.getChat(chatTypeId, chat.id)\r\n//         if(response.data.resultCode === 0){\r\n//             response.data.data[\"chatTypeId\"]=chatTypeId\r\n//             response.data.data[\"chatType\"]=chatType\r\n//             response.data.data[\"chatId\"]=chat.id\r\n//             return response.data.data\r\n//         } else {\r\n//             console.log('getChat Error '+ response.data.messages[0])\r\n//             return null\r\n//         }\r\n//         } ))\r\n//     return unfilteredArray.filter(chat => chat!==null)\r\n//     }\r\n        \r\n\r\n\r\nconst getChatHelper = async(chatArray) => {\r\n    let unfilteredArray = await Promise.all(chatArray\r\n        .map(async (chat) => {\r\n        let response = await chatsAPI.getChat(chat.chatTypeId, chat.id)\r\n        if(response.data.resultCode === 0){\r\n            response.data.data[\"chatTypeId\"] = chat.chatTypeId\r\n            response.data.data[\"chatId\"]=chat.id\r\n            response.data.data[\"chatTimeStamp\"]=chat.chatTimeStamp\r\n            if(chat.chatTypeId===0){\r\n                response.data.data[\"chatType\"]='dialog'\r\n            } else{\r\n                response.data.data[\"chatType\"]='conversation'\r\n            }\r\n            return response.data.data\r\n        } else {\r\n            console.log('getChat Error '+ response.data.messages[0])\r\n            return null\r\n        }\r\n        } ))\r\n    // return unfilteredArray.filter(chat => chat!==null)\r\n    return unfilteredArray.sort((chat1,chat2)=>chat2.chatTimeStamp - chat1.chatTimeStamp)\r\n    }\r\n\r\nexport const getChats = (page=1, query=null) => async(dispatch) => {\r\n    // debugger\r\n    let response = await chatsAPI.getChats(page, query); // chatTypeId, chatId// =>\r\n    if(response.data.resultCode === 0){\r\n        // let dialogs = await getChatHelper('dialog', 0, response.data.data.dialogs)\r\n        // let conversations = await getChatHelper('conversation', 1, response.data.data.conversations)\r\n        // let chats = [...dialogs, ...conversations]\r\n        // console.log(chats)\r\n        let chats = await getChatHelper(response.data.data.chats.items)\r\n        dispatch(setChats(chats))\r\n    } else {\r\n        console.log('getChats error '+ response.data.messages[0])\r\n    }\r\n}\r\n\r\n// чтобы не хранить кучу данных мы не дописываем в свойства сообщений чат к которому они относятся\r\nconst getMessagesHelper = (array, chatTypeId, chatId) => array.map(msg => (msg[chatTypeId]=chatTypeId, msg[chatId]=chatId, msg))\r\n\r\n\r\n// TODO c set start position of view messages on last readed and then after scroll setting 1 by 1 msgs as viewed\r\n// for first load set firstOfSetOfMsgsId, firstOfLastSetOfMsgsId as null -ed\r\n\r\n// after page reload from chats\\ => by getCCD null-ed firstOfSetOfMsgsId=null, firstOfLastSetOfMsgsId=null -> so we can restart count of that indexes ///// /, numOfDeletedMsgs=0\r\nexport const getMessages = (chatTypeId, chatId, readFromIndex, readFromIndexBefore,\r\n    //   firstOfSetOfMsgsId=null,  \r\n                            query=null, isRefreshAfterMsgCreating=null, numOfDeletedMsgs=0) =>  async(dispatch) => {\r\n\r\n    dispatch(setFetchingMoreMsgs(true))\r\n    if(numOfDeletedMsgs > 0){\r\n        dispatch(nullNumOfDeletedMsgs())\r\n    }\r\n    let response = await chatsAPI.getMessages(chatTypeId, chatId, readFromIndex, readFromIndexBefore, query, numOfDeletedMsgs);\r\n    if(response.data.resultCode === 0){\r\n\r\n        let allKeysForImgs = await idbKeyval.keys() // сократить коллекцию поставив условия выбора ключей\r\n\r\n        let allMsgs = getMessagesHelper(response.data.data.items, chatTypeId, chatId)\r\n                        .map( (msg) => {\r\n                            if(msg.fileId !== null){\r\n                                \r\n                                let tryIdbKey = `image-${msg.fileId}`\r\n                                if(allKeysForImgs.includes(tryIdbKey)){\r\n                                    // console.log(tryIdbKey)\r\n                                    // debugger\r\n                                    msg['fileIDBKey'] = tryIdbKey\r\n                                }\r\n                            }\r\n                            return msg\r\n                        })  \r\n        \r\n\r\n        dispatch(setMessages(allMsgs))\r\n\r\n        if(allMsgs.length > 0){\r\n            dispatch(setReadFromIndexes(allMsgs[0].id, response.data.data.readFromIndexNext, response.data.data.readFromIndexBefore))    \r\n        } else { // can be only after refresh\r\n            dispatch(setReadFromIndexes(readFromIndex, response.data.data.readFromIndexNext, response.data.data.readFromIndexBefore))    \r\n        }\r\n        \r\n        \r\n        if(isRefreshAfterMsgCreating){\r\n            dispatch(shouldWindowScrollDown(false))\r\n            dispatch(setRefreshMessageCreating(true))\r\n        }\r\n\r\n\r\n        \r\n        // checkOnScrollTop(response, readFromIndex, dispatch)\r\n    } else {\r\n        console.log('getMessages error '+ response.data.messages[0])\r\n    }\r\n    \r\n    // if()\r\n    dispatch(setFetchingMoreMsgs(false))\r\n}\r\n\r\n\r\n\r\n\r\n\r\n// export const downloadFile = (filePath) => async(dispatch) => {\r\n//     let file = await chatsAPI.downloadFile(filePath)\r\n//     // return file\r\n// }\r\n\r\n// then TODO download files to idb to use after from idb not from server!!!!!!\r\n// export const downloadFilesToContent = (fileId) => async(dispatch)  => {\r\n//     // dispatch(addFileAsLoading(fileId))\r\n//     let downloadedFile = await chatsAPI.getFile(fileId)\r\n//     console.log(\"downloadedFile\")\r\n//     console.log(downloadedFile)\r\n//     if(downloadedFile.data.resultCode === 0){\r\n//         idbKeyval.set(`fileId_${fileId}`, downloadedFile.data.file) // may use `fileId_${fileId}` ,\r\n//         // dispatch(downloadedFile.data.file) // fileId\r\n//     }\r\n//     // dispatch(removeFileAsLoading(fileId))\r\n// }\r\n\r\nconst createMessageSnippent = async(chatTypeId, chatId, messageBody, fileId, dispatch) => {\r\n    let response = await chatsAPI.createMessage(chatTypeId, chatId, messageBody, fileId);\r\n    if(response.data.resultCode === 0){\r\n        dispatch(shouldWindowScrollDown(true))\r\n        // dispatch(getMessages(chatTypeId, chatId))\r\n    } else {\r\n        let message = response.data.messages.length  ? response.data.messages[0] : 'Some error';\r\n        dispatch(stopSubmit(\"CreateMessage\", {_error: message}));\r\n    }\r\n}\r\n \r\nexport const createMessageRequest = (chatTypeId, chatId, messageBody, file=null) => async(dispatch) => {\r\n    dispatch(setMessageCreating(true))\r\n\r\n \r\n    dispatch(reset('CreateMessage'));  // requires form name\r\n\r\n    console.log('in createMessageRequest')\r\n    console.log(file)\r\n    if (file!==null){\r\n        // let fileUploadResponse = await chatsAPI.uploadFile(file) // TIP there is problems\r\n        let fileUploadResponse = await chatsAPI.uploadFile(file['fileURL'], file['fileName'])\r\n        console.log(`fileUploadResponse.data`);\r\n        console.log(fileUploadResponse.data.data)\r\n        if(fileUploadResponse.data.data['fileId']){\r\n            // console.log(fileUploadResponse.data.data['fileId'])\r\n            createMessageSnippent(chatTypeId, chatId, messageBody, fileUploadResponse.data.data['fileId'], dispatch)\r\n        } else {\r\n            console.log('fileUploadResponse error')\r\n            console.log(Object.keys(fileUploadResponse.data.data))\r\n        }\r\n    } else {\r\n        createMessageSnippent(chatTypeId, chatId, messageBody, null, dispatch)\r\n    }\r\n    dispatch(setMessageCreating(false))\r\n    \r\n}\r\n\r\nexport const editMessageRequest = (chatTypeId, chatId, messageId, newMessageBody) => async(dispatch) =>{\r\n\r\n    let response = await chatsAPI.editMessage(chatTypeId, chatId, messageId, newMessageBody);\r\n    if(response.data.resultCode === 0){\r\n        console.log('succs edited')\r\n    } else {\r\n        console.log('editMessageRequest error '+ response.data.messages[0])\r\n    }\r\n}\r\n\r\n\r\nexport const deleteMessageRequest = (chatTypeId, chatId, messageId, fileId) =>  async(dispatch) =>{\r\n    // ref={\r\n    // debugger\r\n    dispatch(setFetchingMoreMsgs(true))\r\n\r\n    if(fileId){\r\n        await idbKeyval.delete(`image-${fileId}`)\r\n    } \r\n    \r\n    let response = await chatsAPI.deleteMessage(chatTypeId, chatId, messageId);\r\n    if(response.data.data === null){\r\n        console.log('succs deleted')\r\n        // dispatch(setRefreshAfterDM(true))\r\n        dispatch(incNumOfDeletedMsgs())\r\n    } else {\r\n        console.log('deleteMessageRequest deleted '+ response.data.messages[0])\r\n    }\r\n    dispatch(setFetchingMoreMsgs(false))\r\n}\r\n\r\n\r\n\r\nconst clearChatTypes = ['myLocal', 'myGlobal', 'allLocal', 'allGlobal'];\r\nexport const clearChat = (chatTypeId, chatId, putType, clearType) => async(dispatch) => {\r\n    // if (!['myLocal', 'myGlobal', 'allLocal', 'allGlobal'].includes(clearType)){\r\n    //     console.log('unsupported clearType')\r\n    //     return null\r\n    // }\r\n    // debugger\r\n    let response = await chatsAPI.clearChat(chatTypeId, chatId,  putType, clearType);\r\n    // debugger\r\n    if(response.data.resultCode === 0){\r\n        return response.data.data.cleared\r\n    } else {\r\n        console.log('clearLocalChat deleted '+ response.data.messages[0])\r\n    }\r\n}\r\nexport const clearChatMyLocal = (chatTypeId, chatId, putType='clear', clearType=clearChatTypes[0])   => clearChat(chatTypeId, chatId, putType, clearType)\r\nexport const clearChatMyGlobal = (chatTypeId, chatId, putType='clear', clearType=clearChatTypes[1])  => clearChat(chatTypeId, chatId, putType, clearType)\r\nexport const clearChatAllLocal = (chatTypeId, chatId, putType='clear', clearType=clearChatTypes[2]) =>  clearChat(chatTypeId, chatId, putType, clearType)\r\nexport const clearChatAllGlobal = (chatTypeId, chatId, putType='clear', clearType=clearChatTypes[3]) =>  clearChat(chatTypeId, chatId, putType, clearType)\r\n\r\n\r\n\r\nexport const updateUnreadMsgs = (chatTypeId, chatId, lastGlobalReadMsgId, putType='updateUnreadMsgs') => async(dispatch) => {\r\n    // console.log('updateUnreadMsgs')\r\n    // console.log(chatTypeId, chatId, lastGlobalReadMsgId, putType='updateUnreadMsgs')\r\n    let response = await chatsAPI.updateUnreadMsgs(chatTypeId, chatId, putType, lastGlobalReadMsgId)\r\n    // console.log(response.data)\r\n    // debugger\r\n    if(response.data.resultCode === 0){\r\n        console.log('updateUnreadMsgs updated')\r\n    } else {\r\n        console.log('updateUnreadMsgs error')\r\n    }\r\n    return response\r\n}\r\n\r\n\r\nexport const createChatRequest = (snusers, name) => async(dispatch) => {\r\n    debugger\r\n    let response = await chatsAPI.createChat(snusers, name)\r\n    debugger\r\n    if(response.data.resultCode === 0){\r\n        console.log('createChatRequest created: ' + response.data.data.created)\r\n    } else {\r\n        console.log('createChatRequest error')\r\n        let message = response.data.messages.length  ? response.data.messages[0] : 'Some error';\r\n        dispatch(stopSubmit(\"CreateChat\", {_error: message}));\r\n    }\r\n}\r\n\r\nexport const createConversation = (snusers, name) => createChatRequest(snusers, name)\r\nexport const createDialog = (snusers) => createChatRequest(snusers, null)\r\n\r\n\r\n\r\nexport const deleteChatRequest = (chatTypeId, chatId) => async(dispatch) => {\r\n    let response = await chatsAPI.deleteChat(chatTypeId, chatId)\r\n    // debugger\r\n    if(response.data === ''){\r\n        console.log('chat succ deleted')\r\n    } else {\r\n        let message = response.data.messages.length  ? response.data.messages[0] : 'Some error';\r\n        console.log('deleteChatRequest error: ' + message)\r\n    }\r\n}\r\n\r\nexport const renameChatRequest = (chatTypeId, chatId, newChatName, putType='rename') => async(dispatch) => {\r\n    // debugger\r\n    let response = await chatsAPI.renameChat(chatTypeId, chatId, putType, newChatName)\r\n    // debugger\r\n    if(response.data.resultCode === 0){\r\n        console.log('chat renamed:'+ response.data.data.renamed)\r\n        dispatch(refreshCurrentChatData(setCurrentChatName, 'name'))\r\n    } else {\r\n        let message = response.data.messages.length  ? response.data.messages[0] : 'Some error';\r\n        dispatch(stopSubmit('renameChat', {_error: message}));\r\n    }\r\n}\r\n\r\n\r\n\r\n// athunku // thunku // athunkrf\r\n\r\n\r\n// all the same\r\nexport const toogleMemberStatus = (chatTypeId, chatId, userId, putType='toogleMemberStatus') => async(dispatch) => {\r\n    // let response = await chatsAPI.toogleMemberStatusForConversation(chatTypeId, chatId, putType, userId)\r\n    // if(response.data.resultCode === 0){\r\n    //     console.log('member status toggled: ' + response.data.data.toggled)\r\n    // } else {\r\n    //     let message = response.data.messages.length  ? response.data.messages[0] : 'Some error';\r\n    //     console.log('toogleMemberStatusForConversation error: '+ message)\r\n    // }\r\n    await chatPutParts(chatTypeId, chatId, userId, putType, chatsAPI.toogleMemberStatusForConversation.bind(chatsAPI), 'member status toggled: ', 'toggled', 'toogleMemberStatusForConversation error: ', dispatch, setCurrentChatMembers, 'members')\r\n}\r\n\r\nexport const addMember = (chatTypeId, chatId, userId, putType='addMember') => async(dispatch) => {\r\n    console.log('adding member')\r\n    console.log(chatTypeId, chatId, userId)\r\n    // let response = await chatsAPI.addMemberForConversation(chatTypeId, chatId, putType, userId)\r\n    // if(response.data.resultCode === 0){\r\n    //     console.log('member added: ' + response.data.data.memberAdded)\r\n    // } else {\r\n    //     let message = response.data.messages.length  ? response.data.messages[0] : 'Some error';\r\n    //     console.log('addMember error: '+ message)\r\n    // }\r\n    await chatPutParts(chatTypeId, chatId, userId, putType, chatsAPI.addMemberForConversation.bind(chatsAPI), 'member added: ', 'memberAdded', 'addMember error: ', dispatch, setCurrentChatMembers, 'members')\r\n}\r\n\r\n// после удаления мембера у которого были сообзения Bad Request: /api/chats/1/23/messages/\r\nexport const removeMember = (chatTypeId, chatId, userId, putType='removeMember') => async(dispatch) => {\r\n    // let response = await chatsAPI.removeMemberFromConversation(chatTypeId, chatId, putType, userId)\r\n    // if(response.data.resultCode === 0){\r\n    //     console.log('member removed: ' + response.data.data.memberRemoved)\r\n    // } else {\r\n    //     let message = response.data.messages.length  ? response.data.messages[0] : 'Some error';\r\n    //     console.log('removeMember error: '+ message)\r\n    // }\r\n    // debugger \r\n    // if(response.data.resultCode === 0){ storeDispatchMethod\r\n    //     storeDispatchMethod && dispatch(refreshCurrentChatData(storeDispatchMethod)) // chatTypeId, chatId\r\n    // } \r\n    let response = await chatPutParts(chatTypeId, chatId, userId, putType, chatsAPI.removeMemberFromConversation.bind(chatsAPI), 'member removed: ', 'memberRemoved', 'removeMember error: ', dispatch, setCurrentChatMembers, 'members')\r\n\r\n}\r\n\r\n\r\nexport const removeMemberMsgs = (chatTypeId, chatId, userId, putType='removeMemberMsgs') => async(dispatch) => {\r\n    // let response = await chatsAPI.removeMemberMsgsForConversation(chatTypeId, chatId, putType, userId)\r\n    // if(response.data.resultCode === 0){\r\n    //     console.log('member msgs removed: ' + response.data.data.memberMsgsRemoved)\r\n    // } else {\r\n    //     let message = response.data.messages.length  ? response.data.messages[0] : 'Some error';\r\n    //     console.log('removeMemberMsgs error: '+ message)\r\n    // }\r\n    await chatPutParts(chatTypeId, chatId, userId, putType, chatsAPI.removeMemberMsgsForConversation.bind(chatsAPI), 'member msgs removed: ', 'memberMsgsRemoved', 'removeMemberMsgs error: ')\r\n}\r\n\r\nexport const removeOneMemberMsg = (chatTypeId, chatId, userId, putType='removeOneMemberMsg') => async(dispatch) => {\r\n    // let response = await chatsAPI.removeOneMemberMsgForConversation(chatTypeId, chatId, putType, userId)\r\n    // if(response.data.resultCode === 0){\r\n    //     console.log('member msg removed: ' + response.data.data.memberMsgRemoved)\r\n    // } else {\r\n    //     let message = response.data.messages.length  ? response.data.messages[0] : 'Some error';\r\n    //     console.log('removeOneMemberMsg error: '+ message)\r\n    // }\r\n    await chatPutParts(chatTypeId, chatId, userId, putType, chatsAPI.removeOneMemberMsgForConversation.bind(chatsAPI), 'member msg removed: ', 'memberMsgRemoved', 'removeOneMemberMsg error: ')\r\n}\r\n\r\n\r\nexport const setChatPhotoRequest = (chatTypeId, chatId, newChatPhoto, putType='setChatPhoto') => async(dispatch) => {\r\n    await chatPutParts(chatTypeId, chatId, newChatPhoto, putType, chatsAPI.setChatPhoto.bind(chatsAPI), 'chat photo changed: ', 'isChatPhotoChanged', 'setChatPhotoRequest error: ', dispatch, setCurrentChatPhoto, 'chatPhoto')\r\n}\r\n// all the same\r\n\r\nconst chatPutParts = async(chatTypeId, chatId, putData, putType, apiMethod, onSuccStr, onSuccDataKey, onErrorStr, dispatch=null, storeDispatchMethod=null, requiredDataKey=null) => {\r\n    // debugger\r\n    let response = await apiMethod(chatTypeId, chatId, putType, putData)\r\n    // debugger\r\n    if(response.data.resultCode === 0){\r\n        console.log(onSuccStr + response.data.data[onSuccDataKey])\r\n        storeDispatchMethod && dispatch(refreshCurrentChatData(storeDispatchMethod, requiredDataKey))\r\n    } else {\r\n        let message = response.data.messages.length  ? response.data.messages[0] : 'Some error';\r\n        console.log(onErrorStr + message)\r\n    }\r\n    return response;\r\n}\r\nexport default chatsReducer;\r\n\r\n\r\n\r\n// export const getChat = (chatTypeId, chatId) => async(dispatch) => {\r\n//     let response = await chatsAPI.getChat(asyncAPIMethodParams)\r\n//     if(response.data.resultCode === 0){\r\n        \r\n//     } else {\r\n        \r\n//     }\r\n// }\r\n\r\n\r\n\r\n\r\n// startMsgId // lastReadMessageId // msgsType\r\n// 0\r\n// 8\r\n// old\r\n// <QuerySet []>\r\n// <QuerySet []>\r\n// listOfLocalSubs\r\n// []\r\n// returnList\r\n// [<QuerySet []>, <QuerySet [<ConversationMessage: ConversationMessage object (8)>]>]\r\n// <QuerySet []>\r\n// listOfLocalSubs\r\n// []\r\n// returnList\r\n// [[], <QuerySet [<ConversationMessage: ConversationMessage object (8)>]>]\r\n// lastReadMessageId // msgsType\r\n// 8\r\n// new\r\n// [31/Jul/2020 17:50:08] \"GET /api/chats/1/6/messages/ HTTP/1.1\" 200 291\r\n// startMsgId // lastReadMessageId // msgsType\r\n// 0\r\n// 7\r\n// old\r\n// <QuerySet [<MyConversationMessage: MyConversationMessage object (8)>]>\r\n// <QuerySet [<MyConversationMessage: MyConversationMessage object (8)>]>\r\n// listOfLocalSubs\r\n// [8]\r\n// returnList\r\n// [<QuerySet [<MyConversationMessage: MyConversationMessage object (8)>]>, <QuerySet []>]\r\n// <QuerySet [<MyConversationMessage: MyConversationMessage object (8)>]>\r\n// listOfLocalSubs\r\n// [8]\r\n// returnList\r\n// [[], <QuerySet []>]\r\n// lastReadMessageId // msgsType\r\n// 7\r\n// new\r\n\r\n// [local, global]","import React from 'react';\r\nimport preloader from \"../../../assets/images/preloader1.gif\";\r\nimport s from './Preloader.module.scss';\r\n\r\n\r\nlet Preloader = (props) => {\r\n    return <div  className={ s.container }>\r\n        <img src={preloader}/>\r\n    </div>\r\n}\r\n\r\nexport default Preloader;","// import moment from 'moment-timezone/moment-timezone';\r\nexport const convertTime = (unix_timestamp) => {\r\n    if(!unix_timestamp) return ''\r\n    let time = new Date(unix_timestamp * 1000);\r\n    let hours = time.getHours()< 10 ? `0${time.getHours()}` : time.getHours()\r\n    let mins = time.getMinutes() < 10 ? `0${time.getMinutes()}`: time.getMinutes()\r\n    return `${hours}:${mins}`\r\n}\r\n\r\n// https://overcoder.net/q/25947/%D0%BF%D0%BE%D0%BB%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-%D1%81%D0%BC%D0%B5%D1%89%D0%B5%D0%BD%D0%B8%D1%8F-%D1%87%D0%B0%D1%81%D0%BE%D0%B2%D0%BE%D0%B3%D0%BE-%D0%BF%D0%BE%D1%8F%D1%81%D0%B0-%D0%BA%D0%BB%D0%B8%D0%B5%D0%BD%D1%82%D0%B0-%D0%B2-javascript","import React, { useEffect, useState } from 'react';\r\nimport styles from './FormsControls.module.scss'\r\nimport { Field } from 'redux-form';\r\n\r\nimport PropTypes from 'prop-types';\r\nimport { chatsAPI } from '../../../api/api';\r\n\r\n\r\n// import MultiSelect from \"react-multi-select-component\";\r\n\r\n\r\n// how to show that we dont pass the field validation before submitting ( or after )\r\n// field-level validation\r\nconst FormControl = ({ input, meta: {touched, error, warning}, children }) => { // children = <input {...input} {...restProps} /> or children = <input {...input} {...restProps} />\r\n    const hasError = touched && error;\r\n    const hasWarn = touched && warning;\r\n    return (\r\n        <div className={styles.formControl + ' ' + (hasError ? styles.error: \"\") + ' ' + (hasWarn ? styles.warning: \"\")}>\r\n            {/* <div className={styles.formValues}> */}\r\n                {children}\r\n            {/* </div> */}\r\n            {/* <div className={styles.formErrors}> */}\r\n                {\r\n                (hasError && <span>{error}</span>) ||\r\n                (hasWarn && <span>{warning}</span>)\r\n                }\r\n            {/* </div> */}\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport const TextArea = (props) => {\r\n    const { input, meta, child, ...restProps } = props;\r\n    console.log(restProps.onCTRLEnt)\r\n    return (<FormControl {...props}><textarea {...input} {...restProps} onKeyUp={restProps.onCTRLEnt} /></FormControl>)\r\n}\r\n\r\nexport const Input = (props) => {\r\n    const { input, meta, child, ...restProps } = props;\r\n    // console.log('Input input: ' + input)\r\n    // console.log('Input meta: ' + meta)\r\n    // console.log('Input child: ' + child)\r\n    // console.log('Input restProps: ' + restProps)\r\n    // console.log('Input props: ' + props)\r\n    // if(restProps.type === 'checkbox') return  (<FormControl {...props}><input {...input} {...restProps}  className={styles.checkboxPos} /></FormControl>)\r\n    return (<FormControl {...props}><input {...input} {...restProps}/></FormControl>)\r\n}\r\n\r\n\r\n\r\n// export const UploadFiles = ({fileId}) => {\r\n\r\n//     const [selectedFiles, setSelectedFiles] = useState(undefined);\r\n//     const [currentFile, setCurrentFile] = useState(undefined);\r\n//     const [progress, setProgress] = useState(0);\r\n//     const [message, setMessage] = useState(\"\");\r\n\r\n//     const [fileInfos, setFileInfos] = useState([]);\r\n\r\n\r\n//     const selectFile = (event) => {\r\n//         setSelectedFiles(event.target.files);\r\n//       };\r\n\r\n//     const upload = () => {\r\n//         let currentFile = selectedFiles[0];\r\n    \r\n//         setProgress(0);\r\n//         setCurrentFile(currentFile);\r\n    \r\n//         chatsAPI.uploadFile(currentFile, (event) => {\r\n//           setProgress(Math.round((100 * event.loaded) / event.total));\r\n//         })\r\n//           .then((response) => {\r\n//             setMessage(response.data.message);\r\n//             return chatsAPI.getFile(fileId);\r\n//           })\r\n//           .then((files) => {\r\n//             setFileInfos(files.data);\r\n//           })\r\n//           .catch(() => {\r\n//             setProgress(0);\r\n//             setMessage(\"Could not upload the file!\");\r\n//             setCurrentFile(undefined);\r\n//           });\r\n    \r\n//         setSelectedFiles(undefined);\r\n//       };\r\n\r\n//     useEffect(() => {\r\n//         chatsAPI.getFile(fileId).then((response) => {\r\n//           setFileInfos(response.data);\r\n//         });\r\n//       }, []);\r\n\r\n//     return (\r\n//       <div>\r\n//         {currentFile && (\r\n//           <div className=\"progress\">\r\n//             <div\r\n//               className=\"progress-bar progress-bar-info progress-bar-striped\"\r\n//               role=\"progressbar\"\r\n//               aria-valuenow={progress}\r\n//               aria-valuemin=\"0\"\r\n//               aria-valuemax=\"100\"\r\n//               style={{ width: progress + \"%\" }}\r\n//             >\r\n//               {progress}%\r\n//             </div>\r\n//           </div>\r\n//         )}\r\n  \r\n//         <label className=\"btn btn-default\">\r\n//           <input type=\"file\" onChange={selectFile} />\r\n//         </label>\r\n  \r\n//         <button\r\n//           className=\"btn btn-success\"\r\n//           disabled={!selectedFiles}\r\n//           onClick={upload}\r\n//         >\r\n//           Upload\r\n//         </button>\r\n  \r\n//         <div className=\"alert alert-light\" role=\"alert\">\r\n//           {message}\r\n//         </div>\r\n  \r\n//         <div className=\"card\">\r\n//           <div className=\"card-header\">List of Files</div>\r\n//           <ul className=\"list-group list-group-flush\">\r\n//             {fileInfos &&\r\n//               fileInfos.map((file, index) => (\r\n//                 <li className=\"list-group-item\" key={index}>\r\n//                   <a href={file.url}>{file.name}</a>\r\n//                 </li>\r\n//               ))}\r\n//           </ul>\r\n//         </div>\r\n//       </div>\r\n//     );\r\n//   };\r\n\r\n  \r\n\r\n\r\n// export const FileInput = (props) => {\r\n//     // TIP there is problems\r\n    \r\n//     const { input, meta, child, ...restProps } = props;\r\n//     return (<FormControl {...props}>  <input {...input} {...restProps}/> </FormControl>)\r\n\r\n// }\r\n// // <input {...input} {...restProps}/> onChange={props.selectFile}\r\n\r\n\r\n// export class FileInput extends React.Component {\r\nexport const FileInput = (props) => {\r\n    \r\n    // const styleFileInput = {\r\n    //     heigth: \"1vh\"\r\n    // }\r\n\r\n\r\n    const { input, meta, child, ...restProps } = props;\r\n\r\n    const getBase64 = (file) => {\r\n      return new Promise((resolve, reject) => {\r\n        const reader = new FileReader();\r\n        reader.readAsDataURL(file);\r\n        reader.onload = () => resolve(reader.result);\r\n        reader.onerror = error => reject(error);\r\n      });\r\n    }\r\n  \r\n    const onFileChange = async (e) => {\r\n      const { input } = props\r\n      const targetFile = e.target.files[0]\r\n      if (targetFile) {\r\n        const val = await getBase64(targetFile) \r\n        input.onChange({'fileURL': val, 'fileName':targetFile.name})\r\n      } else {\r\n        input.onChange(null)\r\n      }\r\n    }\r\n \r\n    const fileInputKey = input.value ? input.value.name : +new Date();\r\n\r\n      return ( \r\n        <input \r\n            key={fileInputKey}\r\n            type=\"file\"\r\n            onChange={onFileChange}  /> \r\n      ) \r\n  }\r\n  \r\n\r\n// export const MultiSelectWrap = (props) => {\r\n//     debugger\r\n//     // const { meta, child, ...restProps } = props; // input\r\n//     // console.log(...restProps)\r\n//     // debugger\r\n//     // console.log('Input input: ' + input)\r\n//     // console.log('Input meta: ' + meta)\r\n//     // console.log('Input child: ' + child)\r\n//     // console.log('Input restProps: ' + restProps)\r\n//     // console.log('Input props: ' + props)\r\n//     return (<FormControl {...props}><MultiSelect options={props.optionsMS} \r\n//         value={props.valueMS} \r\n//         onChange={props.onChangeMS}\r\n//         labelledBy={props.labelledByMS} /></FormControl>)\r\n// }\r\n\r\n\r\n\r\n\r\n// export const Select = (props) => {\r\n//     const { input, meta, child, ...restProps } = props;\r\n//     return (<FormControl {...props}>\r\n//         <select {...input} {...restProps}>\r\n//         </select>\r\n//         </FormControl>)\r\n// }\r\n/// как возвращять полученый список в редакс форм\r\n// const ForChatUsersList = () => {\r\n//     // const onSubmitMemberList = () => {\r\n\r\n//     // }\r\n//     const [] = useState // selectedMembers\r\n// return (\r\n//     <UsersContainer />\r\n// )\r\n// }\r\n\r\n// export const ForChatUsersListWrap = (props) => {\r\n//     // debugger\r\n//     // return (<FormControl {...props}><ForChatUsersList /></FormControl>)\r\n//     return <ForChatUsersList />\r\n// }\r\n\r\nexport const createField = (placeholder, name, component, validators, props={}, text=\"\") => { \r\n    return <div className=''><Field placeholder={placeholder} name={name} component={component} validate={validators} {...props}/>{text}</div>\r\n};\r\n\r\n\r\nexport class DropDownSelect extends React.Component { // eslint-disable-line react/prefer-stateless-function\r\n\r\n    renderSelectOptions = (person) => (\r\n        <option key={person.userId} value={person.userId}>{person.name}</option>\r\n    )\r\n\r\n    render() {\r\n        const { input, label } = this.props;\r\n        return (\r\n        <div>\r\n            {/* <label htmlFor={label}>{label}</label> */}\r\n            <select {...input}>\r\n            <option value=\"\">Select</option>\r\n            {this.props.people.map(this.renderSelectOptions)}\r\n            </select>\r\n        </div>\r\n        );\r\n    }\r\n}\r\n\r\nDropDownSelect.propTypes = {\r\n    people: PropTypes.array,\r\n    input: PropTypes.object,\r\n    label: PropTypes.string,\r\n};\r\n\r\n\r\n\r\nexport const ReduxFormSnippet = ({ pristine, reset, submitting, error, sumbitButtonName } ) => {\r\n    return (\r\n        <>\r\n        {\r\n            error && \r\n            <div className={styles.formSummaryError}>\r\n                {error}\r\n            </div>\r\n            }\r\n            <div className=''>\r\n                <button type='submit' disabled={pristine || submitting} >{sumbitButtonName}</button>\r\n            </div>\r\n            <div className=''>\r\n                <button type='button' disabled={pristine || submitting} onClick={reset}>Clear</button>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\n// export const Select = (props) => {\r\n//     const { input, meta, child, ...restProps } = props;\r\n//     // console.log('Input input: ' + input)\r\n//     // console.log('Input meta: ' + meta)\r\n//     // console.log('Input child: ' + child)\r\n//     // console.log('Input restProps: ' + restProps)\r\n//     // console.log('Input props: ' + props)\r\n//     return (<FormControl {...props}><DropDownSelect {...input} {...restProps} /></FormControl>)\r\n// }","export const requiredField = value => {\r\n    if(value) return undefined;\r\n    return \"Field is required\";\r\n}\r\n\r\n\r\nconst maxLength = max => value => \r\n    value && value.length > max ? `Value must be no longer then ${max} symbols`: undefined;\r\n\r\n    \r\nexport const maxLength10 = maxLength(10);\r\nexport const maxLength30 = maxLength(30);\r\nexport const maxLength50 = maxLength(50);\r\nexport const maxLength200 = maxLength(200);\r\nexport const maxLength1000 = maxLength(1000);","const backupQuotes = (string) => {\r\n    // obj = JSON.parse(obj.replace(/'/g, '\"'));\r\n    string = JSON.stringify(string).replace(/\"/g, '\\'')\r\n    // debugger\r\n    return string;\r\n}\r\nexport default backupQuotes;","export const updateObjectInArray = (itmes, itemId, objPropName, newObjProps) => {\r\n    // debugger\r\n    return itmes.map( item =>  {\r\n        if (item[objPropName] === itemId) {\r\n            return {...item, ...newObjProps}\r\n        }\r\n        return item;\r\n    })  \r\n}","import {usersAPI} from \"../api/api\";\r\nimport { updateObjectInArray } from \"../components/common/utils/object-helpers\";\r\n\r\n// const FOLLOW = 'FOLLOW';\r\n// const UNFOLLOW = 'UNFOLLOW';\r\nconst FOLLOW_UNFOLLOW = 'FOLLOW_UNFOLLOW';\r\nconst SET_USERS = 'SET_USERS';\r\nconst SET_CURRENT_PAGE = 'SET_CURRENT_PAGE';\r\nconst SET_TOTAL_USERS_COUNT = 'SET_TOTAL_USERS_COUNT';\r\nconst TOGGLE_IS_FETCHING = 'TOGGLE_IS_FETCHING';\r\nconst TOGGLE_IS_FOLLOWING_PROGRESS = 'TOGGLE_IS_FOLLOWING_PROGRESS';\r\nconst SET_QUERY = 'SET_QUERY';\r\nlet initialState = {\r\n    users: [ ],\r\n    pageSize: 5,\r\n    totalUsersCount: 0,\r\n    currentPage: 1,\r\n    isFetching: true,\r\n    followingInProgress: [],\r\n    query: '',\r\n};\r\n\r\nconst usersReducer = (state = initialState, action) => {\r\n    switch(action.type) {\r\n        case SET_QUERY: {\r\n            return {...state, query:action.query}\r\n        }\r\n        case FOLLOW_UNFOLLOW: { \r\n            // debugger\r\n            return {\r\n                ...state,\r\n                users: updateObjectInArray(state.users, action.userId, \"userId\", {userRelation: action.userRelation}) //\r\n            }\r\n        }\r\n        // case UNFOLLOW:\r\n        //     return {\r\n        //         ...state,\r\n        //         users: updateObjectInArray(state.users, action.userId, \"userId\", {followed: false})\r\n        //     }\r\n        case SET_USERS: {\r\n            return { ...state, users: action.users }\r\n        }\r\n        case SET_CURRENT_PAGE: {\r\n            return { ...state, currentPage: action.currentPage}\r\n        }\r\n        case SET_TOTAL_USERS_COUNT: {\r\n            return { ...state, totalUsersCount: action.count}\r\n        }\r\n        case TOGGLE_IS_FETCHING: {\r\n            return { ...state, isFetching: action.isFetching}\r\n        }\r\n        case TOGGLE_IS_FOLLOWING_PROGRESS: {\r\n            // console.log(`followingInProgress: ${state.followingInProgress}`);\r\n            // debugger\r\n            let l = {\r\n                ...state,\r\n                followingInProgress: action.isFetching\r\n                    ? [...state.followingInProgress, action.userId]\r\n                    : state.followingInProgress.filter(id => id !== action.userId)\r\n            }\r\n            // debugger\r\n            return l\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport const setQuery = (query) => ({type: SET_QUERY, query })\r\nexport const followUnfollowSuccess = (userId, userRelation) => ({type: FOLLOW_UNFOLLOW, userId, userRelation })\r\n// export const unfollowSuccess = (userId, userRelation) => ({type: UNFOLLOW, userId, userRelation })\r\nexport const setUsers = (users) => ({type: SET_USERS, users })\r\nexport const setCurrentPage = (currentPage) => ({type: SET_CURRENT_PAGE, currentPage })\r\nexport const setTotalUsersCount = (totalUsersCount) => ({type: SET_TOTAL_USERS_COUNT, count: totalUsersCount })\r\nexport const toggleIsFetching = (isFetching) => ({type: TOGGLE_IS_FETCHING, isFetching })\r\nexport const toggleFollowingProgress = (isFetching, userId) => ({type: TOGGLE_IS_FOLLOWING_PROGRESS, isFetching, userId })\r\n\r\n\r\n\r\n\r\n\r\n// we dont actually need pageSize\r\nexport const requestUsers = (page, pageSize) => {\r\n    // debugger\r\n    return async(dispatch) => {\r\n        dispatch(toggleIsFetching(true));\r\n        dispatch(setCurrentPage(page));\r\n\r\n        let response =  await usersAPI.getUsers(page);\r\n        // debugger\r\n        \r\n        dispatch(toggleIsFetching(false));\r\n        dispatch(setUsers(response.data.users.items));\r\n        dispatch(setTotalUsersCount(response.data.users.totalCount));\r\n    }\r\n}\r\n\r\n\r\nexport const searchUsers = (page, query) => {\r\n    return async(dispatch) => {\r\n        dispatch(toggleIsFetching(true));\r\n        dispatch(setCurrentPage(page));\r\n\r\n        let response =  await usersAPI.getUsers(page, query);\r\n        // debugger\r\n        \r\n        dispatch(toggleIsFetching(false));\r\n        dispatch(setUsers(response.data.users.items));\r\n        dispatch(setTotalUsersCount(response.data.users.totalCount));\r\n    }\r\n}\r\n\r\nconst followUnfollowFlow = async(dispatch, userId, apiMethod, actionCreator) => {\r\n    dispatch(toggleFollowingProgress(true, userId));\r\n    // debugger\r\n    let response =  await apiMethod(userId);\r\n    // debugger\r\n    if (response.data.resultCode === 0 || response.data === '') {\r\n        let response2 = await usersAPI.getfollow(userId);\r\n        // debugger\r\n        if (response2.data.resultCode === 0) {\r\n            dispatch(actionCreator(userId, response2.data.data.userRelation));\r\n        }\r\n    }\r\n    dispatch(toggleFollowingProgress(false, userId));\r\n}\r\n\r\nexport const follow = (userId) => {\r\n    return (dispatch) => {\r\n        followUnfollowFlow(dispatch, userId, usersAPI.follow.bind(usersAPI), followUnfollowSuccess);\r\n    }\r\n}\r\nexport const unfollow = (userId) => {\r\n    return (dispatch) => {\r\n        followUnfollowFlow(dispatch, userId, usersAPI.unfollow.bind(usersAPI), followUnfollowSuccess);\r\n    }\r\n}\r\n\r\nexport default usersReducer;","/* eslint-disable jsx-a11y/anchor-is-valid */\r\n\r\nimport React from 'react';\r\nimport styles from \"./Users.module.scss\";\r\nimport userPhoto from \"../../assets/images/user.png\";\r\nimport {NavLink} from \"react-router-dom\";\r\n\r\nlet User = ({user, followingInProgress, unfollow, follow}) => {\r\n    console.log(user)\r\n    // debugger followed\r\n    return (\r\n       <div>\r\n                <span>\r\n                    <div>\r\n                       <NavLink to={'/profile/' + user.userId}>\r\n                        <img src={user.photos.small != null ? user.photos.small : userPhoto}\r\n                             className={styles.userPhoto}/>\r\n                       </NavLink>\r\n                    </div>\r\n                    <div>\r\n                        {(user.userRelation === 'subscription' || user.userRelation === 'friend')\r\n                        //['subscription', 'friend'].includes(user.userRelation)\r\n                        ?\r\n                            <button disabled={followingInProgress\r\n                                .some(id => id === user.userId)}\r\n                                      onClick={() => { unfollow(user.userId) }}>\r\n                                Unfollow</button>\r\n                        :\r\n                        // ||\r\n                        // (['subscriber', null].includes(user.userRelation) \r\n                        // &&\r\n                            <button disabled={followingInProgress\r\n                                .some(id => id === user.userId)}\r\n                                      onClick={() => { follow(user.userId) }}>\r\n                                      Follow</button>\r\n                        }\r\n\r\n                    </div>\r\n                </span>\r\n                <span>\r\n                    <span>\r\n                        <div>{user.name}</div>\r\n                        <div>{user.status}</div>\r\n                    </span>\r\n                    {/* <span>\r\n                        <div>{\"user.location.country\"}</div>\r\n                        <div>{\"user.location.city\"}</div>\r\n                    </span> */}\r\n                </span>\r\n            </div>)\r\n}\r\n\r\nexport default User;\r\n\r\n\r\n\r\nexport const ForChatUser = ({user, setSelectedForChatUsers, setSelectedForChatUser, selectedForChatUsers, chatUsersIds, styleForUser, ...props}) => {\r\n    // console.log(user)\r\n    // debugger followed // className={styleForUser}\r\n    // console.log([...selectedForChatUsers.filter(selUserId => selUserId !== user.userId)])\r\n    // console.log(selectedForChatUsers)\r\n    return ( \r\n        <div>\r\n            <NavLink to={'/profile/' + user.userId}>\r\n                <div >{user.name}</div>\r\n                <div className={styles.userChoosePhoto}><img src={user.photos.small} alt='Ava' /></div>\r\n            </NavLink>\r\n            { selectedForChatUsers \r\n            ?  \r\n                selectedForChatUsers.includes(user.userId) ? \r\n                // setSelectedForChatUsers ?\r\n                <a onClick={()=>{setSelectedForChatUsers( selectedForChatUsers.filter(selUserId => selUserId !== user.userId) )}}>Remove User</a> \r\n                // :\r\n                // null\r\n                // // null --- cause cant be anything - this bloack should be closed after 1 member choise \r\n                :\r\n                <a onClick={()=>{setSelectedForChatUsers([...selectedForChatUsers, user.userId])}}>Add User</a> \r\n\r\n            :\r\n                chatUsersIds.includes(user.userId) ? \r\n                    <div style={{color:\"blue\"}}>Chat Member</div>  \r\n                : \r\n\r\n                 <a onClick={()=>\r\n                    {\r\n                     setSelectedForChatUser(user.userId);\r\n                     console.log('after that should run inner function of useUserReducer '+ user.userId) \r\n                    //  props.clearCurrentFocusedWindow(props.fWAUFC) - dont work why???? but its better - cause i can choose a lot of users for adding to chat\r\n                    }\r\n                }>Add Member</a>  \r\n             }\r\n            \r\n        </div>\r\n             )\r\n}\r\n\r\n\r\n","import React, {useState} from 'react';\r\nimport styles from \"./paginator.module.scss\";\r\nimport cn from \"classnames\";\r\n\r\nlet Paginator = ({totalItemsCount, pageSize, currentPage, onPageChanged, portionSize = 10}) => {\r\n\r\n    let pagesCount = Math.ceil(totalItemsCount / pageSize);\r\n\r\n    let pages = [];\r\n    for (let i = 1; i <= pagesCount; i++) {\r\n        pages.push(i);\r\n    }\r\n\r\n    let portionCount = Math.ceil(pagesCount / portionSize);\r\n    let [portionNumber, setPortionNumber] = useState(1);\r\n    let leftPortionPageNumber = (portionNumber - 1) * portionSize + 1;\r\n    let rightPortionPageNumber = portionNumber * portionSize;\r\n\r\n\r\n    return <div className={styles.paginator}>\r\n        { portionNumber > 1 &&\r\n        <button onClick={() => setPortionNumber(portionNumber - 1)}>PREV</button> }\r\n\r\n            {pages\r\n                .filter(p => p >= leftPortionPageNumber && p<=rightPortionPageNumber)\r\n                .map((p) => {\r\n                return <span className={ cn({\r\n                    [styles.selectedPage]: currentPage === p\r\n                }, styles.pageNumber) }\r\n                             key={p}\r\n                             onClick={(e) => {\r\n                                 onPageChanged(p);\r\n                             }}>{p}</span>\r\n            })}\r\n        { portionCount > portionNumber &&\r\n            <button onClick={() => setPortionNumber(portionNumber + 1)}>NEXT</button> }\r\n\r\n\r\n    </div>\r\n}\r\n\r\nexport default Paginator;","import React from 'react';\r\n\r\n// import Paginator from \"../common/Paginator/Paginator\";\r\nimport User, { ForChatUser } from \"./User\";\r\nimport Paginator from '../common/Paginator/Paginator';\r\n\r\n\r\nlet Users = ({currentPage, totalUsersCount, pageSize, onPageChanged, users, forChat=false, \r\n                                                                                            setSelectedForChatUsers, setSelectedForChatUser,  chatUsersIds,\r\n    selectedForChatUsers, styleForUsers, styleForUser , ...props}) => {\r\n        // console.log('Users for ForChatUser')\r\n        // console.log(chatUsersIds)\r\n        // debugger\r\n    return <div>\r\n        <Paginator currentPage={currentPage} onPageChanged={onPageChanged}\r\n                   totalItemsCount={totalUsersCount} pageSize={pageSize}/>\r\n        <div>\r\n            {\r\n                users.map(u => forChat ? <ForChatUser user={u}\r\n\r\n                                    setSelectedForChatUsers ={setSelectedForChatUsers} // can be undef if it member adding\r\n                                    setSelectedForChatUser={setSelectedForChatUser}\r\n                                    selectedForChatUsers={selectedForChatUsers} // can be undef if it member adding\r\n                                    styleForUser= {styleForUser}\r\n                                    chatUsersIds = {chatUsersIds}\r\n\r\n                                    // toogleFocuseElemArr={props.toogleFocuseElemArr}\r\n                                    // usersForChatShow={props.usersForChatShow} \r\n                                    // setUsersForChatShow={props.setUsersForChatShow}\r\n                                    fWAUFC={props.fWAUFC}\r\n                                    clearCurrentFocusedWindow={props.clearCurrentFocusedWindow}\r\n\r\n\r\n\r\n                                     key={u.id}/>                 \r\n                                     :\r\n                                     <User user={u}\r\n                                     followingInProgress={props.followingInProgress}\r\n                                     key={u.id}\r\n                                     unfollow={props.unfollow}\r\n                                     follow={props.follow}/>  \r\n                )\r\n            }\r\n        </div>\r\n    </div>\r\n}\r\n\r\nexport default Users;","import { createSelector } from \"reselect\";\r\nimport replaceQuotes from \"../components/common/utils/quotes\";\r\n\r\nexport const getUsersPrimitiveSelector = state => {\r\n    return  state.usersPage.users;//.filter(u => true);\r\n}\r\n\r\n// export const getUsersSelector = state => {\r\n//     return getUsers().filter(u => true);\r\n// }\r\n\r\n// we dont need to backupQuotes cause we cant edit other users profile pages\r\nexport const getUsers = createSelector( getUsersPrimitiveSelector, (users) => {\r\n    let k = users.map(u => ({...u, photos: replaceQuotes(u.photos)}))\r\n    // debugger\r\n    return k\r\n})\r\n\r\nexport const getQuery = state => {\r\n    return state.usersPage.query;\r\n}\r\n\r\nexport const getPageSize = state => {\r\n    return  state.usersPage.pageSize;\r\n}\r\n\r\nexport const getTotalUsersCount = state => {\r\n    return  state.usersPage.totalUsersCount;\r\n}\r\n\r\n\r\nexport const getCurrentPage = state => {\r\n    return  state.usersPage.currentPage;\r\n}\r\n\r\n\r\nexport const getIsFetching = state => {\r\n    return  state.usersPage.isFetching;\r\n}\r\n\r\n\r\nexport const getFollowingInProgress = state => {\r\n    return  state.usersPage.followingInProgress;\r\n}\r\n\r\n\r\n// export const getUsersSuperSelector2 = createSelector( getUsers, getIsFetching, (users, isFetching) => {\r\n//     return users.filter(u => true);\r\n// })\r\n","import React from 'react';\r\nimport { createField, Input } from '../common/FormsControls/FormsControls';\r\nimport { reduxForm } from 'redux-form';\r\nimport { maxLength50 } from '../../utils/validators/validators';\r\nimport styles from '../common/FormsControls/FormsControls.module.scss'\r\nimport { searchUsers , setQuery} from '../../redux/users-reducer';\r\nimport { connect } from 'react-redux';\r\nimport {getCurrentPage, getQuery} from \"../../redux/users-selectors\";\r\n\r\nconst UsersSearchForm = props => {\r\n    const { handleSubmit, pristine, reset, submitting, error, query } = props\r\n    return (\r\n        <form onSubmit={handleSubmit} autoComplete='off'>\r\n            {createField(query, \"search\", Input, [maxLength50], {defaultValue: ''})}\r\n            {\r\n            error && \r\n            <div className={styles.formSummaryError}>\r\n                {error}\r\n            </div>\r\n            }\r\n            <div className=''>\r\n                <button type='submit' disabled={submitting} >Run</button>\r\n            </div>\r\n            <div className=''>\r\n                <button type='button' disabled={pristine || submitting} onClick={reset}>Clear Values</button>\r\n            </div>\r\n        </form>\r\n    )\r\n}\r\n\r\nconst UsersSearchReduxForm = reduxForm({form:'UsersSearch'})(UsersSearchForm)\r\n\r\nconst UsersSearch = (props) => {\r\n    const onSubmit = (formData) => {\r\n        props.setQuery(formData.search)\r\n        props.searchUsers(props.currentPage, formData.search)\r\n    }\r\n    // if(props.isAuth) return (<Redirect to='/profile'/>)\r\n\r\n    return (<>\r\n        <div className=''>\r\n            <label htmlFor=\"\">SEARCH: </label><UsersSearchReduxForm onSubmit={onSubmit}  />\r\n        </div>\r\n        </>)\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n    currentPage: getCurrentPage(state),\r\n    query: getQuery(state),\r\n});\r\n\r\n\r\nexport default connect(mapStateToProps, {searchUsers, setQuery})(UsersSearch);\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport {\r\n    follow,\r\n    setCurrentPage,\r\n    unfollow, toggleFollowingProgress, \r\n    requestUsers, \r\n    searchUsers,\r\n    setQuery\r\n} from '../../redux/users-reducer';\r\nimport Users from './Users';\r\nimport Preloader from \"../common/Preloader/Preloader\";\r\nimport { compose } from \"redux\";\r\nimport {\r\n    getCurrentPage,\r\n    getFollowingInProgress,\r\n    getIsFetching,\r\n    getPageSize,\r\n    getTotalUsersCount, getUsers, getQuery\r\n} from \"../../redux/users-selectors\";\r\nimport UsersSearch from './UsersSearch';\r\n\r\n// import { useUsersEffects } from '../../customHooks/usersHooks';\r\n\r\n\r\n// export function useQuering(isWithQuery){\r\n//     const [queried, setQueried] = useState(null)\r\n//     useEffect(()=>{\r\n//         setQueried(isWithQuery)\r\n//     },[isWithQuery])\r\n//     return queried\r\n// }\r\n\r\n// chatUsersIds // filter list\r\n// onClick={() => {props.toogleFocuseElem(props.setUsersForChatShow, props.usersForChatShow);onSubmit();}} // blur memberlist -> send to api request\r\n\r\n\r\n// setQuery - delete query discard\r\n\r\n\r\nclass UsersContainer extends React.Component{\r\n\r\n    componentDidMount(){\r\n        this.props.query==='' ? this.props.getUsers(this.props.currentPage, this.props.pageSize) : this.props.searchUsers(this.props.currentPage, this.props.query);\r\n    }\r\n\r\n    componentDidUpdate(){\r\n    }\r\n\r\n    componentWillUnmount(){\r\n        this.props.setQuery('')\r\n    }\r\n\r\n    onPageChanged = (pageNumber) => {\r\n        this.props.query==='' ? this.props.getUsers(pageNumber, this.props.pageSize) : this.props.searchUsers(pageNumber, this.props.query);\r\n    }\r\n\r\n\r\n    render(){\r\n        return (\r\n            <div className={this.props.styleForUsers ? this.props.styleForUsers: ''}>\r\n                {this.props.isFetching ? <Preloader /> : null}\r\n                <div >\r\n                    <UsersSearch/>\r\n                </div>\r\n                { this.props.fWUFCID === 0 ?   \r\n                <a onClick={ () =>  this.props.clearCurrentFocusedWindow(this.props.fWUFCID) }>\r\n                    End Selection\r\n                </a>\r\n                : null}\r\n                \r\n                <Users  \r\n                    totalUsersCount={this.props.totalUsersCount}\r\n                    pageSize={this.props.pageSize}\r\n                    currentPage={this.props.currentPage}\r\n                    onPageChanged={this.onPageChanged}\r\n                    users={this.props.users}\r\n                    follow={this.props.follow}\r\n                    unfollow={this.props.unfollow}\r\n                    followingInProgress={this.props.followingInProgress}\r\n\r\n\r\n                    forChat = {this.props.forChat}\r\n\r\n\r\n                    setSelectedForChatUsers = {this.props.setSelectedForChatUsers} // can be undef if it member adding\r\n                    setSelectedForChatUser = {this.props.setSelectedForChatUser} // can be undef if it chat creation\r\n                    chatUsersIds = {this.props.chatUsersIds} // can be undef if it chat creation \r\n                    // toogleFocuseElemArr={props.toogleFocuseElemArr}\r\n                    // usersForChatShow={props.usersForChatShow}  \r\n                    // setUsersForChatShow={props.setUsersForChatShow} // can be undef if it chat creation\r\n                    fWAUFC={this.props.fWAUFC}\r\n                    clearCurrentFocusedWindow={this.props.clearCurrentFocusedWindow}\r\n\r\n\r\n                    selectedForChatUsers={this.props.selectedForChatUsers} // can be undef if it member adding\r\n                    styleForUsers= {this.props.styleForUsers}\r\n                    styleForUser={this.props.styleForUser}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n// const UsersContainer = (props) => { \r\n//     const [onPageChanged] = useUsersEffects(props.getUsers, props.searchUsers, props.query, props.currentPage, props.pageSize)\r\n \r\n\r\n//     return (<div className={props.styleForUsers ? props.styleForUsers: ''}>\r\n//         {props.isFetching ? <Preloader /> : null}\r\n//         <div >\r\n//             <UsersSearch/>\r\n//         </div>\r\n//         { props.fWUFCID === 0 ?   \r\n//         <a onClick={ () =>  props.clearCurrentFocusedWindow(props.fWUFCID) }>\r\n//             End Selection\r\n//         </a>\r\n//         : null}\r\n        \r\n//         <Users  \r\n//             totalUsersCount={props.totalUsersCount}\r\n//             pageSize={props.pageSize}\r\n//             currentPage={props.currentPage}\r\n//             onPageChanged={onPageChanged}\r\n//             users={props.users}\r\n//             follow={props.follow}\r\n//             unfollow={props.unfollow}\r\n//             followingInProgress={props.followingInProgress}\r\n\r\n\r\n//             forChat = {props.forChat}\r\n\r\n\r\n//             setSelectedForChatUsers = {props.setSelectedForChatUsers} // can be undef if it member adding\r\n//             setSelectedForChatUser = {props.setSelectedForChatUser} // can be undef if it chat creation\r\n//             chatUsersIds = {props.chatUsersIds} // can be undef if it chat creation \r\n//             // toogleFocuseElemArr={props.toogleFocuseElemArr}\r\n//             // usersForChatShow={props.usersForChatShow}  \r\n//             // setUsersForChatShow={props.setUsersForChatShow} // can be undef if it chat creation\r\n//             fWAUFC={props.fWAUFC}\r\n//             clearCurrentFocusedWindow={props.clearCurrentFocusedWindow}\r\n\r\n\r\n//             selectedForChatUsers={props.selectedForChatUsers} // can be undef if it member adding\r\n//             styleForUsers= {props.styleForUsers}\r\n//             styleForUser={props.styleForUser}\r\n//         />\r\n//     </div>)\r\n// }\r\n\r\n\r\nlet mapStateToProps = (state) => {\r\n    return {\r\n        users: getUsers(state),\r\n        pageSize: getPageSize(state),\r\n        totalUsersCount: getTotalUsersCount(state),\r\n        currentPage: getCurrentPage(state),\r\n        isFetching: getIsFetching(state),\r\n        followingInProgress: getFollowingInProgress(state),\r\n        query: getQuery(state),\r\n    }\r\n}\r\n\r\n\r\nexport default compose(\r\n    connect(mapStateToProps, { follow, unfollow, setCurrentPage, toggleFollowingProgress, getUsers: requestUsers, searchUsers,\r\n        setQuery })\r\n)(UsersContainer)\r\n\r\n// class UsersContainer extends React.Component {\r\n\r\n//     getValidToken(){\r\n//         // console.log(`props token ${this.props.token}`);\r\n//         // console.log(`props ${this.props}`);\r\n//         return {\r\n//             headers: {\r\n//                 'Authorization': 'Bearer ' + this.props.token\r\n//               }\r\n//             }\r\n//     }\r\n\r\n//     // setValidToken(){\r\n\r\n//     // }\r\n\r\n//     componentDidMount() {\r\n//         if(this.props.token === null){\r\n//             return\r\n//         }\r\n//         // console.log(`props token ${this.props.token}`);\r\n//         // console.log(`props ${this.props}`);\r\n//         console.log('Im inside the DOM');\r\n//         console.log(`${this.props.token}`);\r\n//         // console.log(`\\ngetValidToken\\n${this.props.token}`);\r\n//         this.props.toggleIsFetching(true);\r\n//         // 'https://social-network.samuraijs.com/api/1.0/users'\r\n//         Axios.get(`http://127.0.0.1:8000/api/users?page=${this.props.currentPage}&limit=${this.props.pageSize}`, this.getValidToken()).then(response => {\r\n\r\n//             // console.log(response.data.data.items);\r\n//             // debugger;\r\n//             //response.data -- all json data\r\n//             // response.data.data -- data from json string\r\n//             // response.data.data.items -- data element to watch all users like in a list\r\n//             response.data.users.items = response.data.users.items.map(user => ({...user, photos:replaceQuotes(user.photos)}))\r\n//             // console.log(response.data);\r\n//             this.props.setUsers(response.data.users.items)\r\n//             // console.log(this.props.users);\r\n//             this.props.toggleIsFetching(false);\r\n//             // console.log(response.data.data.totalCount);\r\n//             this.props.setTotalUsersCount(response.data.users.totalCount)\r\n//         }).catch(function (error) {\r\n//             console.log(error);\r\n//         });\r\n//     }\r\n\r\n//     componentDidUpdate() {\r\n//         // console.log('Im update the DOM');\r\n//         // console.log(`${this.props.token}`);\r\n//     }\r\n\r\n//     onPageChanged = (page) => {\r\n//         console.log(`${this.props.token}`);\r\n\r\n//         this.props.setCurrentPage(page);\r\n//         this.props.toggleIsFetching(true);\r\n//         Axios.get(`http://127.0.0.1:8000/api/users?page=${page}&limit=${this.props.pageSize}`, this.getValidToken()).then(response => {\r\n//             // console.log(response.data.users.items);\r\n//             // debugger;\r\n//             response.data.users.items = response.data.users.items.map(user => ({...user, photos:replaceQuotes(user.photos)}))\r\n//             this.props.setUsers(response.data.users.items)\r\n//             this.props.toggleIsFetching(false);\r\n//         }).catch(function (error) {\r\n//             console.log(error);\r\n//         });\r\n//     }\r\n\r\n//     render() {\r\n//         if(this.props.token === null){\r\n//             return <Redirect to='/login'/>\r\n//         }\r\n\r\n//         return (<>\r\n//         {this.props.isFetching ? <Preloader /> : null}\r\n//         <Users totalUsersCount={this.props.totalUsersCount}\r\n//         pageSize={this.props.pageSize}\r\n//         currentPage={this.props.currentPage}\r\n//         users={this.props.users}\r\n//         onPageChanged={this.onPageChanged}\r\n//         follow={this.props.follow}\r\n//         unfollow={this.props.unfollow}\r\n\r\n//         token={this.props.token}\r\n//         userId={this.props.userId}\r\n\r\n//         />\r\n//         </>)\r\n//     }\r\n\r\n// }\r\n\r\n// const mapStateToProps = (state) => ({\r\n//         users: state.usersPage.users,\r\n//         pageSize: state.usersPage.pageSize,\r\n//         totalUsersCount: state.usersPage.totalUsersCount,\r\n//         currentPage: state.usersPage.currentPage,\r\n//         isFetching: state.usersPage.isFetching,\r\n//         // for fixing followed error (UNauthorized user because of lack token)\r\n//         // selfUserId: state.profilePage.selfUserId,\r\n//         // token: state.profilePage.token,\r\n//         // newPostText: state.profilePage.newPostText\r\n\r\n//         token: state.auth.token,\r\n//         userId: state.auth.userId,\r\n// });\r\n\r\n// const mapDispatchToProps = (dispatch) => {\r\n\r\n    // return {\r\n    //     follow: (userId) => {\r\n    //         dispatch(followAC(userId));\r\n    //     },\r\n    //     unfollow: (userId) => {\r\n    //         dispatch(unfollowAC(userId));\r\n    //     },\r\n    //     setUsers: (users) => {\r\n    //         dispatch(setUsersAC(users));\r\n    //     },\r\n    //     setCurrentPage: (currentPage) => {\r\n    //         dispatch(setCurrentPageAC(currentPage));\r\n    //     },\r\n    //     setTotalUsersCount: (totalUsersCount) => {\r\n    //         dispatch(setTotalUsersCountAC(totalUsersCount));\r\n    //     },\r\n    //     toggleIsFetching: (IsFetching) => {\r\n    //         dispatch(toggleIsFetchingAC(IsFetching));\r\n    //     }\r\n    // }\r\n// }\r\n\r\n\r\n// export default connect(mapStateToProps,\r\n//     {follow, unfollow, setUsers, setCurrentPage, setTotalUsersCount, toggleIsFetching})(UsersContainer);\r\n\r\n// export default UsersContainer;","/* eslint-disable jsx-a11y/alt-text */\r\n/* eslint-disable jsx-a11y/anchor-is-valid */\r\n\r\nimport React from 'react';\r\nimport s from './../Chats.module.scss';\r\nimport styleMessages from './../Message/Message.module.scss';\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { convertTime } from '../../common/utils/convertTime';\r\nimport Preloader from '../../common/Preloader/Preloader';\r\nimport { ReduxFormSnippet, createField, Input, DropDownSelect } from '../../common/FormsControls/FormsControls';\r\nimport { maxLength200, maxLength1000 } from '../../../utils/validators/validators';\r\nimport { reduxForm } from 'redux-form';\r\nimport backupQuotes from '../../common/utils/backupQuotes';\r\nimport { useState } from 'react';\r\nimport UsersContainer from '../../Users/UsersContainer';\r\n// import { useUserSelector } from '../ChatsContainer';\r\n\r\n\r\n////////////////////\r\n// const AddChatMemberForm = (props) => {\r\n//     const { handleSubmit, pristine, reset, submitting, error, snusers, chatUsersIds, msgStyle } = props // chatUsersIds - list of ids from chat members\r\n//     // console.log(props)\r\n//     return (\r\n//         <form onSubmit={handleSubmit} className={`${msgStyle} ${s.addBorder}`}>\r\n//         {createField('DropDownSelect', 'dropDownSelect', DropDownSelect, null, {people:  snusers.filter(snuser => !chatUsersIds.includes(snuser.userId))})}\r\n//         <ReduxFormSnippet  pristine={pristine} reset={reset} submitting={submitting} error={error} sumbitButtonName={'Add Member'}/>\r\n//         </form>\r\n//     )\r\n// }\r\n\r\n// const AddChatMemberFormRedux = reduxForm({form: 'addChatMember'})(AddChatMemberForm)\r\n\r\n// export const AddChatMember = ({addMember, chatTypeId, chatId, snusers, chatUsersIds, msgStyle=''}) => {\r\n//     const onSubmit = (formData) => {\r\n//         addMember(chatTypeId, chatId, formData['dropDownSelect'])\r\n//     }\r\n//     return  <AddChatMemberFormRedux onSubmit={onSubmit} snusers={snusers} chatUsersIds={chatUsersIds} msgStyle={msgStyle}/>\r\n// }\r\n////////////////////\r\n\r\n//////////////////// styleMessages.chatsSettingsItemForm\r\n\r\nconst ChangeChatPhotoForm = (props) => {\r\n    const { handleSubmit, pristine, reset, submitting, error, msgStyle } = props\r\n    return ( // className={s.changeChatPhotoForm} chatsSettingsItem\r\n        <form onSubmit={handleSubmit} className={`${msgStyle}`} autoComplete='off'>\r\n            {createField('Photo', 'photo', Input, [maxLength1000])}\r\n            <ReduxFormSnippet  pristine={pristine} reset={reset} submitting={submitting} error={error} sumbitButtonName={'Change Photo'}/>\r\n        </form>\r\n    )\r\n}\r\n\r\nconst ChangeChatPhotoFormRedux = reduxForm({form: 'chageChatPhoto'})(ChangeChatPhotoForm)\r\n\r\n\r\nexport const ChangeChatPhoto = ({setChatPhotoRequest, chatTypeId, chatId, msgStyle=''}) => {\r\n    const onSubmit = (formData) => { // or JSON.stringify\r\n        let newPhotoObject = backupQuotes({'large': null, 'small': formData['photo']})\r\n        setChatPhotoRequest(chatTypeId, chatId, newPhotoObject)\r\n    }\r\n    return  <ChangeChatPhotoFormRedux onSubmit={onSubmit} msgStyle={msgStyle}/>\r\n}\r\n////////////////////\r\n\r\n//////////////////// {styleMessages.chatsSettingsItem}\r\nconst RenameChatForm = (props) => {\r\n    const { handleSubmit, pristine, reset, submitting, error, msgStyle } = props\r\n    // let msgStyle = styleMessageClass ? styleMessages.chatsSettingsItemForm : ''\r\n    return ( // className={s.renameChatForm}\r\n        <form onSubmit={handleSubmit} className={`${msgStyle}`} autoComplete='off'>\r\n            {createField('Name', 'name', Input, [maxLength200])}\r\n            <ReduxFormSnippet  pristine={pristine} reset={reset} submitting={submitting} error={error} sumbitButtonName={'Rename Chat'}/>\r\n        </form>\r\n    )\r\n}\r\n\r\nconst RenameChatFormRedux = reduxForm({form: 'renameChat'})(RenameChatForm)\r\n\r\nexport const RenameChat = ({renameChatRequest, chatTypeId, chatId, msgStyle=''}) => {\r\n    const onSubmit = (formData) => {\r\n        renameChatRequest(chatTypeId, chatId, formData['name'])\r\n    }\r\n    return  <RenameChatFormRedux onSubmit={onSubmit} msgStyle={msgStyle}/>\r\n}\r\n////////////////////\r\n\r\n// setMembersShow(event);\r\nexport const Member = ({ member, memberStyle, chatMemberSettings=null, setMemberOperShow=null, setSelectedMember=null }) => {\r\n    return (\r\n        <>\r\n        <div className={memberStyle}>\r\n            <NavLink to={'/profile/' + member.id}>\r\n                <div className={s.memberName}>{member.name}</div>\r\n                <div className={s.memberPhoto}><img src={member.photos.small} alt='Ava' /></div>\r\n            </NavLink>\r\n            {chatMemberSettings ? <a className={chatMemberSettings} onClick={(event) => {setSelectedMember(member.id); setMemberOperShow(event)}}>Operations</a>: null}\r\n        </div>\r\n        {/* <br/> */}\r\n        </>\r\n    )\r\n}\r\n\r\n\r\n\r\nexport const Members = ({members, membersShow, memberOperShow, selectedMember, memberOpers}) => { // <Member />\r\n    \r\n    return(\r\n        <>\r\n\r\n        <div className={membersShow ? styleMessages.chatsMembersActive : styleMessages.chatsMembers}>\r\n            <div className={membersShow ? styleMessages.chatsMembersActive : styleMessages.chatsMembers}>{members}</div>\r\n        </div>\r\n        \r\n        <div className={memberOperShow ? `${styleMessages.smthElseListActive}`: `${s.smthElseList}`}>\r\n            \r\n            {memberOpers.map(memberOper => \r\n                <div className={`${styleMessages.subElemMSBs} ${styleMessages.infoItemMSBs}`}>\r\n                    <a className={`${styleMessages.membOperLink}`} onClick={memberOper.method(selectedMember)}>{memberOper.name}</a>\r\n                </div>\r\n            )}\r\n        </div>\r\n        </>\r\n    )\r\n}\r\n\r\n\r\nexport const SelectMemberToChat = (props) => {\r\n\r\n    const onSubmit = (selectedForChatUser) => {\r\n        console.log('pre api')\r\n        props.addMember(props.chatTypeId, props.chatId, selectedForChatUser)\r\n    }\r\n\r\n    return (\r\n        <div  className={s.getMemberList} onClick={(event)=>{event.stopPropagation();}}>\r\n        <UsersContainer\r\n        setSelectedForChatUser = {onSubmit} \r\n        forChat={true} \r\n        styleForUsers={styleMessages.usersForChatActive} \r\n        styleForUser={styleMessages.userForChat}\r\n        fWAUFC={props.fWAUFC}\r\n        clearCurrentFocusedWindow={props.clearCurrentFocusedWindow}\r\n        // setUsersForChatShow={setUserForChatShow}\r\n        // toogleFocuseElemArr={toogleFocuseElemArr} // при выборе юзер - закрываем окно\r\n        chatUsersIds={props.chatUsersIds}  \r\n        />\r\n      </div>\r\n    )\r\n}\r\n\r\n\r\nconst LastMessage = ({ sended, body, authorName }) => {\r\n    return (\r\n        <>\r\n            <div className={s.chatLMAuthorName}>{authorName} </div>\r\n            <div className={s.chatLMAuthorNameDotted}>:</div>\r\n            {/* <div className={s.chatLMBody}>{body.length > 30 ? `${ body.slice(0,27)}...`: body}</div>\r\n             */}\r\n                <div className={s.chatLMBody}>{body}</div>\r\n            <div className={s.chatLMSended}>{convertTime(sended)}</div>\r\n        </>\r\n    )\r\n}\r\n\r\n\r\nconst ChatItem = ({ lastMessage, getCountOfNewGlobalMsgs, members, chatType, name, setCurrentChatData, chatTypeId, chatId, chatPhotoSmall, isFetching, \r\n                    clearChatMyLocal, clearChatMyGlobal, clearChatAllLocal, clearChatAllGlobal,\r\n                    renameChatRequest, deleteChatRequest, addMember, setChatPhotoRequest,\r\n                    ...props  \r\n                }) => {\r\n\r\n\r\n    const unmout = () => {\r\n        setCurrentChatData(chatTypeId, chatId)\r\n    }\r\n\r\n    const clearChatByMethod = (method) => {\r\n        // debugger\r\n        method(chatTypeId, chatId)\r\n    }\r\n\r\n    // const putChatByMethod = (method, putData) => {\r\n    //     method(chatTypeId, chatId, putData)\r\n    // }\r\n\r\n    let path = `/chats/${chatType}/${name}/`\r\n    let chatUsersIds = members.map(member => member.id)\r\n    members = members.map(member => <Member member={member} key={member.id} memberStyle={`${s.member} ${s.subElem2}`} />)\r\n    if(isFetching) return <Preloader />\r\n    // console.log(userForChatShow)\r\n    \r\n    return (\r\n        <>\r\n        {\r\n        // add member\r\n        props.fWAUFC.data !== null && props.fWAUFC.data[1] === chatId && props.fWAUFC.data[0] === chatTypeId  &&\r\n            <div className={s.addMember}>\r\n                <div className={s.addMemberHeader}>\r\n                <SelectMemberToChat addMember={addMember} chatTypeId={chatTypeId} chatId={chatId} chatUsersIds={chatUsersIds}\r\n                    clearCurrentFocusedWindow={props.clearCurrentFocusedWindow} \r\n                    fWAUFC={props.fWAUFC}/>\r\n                 </div>\r\n            </div>\r\n                }\r\n\r\n\r\n\r\n\r\n        <div className={s.chatItem}>\r\n            <NavLink to={path} className={s.chatItemData} onClick={unmout}>\r\n                <div className={s.chatItemPhoto}>\r\n                    {/* <img src={(chatPhoto==='') ? (chatTypeId===0) ? members.find(member=>userId!==member.id).photos.small : 'chatPhoto' : chatPhoto} alt='chatPhoto'/> */}\r\n                    {chatPhotoSmall !== null ? <img src={chatPhotoSmall} /> : <div className=''>chatPhotoSmall</div>}\r\n                </div>\r\n                    {/* lastMessage: */}\r\n                    {Object.keys(lastMessage).length > 0 ? <LastMessage sended={lastMessage.sended} body={lastMessage.body} key={lastMessage.id} authorName={lastMessage.authorName} /> : null}\r\n                <div className={s.chatItemNewMsgsNum}>{getCountOfNewGlobalMsgs}</div>\r\n\r\n                <div className={s.chatItemName}>\r\n                    {name}\r\n                </div>\r\n            </NavLink>\r\n                <div className={s.chatSettings}>\r\n                Settings:\r\n                    <div className={s.chatSettingsHeader}>\r\n                        <div className={s.chatSettingsMembersListHeader}>\r\n                            members:\r\n                            <div className={s.chatSettingsMembersList}>\r\n                                {members}\r\n                            </div>\r\n                        </div>\r\n                        <div className={s.smthElseHeader} >\r\n                                clear chat:\r\n                                <div className={s.smthElseList}>\r\n                                        <div className={`${s.subElem} ${s.infoItem}`}><button onClick={() => clearChatByMethod(clearChatMyLocal)}>Clear My Messages Locally</button></div>\r\n                                        <div className={`${s.subElem} ${s.infoItem}`}><button onClick={() => clearChatByMethod(clearChatMyGlobal)}>Clear My Messages Globally</button></div>\r\n                                        <div className={`${s.subElem} ${s.infoItem}`}><button onClick={() => clearChatByMethod(clearChatAllLocal)}>Clear All Messages Locally</button></div>\r\n                                        <div className={`${s.subElem} ${s.infoItem}`}><button onClick={() => clearChatByMethod(clearChatAllGlobal)}>Clear All Messages Globally</button></div>\r\n                                </div>\r\n                        </div>\r\n                        <div className={s.renameChatHeader}>\r\n                            rename\r\n                            { chatTypeId === 1 && <div className={s.renameChatItem}>\r\n                                <RenameChat renameChatRequest={renameChatRequest} chatTypeId={chatTypeId} chatId={chatId}/>\r\n                            </div>}\r\n                            \r\n                        </div>\r\n                        <div className={s.smthElseHeader}>\r\n                            other operations\r\n                            <div className={s.smthElseList}>\r\n                                    <div className={`${s.subElem} ${s.infoItem}`}>\r\n                                        set photo\r\n                                        { chatTypeId === 1 && <div className={s.changePhotoChat}>\r\n                                            <ChangeChatPhoto setChatPhotoRequest={setChatPhotoRequest} chatTypeId={chatTypeId} chatId={chatId}/>\r\n                                        </div>}\r\n                                    </div>\r\n\r\n                                    <div className={`${s.subElem} ${s.infoItem}`}>\r\n                                        \r\n\r\n                                        \r\n                                    { chatTypeId === 1 &&\r\n                                    <div className={s.addMemberItem}>\r\n                                    { props.fWAUFC.data === null  && // make true from false to open element ( but i should push here userId and after by userId show itself user list)\r\n                                        <a \r\n                                        onClick={\r\n                                            (event) => (event.stopPropagation(), props.addFocusedWindow(props.fWAUFC.id, [chatTypeId, chatId]))\r\n                                         }> \r\n                                            Add Member\r\n                                        </a>\r\n                                    }\r\n                                    </div>\r\n                                    }\r\n                                    </div>\r\n\r\n                                    <div className={`${s.deleteChat} ${s.subElem} ${s.infoItem}`}><button onClick={() => clearChatByMethod(deleteChatRequest)}>DELETE CHAT</button></div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n        </div> \r\n        </>)\r\n}\r\n\r\nexport default ChatItem;\r\n\r\n\r\n// chatItemMemberList - всплывающий список ( при нажатии с прокруткой ( или при наведении))","import { createSelector } from \"reselect\";\r\nimport replaceQuotes from \"../components/common/utils/quotes\";\r\n\r\n\r\nexport const selectChatsPrimitiveSelector = state => {\r\n    return  state.chatsPage.chats;//.filter(u => true);\r\n}\r\nexport const selectChats = createSelector( selectChatsPrimitiveSelector, (chats) => {\r\n        return chats.map(chat => ({...chat, members: chat.members.map(member => ({...member, photos: replaceQuotes(member.photos)})), chatPhoto: replaceQuotes(chat.chatPhoto)}))\r\n})\r\n\r\n\r\nexport const selectChatMessages = state => {\r\n    return  state.chatsPage.messages;//.filter(u => true);\r\n}\r\n\r\n\r\nexport const selectCTIPS = state => {\r\n    return state.chatsPage.chatTypeId;\r\n}\r\nexport const selectCIPS = state => {\r\n    return state.chatsPage.chatId;\r\n}\r\n\r\nexport const selectCurrentChatPS = state => {\r\n    return  state.chatsPage.currentChat\r\n}\r\n\r\nexport const selectCurrentChat = createSelector( selectCurrentChatPS, (chat) => {\r\n    return chat!==null ? {...chat, members: chat.members.map(member => ({...member, photos: replaceQuotes(member.photos)})), chatPhoto: replaceQuotes(chat.chatPhoto)} : null\r\n})\r\n\r\n\r\n\r\n\r\nexport const selectFocusedWindowsPS = state => {\r\n    return  state.app.focusedWindows;//.filter(u => true);\r\n}\r\nexport const selectFocusedWindowsIdsPS = state => {\r\n    return  state.app.focusedWindowsIds;//.filter(u => true);\r\n}\r\n\r\nexport const selectFocusedWindow = (windowIdKey) => createSelector( selectFocusedWindowsPS, selectFocusedWindowsIdsPS,  (focusedWindows, focusedWindowsIds) => {\r\n    // debugger\r\n    return focusedWindows.find(window => window.id === focusedWindowsIds[windowIdKey]) || {'id': focusedWindowsIds[windowIdKey], 'data': null} // {'id':, 'data'}\r\n})\r\n\r\nexport const selectFocusedWindowUsersForChat = selectFocusedWindow(\"fWUsersFCId\")\r\nexport const selectFocusedWindowAddUserForChat = selectFocusedWindow(\"fWAddUserFCId\")\r\nexport const selectFocusedWindowMembersForChat = selectFocusedWindow(\"fWMembersId\")\r\nexport const selectFocusedWindowMemberOperationsForChat = selectFocusedWindow(\"fWMemberOperationsId\")","// import {authAPI} from \"../api/api\";\r\nimport { getAuthUserData, setAuthUserData } from \"./auth-reducer\";\r\n\r\nconst INITIALIZED_SUCCESS = 'INITIALIZED_SUCCESS';\r\nconst ADD_FOCUSED_WINDOW = 'SET_FOCUSED_WINDOWS';\r\nconst CLEAR_FOCUSED_WINDOWS = 'CLEAR_FOCUSED_WINDOWS';\r\nconst CLEAR_CURRENT_FOCUSED_WINDOW = 'CLEAR_CURRENT_FOCUSED_WINDOW';\r\n\r\nlet initialState = {\r\n    initialized: false,\r\n    focusedWindows: [],\r\n    focusedWindowsIds: {fWUsersFCId: 0, fWAddUserFCId: 1, fWMembersId: 2, fWMemberOperationsId: 3}\r\n};\r\n\r\nconst appReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case INITIALIZED_SUCCESS:\r\n\r\n            return {\r\n                ...state,\r\n                initialized: true\r\n            }\r\n\r\n        case ADD_FOCUSED_WINDOW:\r\n\r\n            return {\r\n                ...state,\r\n                focusedWindows: [...state.focusedWindows, action.newFocusedWindow]\r\n            }\r\n\r\n        case CLEAR_FOCUSED_WINDOWS:\r\n            // debugger\r\n                return {\r\n                    ...state,\r\n                    focusedWindows: []\r\n                }\r\n        \r\n        case CLEAR_CURRENT_FOCUSED_WINDOW: \r\n            // debugger\r\n            return {\r\n                ...state,\r\n                focusedWindows: state.focusedWindows.filter(window=> window.id !== action.currentWindowId)\r\n            }\r\n\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport const initializedSuccess = () => ({type: INITIALIZED_SUCCESS })\r\n\r\nexport const addFocusedWindow = (id, data) => ({type: ADD_FOCUSED_WINDOW, newFocusedWindow: {id: id, data: data} }) // id, data\r\nexport const clearAllFocusedWindows = () => ({type: CLEAR_FOCUSED_WINDOWS})\r\nexport const clearCurrentFocusedWindow = (currentWindowId) => ({type: CLEAR_CURRENT_FOCUSED_WINDOW, currentWindowId})\r\n\r\n\r\nexport const initializeApp = () => (dispatch) => {\r\n    // debugger \r\n    Promise.all([dispatch(getAuthUserData())])\r\n    .then( resolve => {\r\n        // debugger\r\n        // console.log('hui')\r\n        dispatch(initializedSuccess());\r\n    }).catch(error => \r\n        {\r\n            // debugger\r\n            if([\"Signature has expired.\", \"Error decoding signature.\", \"Invalid Authorization header. No credentials provided.\"].includes(error.response.data.detail)){\r\n                // console.log(error.response.data.detail)\r\n                // delete localStorage['token']\r\n                // dispatch(setAuthUserData(null, null, null, false, true))\r\n            } else {\r\n                console.log('its amaizing error - server error')\r\n            }\r\n            dispatch(initializedSuccess());\r\n            // dispatch(initializedSuccess());\r\n            // dispatch(getAuthUserData());\r\n        }\r\n        ).catch(error => {\r\n            console.log('you gonna die')\r\n            dispatch(initializedSuccess());\r\n        });\r\n    \r\n    // authAPI.me()\r\n    //     .then(response => {\r\n    //         if (response.data.resultCode === 0) {\r\n    //             let {id, login, email} = response.data.data;\r\n    //             dispatch(initializedSuccess());\r\n    //         }\r\n    //     });\r\n}\r\n\r\n\r\nexport default appReducer;","// import React from 'react';\r\n// import {sendMessageCreator, updateNewMessageBodyCreator} from \"../../redux/dialogs-reducer\";\r\n// import Dialogs from \"./Dialogs\";\r\n// import {connect} from \"react-redux\";\r\n// import { Redirect, withRouter } from 'react-router-dom';\r\n\r\n// class DialogsContainer extends React.Component {\r\n//     componentDidMount() {\r\n//         console.log('Im inside the DOM');\r\n//         console.log(`${this.props.token}`);\r\n//     }\r\n//     render() {\r\n//         if(this.props.token === null){\r\n//             return <Redirect to='/login'/>\r\n//         }\r\n//         return (\r\n//             <Dialogs {...this.props}/>\r\n//         )\r\n//     }\r\n// }\r\n\r\n// let mapStateToProps = (state) => {\r\n//     return {\r\n//         dialogsPage: state.dialogsPage,\r\n//         token: state.auth.token\r\n//     }\r\n// }\r\n// let mapDispatchToProps = (dispatch) => {\r\n//     return {\r\n//         sendMessage: () => {\r\n//             dispatch(sendMessageCreator());\r\n//         },\r\n//         updateNewMessageBody: (body) => {\r\n//             dispatch(updateNewMessageBodyCreator(body));\r\n//         }\r\n//     }\r\n// }\r\n\r\n// let WithURLDialogsContainer = withRouter(DialogsContainer);\r\n// // const DialogsContainer = \r\n// export default connect(mapStateToProps, mapDispatchToProps)(WithURLDialogsContainer);\r\n\r\n// // export default DialogsContainer;\r\n\r\n// eslint-disable react/jsx-no-duplicate-props\r\n/* eslint-disable jsx-a11y/anchor-is-valid */\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { compose } from 'redux';\r\nimport withAuthRedirect from '../../hoc/WithAuthRedirect';\r\nimport { connect } from 'react-redux';\r\nimport { setCurrentChatData, unSetCurrentChatData, getChats, \r\n        clearChatMyLocal, clearChatMyGlobal, clearChatAllLocal, clearChatAllGlobal, createConversation, createDialog, \r\n        // requestUsersForChat, \r\n        renameChatRequest, setChatPhotoRequest, addMember, deleteChatRequest } from '../../redux/chats-reducer';\r\nimport Preloader from '../common/Preloader/Preloader';\r\nimport ChatItem from './ChatItem/ChatItem';\r\nimport chatsStyles from './Chats.module.scss';\r\nimport { selectChats, selectFocusedWindowUsersForChat, selectFocusedWindowAddUserForChat, selectFocusedWindowMembersForChat, selectFocusedWindowMemberOperationsForChat } from '../../redux/chats-selector';\r\n\r\nimport { withRouter } from 'react-router-dom';\r\nimport { reduxForm, formValues } from 'redux-form';\r\nimport { createField, Input, ReduxFormSnippet } from '../common/FormsControls/FormsControls';\r\nimport { maxLength200 } from '../../utils/validators/validators';\r\n \r\nimport styleMessages from './Message/Message.module.scss';\r\nimport UsersContainer from '../Users/UsersContainer';\r\nimport { useRefactorPopUp } from '../../customHooks/focusedElems';\r\nimport { clearCurrentFocusedWindow, addFocusedWindow } from '../../redux/app-reducer';\r\n\r\n\r\nconst CreateChatForm = (props) => {\r\n    const { handleSubmit, pristine, reset, submitting, error} = props\r\n    // const MyItemizedList = [19, 20]\r\n    // const ItemList = formValues('selectedMembers')(MyItemizedList)\r\n    // const [selected, setSelected] = useState([]);\r\n    // // snusers, myUserId\r\n    // const options = snusers\r\n    //                 .filter(snuser => snuser.userId !== myUserId)\r\n    //                 .map(snuser => ({label: snuser.name, value: snuser.id}))\r\n    return (\r\n        <form onSubmit={handleSubmit} className={chatsStyles.createChatForm} autoComplete='off'>\r\n            {/* {createField('DropDownSelect', 'dropDownSelect', DropDownSelect, null, {people: snusers.filter(snuser => snuser.userId !== myUserId)})} */}\r\n            \r\n            {/* {createField('SelectedMembers', 'selectedMembers', MultiSelectWrap, null, \r\n                { optionsMS: options, \r\n                    valueMS:selected, \r\n                    onChangeMS:setSelected, \r\n                    labelledByMS:\"Select\"  })} */}\r\n            {/* {createField('SelectedMembers', 'selectedMembers', ForChatUsersListWrap, null)} */}\r\n            \r\n            {createField('Name', 'name', Input, [maxLength200])}\r\n            <ReduxFormSnippet  pristine={pristine} reset={reset} submitting={submitting} error={error} sumbitButtonName={'Create Chat'}/>\r\n        </form>\r\n    )\r\n}\r\n\r\n\r\nconst CreateChatReduxForm = reduxForm({form:'CreateChat'})(CreateChatForm)\r\n\r\n\r\n\r\n \r\nexport const useUsersSelector = (callbackMethod, keys=[]) => { // ['name'] // props.createConversation\r\n    const [selectedForChatUsers, setSelectedForChatUsers] = useState([])\r\n\r\n    const onSubmit = (formData) => { // keys = ['name', 'photos']\r\n        // debugger\r\n        // let sns = Array.isArray(formData['dropDownSelect']) ? formData['dropDownSelect']: [formData['dropDownSelect']]\r\n        // let sns = Array.isArray(selectedForChatUsers) ? selectedForChatUsers: selectedForChatUsers\r\n        callbackMethod(selectedForChatUsers, ...keys.map(key=>formData[key])) // if select for create chat -> keys are not null - else null (fro add member to chat)\r\n    }\r\n    return [selectedForChatUsers, setSelectedForChatUsers, onSubmit]\r\n\r\n}\r\n\r\n// export const useUserSelector = (chatTypeId, chatId, callbackMethod) => { //props.addMember\r\n//     const [selectedForChatUser, setSelectedForChatUser] = useState(null)\r\n//     const onSubmit = async() => {\r\n//         console.log('pre api')\r\n//         await callbackMethod(chatTypeId, chatId, selectedForChatUser)\r\n//     }\r\n\r\n//     // useEffect(() => {\r\n//     //     if(selectedForChatUser!==null){\r\n//     //         console.log(\"adding\")\r\n//     //         onSubmit()\r\n//     //         setSelectedForChatUser(null) \r\n//     //     } else {\r\n//     //         console.log(\" notadding\")\r\n//     //     }\r\n//     // }, [selectedForChatUser])\r\n//     return [setSelectedForChatUser ]\r\n// }\r\n\r\n\r\n\r\nconst ChatsContainer = (props) => {\r\n    const [iF, setIF]= useState(true) // isFetching\r\n    // const [iF2, setIF2]= useState(true) // isFetching\r\n    const [selectedForChatUsers, setSelectedForChatUsers, onSubmit] = useUsersSelector(props.createConversation, ['name'])\r\n\r\n    const refreshData = () => {\r\n        // if (!iF2) {\r\n        console.log('start refresh')\r\n        setTimeout(async() =>{await props.getChats()}, 5000) // так как обновелния в чатах могут быть и не только с моей стороны но и с чужой\r\n        console.log('end refresh')\r\n        // }\r\n    }\r\n\r\n    useEffect(() => {\r\n        const fetchData = async() => {\r\n            if(iF){\r\n                props.unSetCurrentChatData()\r\n                await props.getChats()\r\n                setIF(false)\r\n            }\r\n            // if(iF2){\r\n            //     await props.requestUsersForChat()\r\n            //     setIF2(false)\r\n            // }\r\n        }\r\n        fetchData();\r\n    }, [props, iF])//, iF2])\r\n\r\n    useEffect(() => {\r\n        refreshData();\r\n        console.log('effect refresh used by changing: ')\r\n    }, [props])\r\n\r\n\r\n    // if(iF || iF2) return <Preloader/>\r\n    if(iF) return <Preloader/>\r\n    // key `${chat.chatType}_${chat.name}`\r\n    // let chatsElements = [...(props.chats.filter(chat => !('sended' in chat.lastMessage))).sort((a,b)=>b.chatId - a.chatId), ...props.chats\r\n    //         .filter(chat => 'sended' in chat.lastMessage) // if this is the chat with existing msgs within\r\n    //         .sort((chat1, chat2)=> (chat2.lastMessage.sended - chat1.lastMessage.sended))]\r\n    let chatsElements = props.chats\r\n            .map(chat => <ChatItem lastMessage={chat.lastMessage} \r\n                getCountOfNewGlobalMsgs={chat.getCountOfNewGlobalMsgs} \r\n                members={chat.members} name={chat.name} \r\n                chatType={chat.chatType} chatId={chat.chatId} \r\n                chatTypeId={chat.chatTypeId} key={chat.id}\r\n                setCurrentChatData={props.setCurrentChatData}\r\n                chatPhotoSmall = {chat.chatPhoto.small} \r\n                isFetching={props.isFetching} \r\n                // currentChatDataFetching={props.currentChatDataFetching} \r\n                clearChatMyLocal={props.clearChatMyLocal} clearChatMyGlobal={props.clearChatMyGlobal} clearChatAllLocal={props.clearChatAllLocal} clearChatAllGlobal={props.clearChatAllGlobal}\r\n                renameChatRequest={props.renameChatRequest}\r\n                setChatPhotoRequest={props.setChatPhotoRequest}\r\n                addMember={props.addMember}\r\n                // snusers={props.OLDsnusers}\r\n                deleteChatRequest={props.deleteChatRequest}\r\n\r\n                fWAUFC={props.fWAUFC}\r\n                clearCurrentFocusedWindow={props.clearCurrentFocusedWindow}\r\n                addFocusedWindow={props.addFocusedWindow}\r\n\r\n                />);\r\n \r\n\r\n    return(\r\n        <>\r\n        <div className={chatsStyles.chats}>\r\n            <div className={chatsStyles.chats_header}>Chats</div>\r\n            <div className={chatsStyles.createChat}>\r\n            <div className={chatsStyles.createChatHeader}>Create Conversation\r\n                {selectedForChatUsers.length > 1 && <CreateChatReduxForm onSubmit={onSubmit} snusers={props.snusers} myUserId={props.myUserId} /> }\r\n\r\n                {props.fWUFC.data !== null ?\r\n                    \r\n                    <div  className={chatsStyles.getMemberList} onClick={(event)=>{event.stopPropagation();}}>\r\n                        <UsersContainer\r\n\r\n                        setSelectedForChatUsers={setSelectedForChatUsers} forChat={true} \r\n                        selectedForChatUsers={selectedForChatUsers} \r\n                        styleForUsers={styleMessages.usersForChatActive} styleForUser={styleMessages.userForChat}\r\n                        clearCurrentFocusedWindow={props.clearCurrentFocusedWindow}\r\n                        fWUFCID = {props.fWUFC.id}\r\n                        toogleFocuseElem={props.toogleFocuseElem}\r\n\r\n                        />\r\n\r\n                        {selectedForChatUsers.length === 1 &&  \r\n                            <a onClick={() => {props.createDialog(selectedForChatUsers[0]); props.clearCurrentFocusedWindow(props.fWUFC.id); }}>Create Dialog</a>}\r\n                    </div>\r\n\r\n                :\r\n                 \r\n                    <a className={chatsStyles.getMemberList}  \r\n                    onClick={\r\n                        (event)=>{event.stopPropagation();\r\n                        props.addFocusedWindow(props.fWUFC.id, true);\r\n                    }}>\r\n                            Choose Users for Chat\r\n                    </a>\r\n\r\n                }\r\n\r\n                {/* {props.usersForChatShow ? \r\n                <div  className={chatsStyles.getMemberList} onClick={(event)=>{event.stopPropagation();}}>\r\n                    <UsersContainer\r\n\r\n                    setSelectedForChatUsers={setSelectedForChatUsers} forChat={true} \r\n                    selectedForChatUsers={selectedForChatUsers} \r\n                    styleForUsers={styleMessages.usersForChatActive} styleForUser={styleMessages.userForChat}\r\n\r\n                    usersForChatShow={props.usersForChatShow}\r\n                    setUsersForChatShow={props.setUsersForChatShow}\r\n                    toogleFocuseElem={props.toogleFocuseElem}/>\r\n\r\n                    {selectedForChatUsers.length === 1 && <a onClick={() => {props.createDialog(selectedForChatUsers[0])}}>Create Dialog</a>}\r\n                    </div>\r\n                    // <div className={styleMessages.usersForChatActive}>\r\n                    :\r\n                    <a className={chatsStyles.getMemberList} \r\n                        onClick={props.toogleFocuseElem(props.setUsersForChatShow, props.usersForChatShow)}>\r\n                            Choose Users for Chat\r\n                    </a>\r\n                } */}\r\n\r\n\r\n\r\n            </div>\r\n            </div>\r\n                <div className={chatsStyles.chatsItems}>\r\n                    {chatsElements}\r\n                </div>\r\n        </div>\r\n        \r\n        </>\r\n    )\r\n}\r\n// can be lastMessage ={} if no msgs yet, \r\n\r\n\r\nlet mapStateToProps = (state) => ({\r\n    chats: selectChats(state),\r\n    isAuth: state.auth.isAuth,\r\n    isFetching: state.chatsPage.isFetching,\r\n    isUnmount: state.chatsPage.isUnmount,\r\n    myUserId: state.auth.userId,\r\n    OLDsnusers: state.chatsPage.usersToSelect, // по-сути должны быть все)))))))) TODO но асинхронно подгружатся\r\n    // state.chatsPage.membersToSelect <- getUsers(page) (subs requestUsersForChat) TODO\r\n    // chatPhotoSmall: selectChatPhotoSmall(state)\r\n    // userId: state.auth.userId,\r\n    // id - data\r\n    fWUFC: selectFocusedWindowUsersForChat(state),\r\n    fWAUFC: selectFocusedWindowAddUserForChat(state),\r\n    fWMFC: selectFocusedWindowMembersForChat(state),\r\n    fWMOFC: selectFocusedWindowMemberOperationsForChat(state),\r\n\r\n\r\n})\r\n\r\nexport default compose(\r\n    withAuthRedirect,\r\n    connect(mapStateToProps, {getChats, setCurrentChatData, unSetCurrentChatData,\r\n        clearChatMyLocal, clearChatMyGlobal, clearChatAllLocal, clearChatAllGlobal,\r\n        createDialog, createConversation, \r\n        // requestUsersForChat,\r\n        renameChatRequest, addMember, setChatPhotoRequest, deleteChatRequest,\r\n\r\n        addFocusedWindow, clearCurrentFocusedWindow,\r\n    }),\r\n    withRouter\r\n)(ChatsContainer);\r\n\r\n\r\n//currentChatDataFetching\r\n","import {profileAPI, authAPI} from \"../api/api\";\r\nimport { stopSubmit } from \"redux-form\";\r\nimport replaceQuotes from \"../components/common/utils/quotes\";\r\nimport authReducer from \"./auth-reducer\";\r\n// import backupQuotes from \"../components/common/utils/backupQuotes\";\r\n// const ADD_POST = 'ADD-POST';\r\n// const UPDATE_NEW_POST_TEXT = 'UPDATE-NEW-POST-TEXT';\r\n// const SET_USER_PROFILE = 'SET_USER_PROFILE';\r\n// const SET_USER_JWTTOKEN = 'SET_USER_JWTTOKEN';\r\n// const SET_SELF_USER_ID = 'SET_SELF_USER_ID';\r\n\r\n\r\n// must be 8\r\nconst ADD_POST = 'ADD-POST';\r\nconst DELETE_POST = 'DELETE_POST';\r\n\r\nconst SET_USER_PROFILE = 'SET_USER_PROFILE';\r\nconst UPDATE_PROFILE = 'UPDATE_USER_PROFILE';\r\n// const DELETE_PROFILE = 'DELETE_USER_PROFILE';\r\n\r\nconst SET_STATUS = 'SET_STATUS';\r\nconst SET_PHOTO = 'SET_PHOTO';\r\n\r\nlet initialState = {\r\n    posts: [\r\n        {id: 1, message: 'Hi, how are you?', likesCount: 12},\r\n        {id: 2, message: 'It\\'s my first post', likesCount: 11},\r\n        {id: 3, message: 'Blabla', likesCount: 11},\r\n        {id: 4, message: 'Dada', likesCount: 11}\r\n    ],\r\n    // newPostText: 'it-kamasutra.com',\r\n    profile: null,\r\n    status: \"\"\r\n};\r\n\r\n\r\nconst profileReducer = (state = initialState, action) => {\r\n\r\n    switch(action.type) {\r\n        case ADD_POST: {\r\n            let newPost = {\r\n                id: 5,\r\n                message: action.newPostText,\r\n                likesCount: 0\r\n            };\r\n            return {\r\n                ...state,\r\n                posts: [...state.posts, newPost],\r\n            };\r\n        }\r\n        case DELETE_POST: {\r\n            return {...state, posts: state.posts.filter(p => p.id !== action.postId)}\r\n        }\r\n\r\n        case SET_USER_PROFILE: {\r\n            return {...state, profile: action.profile}\r\n        }\r\n        // when we update subobject - we just add other old subproperties that dont updated \r\n        case UPDATE_PROFILE: { // нет проверки на правильность ключей (имен полей обьекта профайл) - если на серваке прошло, то точно верны все ключи по идее\r\n            return {...state,\r\n                    profile: \r\n                    {...state.profile,\r\n                    ...action.profileData,\r\n                    photos: {...state.profile.photos, ...action.profileData.photos},\r\n                    contacts: {...state.profile.contacts, ...action.profileData.contacts}\r\n                    }\r\n                }\r\n        }\r\n        // case DELETE_PROFILE: {\r\n        //     return {...state, posts: [], profile: null, status: ''}\r\n        // }\r\n\r\n        case SET_STATUS: {\r\n            // return {...state, status: action.status}\r\n            return {...state, profile: { ...state.profile, status: action.status} }\r\n        }\r\n        case SET_PHOTO: {\r\n            return {...state, profile: {...state.profile, photos: action.photos}}\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\n\r\n// no API yet ( no likes api, no posts api, no polls api, no comments api)\r\nexport const addPost = (newPostText) => ({type: ADD_POST, newPostText})\r\nexport const deletePost = (postId) => ({type: DELETE_POST, postId})\r\n\r\n// no API hidden layer of action\r\nexport const setUserProfile = (profile) => ({type: SET_USER_PROFILE, profile})\r\nexport const setStatus = (status) => ({type: SET_STATUS, status})\r\nexport const setPhoto = (photos) => ({type: SET_PHOTO, photos})\r\nexport const setUpdateUserProfile = (profileData) => ({type: UPDATE_PROFILE, profileData})\r\n\r\n// API actions\r\nexport const getUserProfile = (userId) => async(dispatch) => {\r\n    // debugger\r\n    let response = await profileAPI.getProfile(userId)\r\n    if (response.data.resultCode === 0){\r\n        let profile = response.data.data;\r\n        profile.photos = replaceQuotes(profile.photos);\r\n        profile.contacts = replaceQuotes(profile.contacts);\r\n        dispatch(setUserProfile(profile));\r\n        // return response.data.data\r\n    }\r\n}\r\n\r\nexport const updateUserProfile = (profileData) => async(dispatch) => {\r\n    // debugger\r\n    // profileData = backupQuotes(profileData)\r\n    let response = await profileAPI.updateProfile(profileData)\r\n    if(response.data.resultCode === 0){\r\n        let profile = response.data.data\r\n        if('photos' in profile){\r\n            profile.photos = replaceQuotes(profile.photos);\r\n        }\r\n        if ('contacts' in profile){\r\n            profile.contacts = replaceQuotes(profile.contacts);\r\n        }\r\n        dispatch(setUpdateUserProfile(profile))\r\n    } else {\r\n        let message = response.data.messages.length  ? response.data.messages[0] : 'Some error';\r\n        dispatch(stopSubmit(\"updateProfile\", {_error: message}));\r\n    }\r\n}\r\n// fields to change\r\n\r\n// \"name\",\r\n// \"status\",\r\n// \"photos\",\r\n// \"lookingForAJob\",\r\n// \"lookingForAJobDescription\",\r\n// \"fullname\",\r\n// \"contacts\"\r\n\r\n// export const setDeleteUserProfile = () => ({type: DELETE_PROFILE})\r\nexport const deleteUserProfile = () => async(dispatch) => {\r\n    let response = profileAPI.deleteProfile()\r\n    if(response.data.resultCode === 0){\r\n        dispatch(setUserProfile(null))\r\n        authReducer.logout()\r\n        // delete state data and token ????\r\n        // reidrect login???\r\n        // if profile === null -> rerender all and redirect login (solved)\r\n    } else {\r\n        //  в случае ошибки от АПИ, все равно возможно юзер удален но возникла ошибка позднее его удаления,\r\n        // потому, если мы до сих пор залогинены \r\n        // (тоесть наш текущий токен валиден на стороне сервака апи), значит не было удаления пользователя\r\n        let authResponse = await authAPI.me() \r\n        if(authResponse.data.resultCode !== 0){ //  а если не валиден - юзер удален - очищаем данные\r\n            dispatch(setUserProfile(null))\r\n            authReducer.logout()\r\n        }\r\n    }\r\n}\r\n\r\n\r\n// export const getStatus = (userId) => async(dispatch) => {\r\n//     let response =  await profileAPI.getStatus(userId);\r\n//     if(response.data.resultCode === 0){\r\n//         dispatch(setStatus(response.data.data));\r\n//     } // if subs to redux-form  -> + stopSubmit\r\n// }\r\n\r\n// there is the only place we dont want to say the user that there is was an error in sataus update\r\nexport const updateStatus = (status) => async(dispatch) => {\r\n    let response =  await profileAPI.updateStatus(status); //  без оповещения юзеру об ошибке в отправке на апи\r\n    console.log(response);\r\n    if( response.data.resultCode === 0 ){\r\n        dispatch(setStatus(status));\r\n    }\r\n}\r\n\r\nexport const updatePhoto = (photo) => async(dispatch) => {\r\n    let response =  await profileAPI.updatePhoto(photo);\r\n    if( response.data.resultCode === 0 ){\r\n        dispatch(setPhoto(photo));\r\n    } else {\r\n        let message = response.data.messages.length  ? response.data.messages[0] : 'Some error';\r\n        dispatch(stopSubmit(\"updatePhoto\", {_error: message}));\r\n    }\r\n}\r\n\r\n\r\n\r\n// export const setUserJWTToken = (token) => ({type: SET_USER_JWTTOKEN, token})\r\n// export const setSelfUserId = (selfUserId) => ({type: SET_SELF_USER_ID, selfUserId})\r\n\r\n// export const updateNewPostTextActionCreator = (text) =>\r\n//     ({type: UPDATE_NEW_POST_TEXT, newText: text })\r\n\r\nexport default profileReducer;","import { useState, useEffect } from 'react';\r\nexport const useHotEditing = (startFieldValue, apiFunction, validators=[], maxLength=0) => { //  additionalData=null\r\n    let [editMode, setEditMode] = useState(false);\r\n    let [fieldValue, setFieldValue] = useState(startFieldValue);\r\n    let [isInvalid, setisInvalid] = useState(false);\r\n\r\n    let [charCount, setCharCount] = useState(`${startFieldValue.length}/${maxLength}`)\r\n\r\n    useEffect(() => {\r\n        setFieldValue(startFieldValue);\r\n    }, [startFieldValue]);\r\n    const activateEditMode = () => {\r\n        setEditMode(true);\r\n    }\r\n    const deactivateEditMode = () => {\r\n        setEditMode(false);\r\n        !isInvalid && apiFunction(fieldValue)\r\n    }\r\n    const onFieldValueChange = (e) => {\r\n       if( validators.every(valid => valid(e.currentTarget.value)===undefined)) {\r\n            setisInvalid(false)\r\n            setFieldValue(e.currentTarget.value) \r\n            chars(e.currentTarget.value.length, maxLength)\r\n       } else {\r\n        setisInvalid(true)\r\n       }\r\n    }\r\n\r\n    const chars = (currLen, maxLength) => {\r\n        setCharCount(`${currLen}/${maxLength}`)\r\n    }\r\n\r\n\r\n    return [activateEditMode, deactivateEditMode, onFieldValueChange, editMode, fieldValue, isInvalid, charCount]\r\n}","import React from 'react';\r\nimport { useHotEditing } from '../../../customHooks/hotEditing';\r\nimport { maxLength30 } from '../../../utils/validators/validators';\r\n\r\n\r\n// if i want field level validation better i have to use redux-form than localState (hooks)\r\nconst ProfileStatusWithHooks = (props) => {\r\n    const [activateEditMode, deactivateEditMode, onStatusChange, editMode, status, isInvalid, charCount] = useHotEditing(props.status, props.updateStatus, [maxLength30], 30)\r\n\r\n    return (\r\n        <div className=''>\r\n            {!props.ENSM ?\r\n                <div>\r\n                    {!editMode &&\r\n                        <div>\r\n                            <span onDoubleClick={activateEditMode}>Status: {props.status || \"-------\"}</span>\r\n                        </div>\r\n                    }\r\n                    {editMode &&\r\n                        <div>\r\n                            <input onChange={onStatusChange} autoFocus={true} onBlur={deactivateEditMode}\r\n                                value={status} />\r\n                        </div>\r\n                    }\r\n                </div>\r\n                :\r\n                <div>\r\n                    <div>\r\n                        <span>Status: {props.status || \"-------\"}</span>\r\n                    </div>\r\n                </div>\r\n            }\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport default ProfileStatusWithHooks;","// import React from 'react';\r\n// import s from './ProfileInfo.module.scss';\r\n// import Preloader from '../../common/Preloader/Preloader';\r\n\r\n// const ProfileInfo = (props) => {\r\n//     if (!props.profile) {\r\n//         return <Preloader />\r\n//     }\r\n//     return (\r\n//         <div className={s.profile_info}>\r\n//             <div className={s.landi_block}>\r\n//                 <img\r\n//                     src='https://images.pexels.com/photos/248797/pexels-photo-248797.jpeg?auto=compress&cs=tinysrgb&h=350'/>\r\n//             </div>\r\n//             <div className={s.descriptionBlock}>\r\n//                 <div className={s.ava_block}>\r\n//                     <img src={props.profile.photos.large} alt={`PHOTO OF ${props.profile.name}`}/>\r\n//                 </div>\r\n//                 <div className={s.username}>{props.profile.name}</div>\r\n//                 <div className={s.userinfo}>BIO: Date of Birth: 19 Jan 1997</div>\r\n//             </div>\r\n//         </div>\r\n//     )\r\n// }\r\n\r\n// export default ProfileInfo;\r\n\r\n\r\nimport React from 'react';\r\nimport s from './ProfileInfo.module.scss';\r\nimport Preloader from \"../../common/Preloader/Preloader\";\r\nimport ProfileStatusWithHooks from './ProfileStatusWithHooks';\r\nimport { NavLink } from 'react-router-dom';\r\n\r\nconst ProfileInfo = ({ profile, updateStatus, updatePhoto, ENSM }) => {\r\n\r\n    if (!profile) {\r\n        return <Preloader />\r\n    }\r\n    console.log(profile.photos.large)\r\n    return (\r\n        <div className={s.profile_info}>\r\n            <div className={s.landi_block}>\r\n                <img\r\n                    src='https://img2.goodfon.ru/wallpaper/big/3/9a/planety-kosmos-oskolki.jpg' />\r\n            </div>\r\n            <div className={s.descriptionBlock}>\r\n                <div className={s.ava_block}>\r\n                    <img src={profile.photos.large} alt='ProfilePhoto' />\r\n                </div>\r\n                <div className={s.username}>USERNAME: {profile.name}</div>\r\n                <div className={s.userinfo}>\r\n                    <div>\r\n                        BIO: Date of Birth: 19 Jan 1997\r\n                    </div>\r\n                    <ProfileStatusWithHooks status={profile.status} updateStatus={updateStatus} ENSM={ENSM}/>\r\n                    img url: <a target=\"_blank\" href={profile.photos.large}>Get Photo</a>\r\n                </div>\r\n\r\n                {/* <ProfileStatusWithHooks status={profile.status} updateStatus = {updateStatus}/>\r\n                <ProfilePhotos photos={profile.photos} updatePhoto = {updatePhoto}/> */}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ProfileInfo;","import React from 'react';\r\nimport s from './Post.module.scss';\r\n\r\nconst Post = (props) => {\r\n  return (\r\n    <div className={s.item}>\r\n      <img src='https://movies4maniacs.liberty.me/wp-content/uploads/sites/1218/2015/09/avatarsucks.jpg' />\r\n        { props.message }\r\n          <div>\r\n        <span>like</span> { props.likesCount }\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Post;","import React from 'react';\r\nimport s from './MyPosts.module.scss';\r\nimport Post from './Post/Post';\r\nimport { reduxForm } from 'redux-form';\r\nimport { requiredField, maxLength30 } from '../../../utils/validators/validators';\r\nimport { createField, TextArea } from '../../common/FormsControls/FormsControls';\r\nimport {addPost} from \"../../../redux/profile-reducer\";\r\nimport {connect} from \"react-redux\";\r\n\r\nconst AddNewPostForm = (props) => {\r\n    return (\r\n        <form onSubmit={props.handleSubmit}> {/* + к этому контейнерная компонента  вызывает props.onSubmit*/}\r\n            <div className=''>\r\n                {createField('Write your post', \"newPostText\", TextArea, [requiredField, maxLength30])}\r\n            </div>\r\n            <div className=''>\r\n                <button>Add post</button>\r\n            </div>\r\n        </form>\r\n    )\r\n}\r\n// a unique name for the form\r\nconst AddNewPostFormRedux = reduxForm({ form: 'ProfileAddNewPostForm' })(AddNewPostForm)\r\n\r\nconst MyPosts = (props) => {\r\n\r\n    const onAddPost = (formData) => {\r\n        // console.log(formData);\r\n        props.addPost(formData.newPostText);\r\n    }\r\n\r\n    let postsElements =\r\n        props.posts.map(p => <Post message={p.message} likesCount={p.likesCount} />);\r\n\r\n    return (\r\n        <div className={s.postsBlock}>\r\n            <div className={s.myPostsHeader}>My posts</div>\r\n            <div className={s.createPost}>\r\n                <AddNewPostFormRedux onSubmit={onAddPost} />\r\n            </div>\r\n            <div className={s.posts}>\r\n                {postsElements}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        posts: state.profilePage.posts\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, {addPost})(MyPosts);\r\n\r\n\r\n// import React from 'react';\r\n// import s from './MyPosts.module.scss';\r\n// import Post from './Post/Post';\r\n\r\n\r\n// const MyPosts = (props) => {\r\n//     let postsElements =\r\n//         props.posts.map( p => <Post message={p.message} likesCount={p.likesCount}/>);\r\n\r\n//     let newPostElement = React.createRef();\r\n\r\n//     let onAddPost = () => {\r\n//         props.addPost();\r\n//     }\r\n\r\n//     let onPostChange = () => {\r\n//         let text = newPostElement.current.value;\r\n//         props.updateNewPostText(text);\r\n//         // console.log(text);\r\n//     }\r\n\r\n//     return (\r\n//         <div className={s.postsBlock}>\r\n//             <div className={s.myPostsHeader}>My posts</div>\r\n//             <div className={s.createPost}>\r\n//                 <div>\r\n//                     <textarea ref={newPostElement} value={props.newPostText} onChange={onPostChange}/>\r\n//                 </div>\r\n//                 <div>\r\n//                     <button onClick={onAddPost}>Add post</button>\r\n//                 </div>\r\n//             </div>\r\n//             <div className={s.posts}>\r\n//                 { postsElements }\r\n//             </div>\r\n//         </div>\r\n//     )\r\n// }\r\n\r\n// export default MyPosts;","import React, { useState, useEffect } from 'react';\r\nimport { reduxForm } from 'redux-form';\r\nimport { Input, TextArea, createField } from '../common/FormsControls/FormsControls';\r\nimport { maxLength30, maxLength50, maxLength200 } from '../../utils/validators/validators';\r\nimport { connect } from 'react-redux';\r\nimport { addPost, deletePost, getUserProfile, updateUserProfile, deleteUserProfile, updateStatus, updatePhoto} from '../../redux/profile-reducer';\r\nimport { withRouter, Redirect, NavLink } from 'react-router-dom';\r\nimport styles from '../common/FormsControls/FormsControls.module.scss'\r\n\r\nimport s from './Profile.module.scss';\r\nimport ProfileInfo from \"./ProfileInfo/ProfileInfo\";\r\n\r\nimport { compose } from 'redux';\r\nimport withAuthRedirect from '../../hoc/WithAuthRedirect';\r\nimport MyPosts from './MyPosts/MyPosts';\r\nimport Preloader from '../common/Preloader/Preloader';\r\nimport { useForbidUnsafeMethods } from '../../customHooks/reduceUnsafeMethods';\r\n\r\nconst ProfileContainer = (props) => {\r\n\r\n    const [exchangeNotSafeMethods, setExchangeNotSafeMethods, shown, setShown, reduceMethods] = useForbidUnsafeMethods()\r\n\r\n    useEffect(() => { \r\n        const fetchData = async() => {\r\n        // debugger\r\n        let userId = props.match.params.userId;\r\n        if (!userId) {\r\n            userId = props.userId; // getting from withAuthRedirect\r\n            if (!userId) {\r\n                // return <Redirect to='/login'/>\r\n                props.history.push('/login')\r\n            }\r\n            exchangeNotSafeMethods && setExchangeNotSafeMethods(false)\r\n        }\r\n        else {\r\n            if (props.userId !== parseInt(userId)) {\r\n                // нельзя изменять (ибо не наша страница)\r\n                !exchangeNotSafeMethods && setExchangeNotSafeMethods(true)\r\n            } else {\r\n                exchangeNotSafeMethods && setExchangeNotSafeMethods(false)\r\n            }\r\n        }\r\n        \r\n        await props.getUserProfile(userId);\r\n        // debugger\r\n        setShown(true)\r\n        }\r\n        fetchData();\r\n    }, [props.match.params.userId])\r\n    \r\n\r\n    if(!shown) return <Preloader/>\r\n    return (\r\n        // {this.props.tokenError) ? <Login/>}\r\n        <div className={s.profile_wrapper}>\r\n            <ProfileInfo profile={props.profile} updateStatus={reduceMethods(props.updateStatus)} updatePhoto={reduceMethods(props.updatePhoto)} ENSM={exchangeNotSafeMethods}/>\r\n            {!exchangeNotSafeMethods && <div className=''><MyPosts/> <NavLink to={'/profile_update'}>Update My Profile</NavLink><button onClick={props.deleteUserProfile}>Delete My Profile</button> </div> }\r\n            \r\n        </div>\r\n\r\n    )\r\n\r\n}\r\n// status is already in profile.status => so we dont need to store it out profile instance in state\r\n\r\nlet mapStateToProps = (state) => ({\r\n    profile: state.profilePage.profile,\r\n    userId: state.auth.userId,\r\n    isAuth: state.auth.isAuth,// for WithAuthRedirect\r\n});\r\nexport default compose(\r\n    withAuthRedirect,\r\n    connect(mapStateToProps, {getUserProfile, updateStatus, updatePhoto, deleteUserProfile, updateUserProfile}), // getPhoto == \r\n    withRouter\r\n)(ProfileContainer)\r\n","import { useState } from 'react';\r\nexport const useForbidUnsafeMethods = () => {\r\n    const [exchangeNotSafeMethods, setExchangeNotSafeMethods] = useState(false)\r\n    const [shown, setShown] = useState(false)\r\n\r\n    const reduceMethods = (method, isReduced=null) => (isReduced!==null ? !isReduced : exchangeNotSafeMethods) ? ()=>{} : method\r\n\r\n    return [exchangeNotSafeMethods, setExchangeNotSafeMethods, shown, setShown, reduceMethods]\r\n}","import React from 'react';\r\nimport { reduxForm } from 'redux-form';\r\nimport { Input, createField } from '../common/FormsControls/FormsControls';\r\nimport { requiredField } from '../../utils/validators/validators';\r\nimport { connect } from 'react-redux';\r\nimport { login } from '../../redux/auth-reducer';\r\nimport { Redirect } from 'react-router-dom';\r\nimport styles from '../common/FormsControls/FormsControls.module.scss'\r\n\r\n// can show the summary error\r\n// form-level validation\r\nconst LoginForm = props => {\r\n    const { handleSubmit, pristine, reset, submitting, error } = props\r\n    return (\r\n        <form onSubmit={handleSubmit}>\r\n            {createField('Login', \"login\", Input, [requiredField])}\r\n            {createField('Password', \"password\", Input, [requiredField], {type: \"password\"})}\r\n            {\r\n            error && \r\n            <div className={styles.formSummaryError}>\r\n                {error}\r\n            </div>\r\n            }\r\n            <div className=''>\r\n                <button type='submit' disabled={pristine || submitting} >Login</button>\r\n            </div>\r\n            <div className=''>\r\n                <button type='button' disabled={pristine || submitting} onClick={reset}>Clear Values</button>\r\n            </div>\r\n        </form>\r\n    )\r\n}\r\n\r\nconst LoginReduxForm = reduxForm({form:'login'})(LoginForm)\r\n\r\n\r\nconst Login = (props) => {\r\n    // debugger\r\n    const onSubmit = (formData) => {\r\n        props.login(formData.login, formData.password)\r\n    }\r\n    if(props.isAuth) return (<Redirect to='/profile'/>)\r\n\r\n    return (<>\r\n        <div className=''>\r\n            <h1>LOGIN</h1>\r\n            <LoginReduxForm onSubmit={onSubmit}/>\r\n        </div>\r\n        </>)\r\n}\r\n\r\nconst mapStateToProps = (state) => ({\r\n    isAuth: state.auth.isAuth,\r\n});\r\n\r\n\r\nexport default connect(mapStateToProps, {login})(Login);","import React, { useEffect, useState } from 'react';\r\nimport { reduxForm } from 'redux-form';\r\nimport { Input, TextArea, createField } from '../../common/FormsControls/FormsControls';\r\nimport { maxLength30, maxLength50, maxLength200 } from '../../../utils/validators/validators';\r\nimport { connect } from 'react-redux';\r\nimport { getUserProfile, updateUserProfile } from '../../../redux/profile-reducer';\r\nimport { Redirect, withRouter } from 'react-router-dom';\r\nimport styles from '../../common/FormsControls/FormsControls.module.scss'\r\nimport withAuthRedirect from '../../../hoc/WithAuthRedirect';\r\nimport { compose } from 'redux';\r\nimport backupQuotes from '../../common/utils/backupQuotes';\r\nimport Preloader from '../../common/Preloader/Preloader';\r\n\r\nimport profileStyles from '../Profile.module.scss'\r\n\r\nconst UpdateProfileForm = props => {\r\n    const [lFAJ, setLFAJ] = useState(props.profile.lookingForAJob)\r\n    const toggleLFAJ = () => lFAJ ? setLFAJ(false) : setLFAJ(true)\r\n\r\n    // если даже тупо просто дотронемся до любого из полей - то можна будет отправить на сервак как якобы измененное значение ( хотя его и не изменяли )\r\n    const { handleSubmit, pristine, reset, submitting, error, profile } = props\r\n    return (\r\n        <form onSubmit={handleSubmit} className={styles.redux_form}>\r\n            <div>\r\n                <label htmlFor=\"\">Name</label>\r\n                {createField(profile.name, 'name', Input, [maxLength30], { defaultValue: profile.name })}\r\n            </div>\r\n            <div>\r\n                <label htmlFor=\"\">Status</label>\r\n                {createField(profile.status, 'status', TextArea, [maxLength200], { defaultValue: profile.status })}\r\n            </div>\r\n            {/* photos */}\r\n            <h3>Photos</h3>\r\n            <div>\r\n                <label htmlFor=\"\">Large</label>\r\n                {createField(profile.photos.large, 'photos_large', Input, null, { defaultValue: profile.photos.large })} {/*here we just write urls to ours photos -> should be subs to uploading blobs or files*/}\r\n            </div>\r\n            <div>\r\n                <label htmlFor=\"\">Small</label>\r\n                {createField(profile.photos.small, 'photos_small', Input, null, { defaultValue: profile.photos.small })}\r\n            </div>\r\n            <div>\r\n                <label htmlFor=\"\">Are you looking for A job?</label>\r\n                {createField(profile.lookingForAJob, 'lookingForAJob', Input, null, { type: \"checkbox\", checked: lFAJ, onClick: toggleLFAJ })} {/* true-false*/}\r\n            </div>\r\n            <div>\r\n                <label htmlFor=\"\">Make a small description for a job you are looking for</label>\r\n                {createField(profile.lookingForAJobDescription, 'lookingForAJobDescription', TextArea, [maxLength200], { defaultValue: profile.lookingForAJobDescription })}\r\n            </div>\r\n            <div>\r\n                <label htmlFor=\"\">Fullname</label>\r\n                {createField(profile.fullname, 'fullname', TextArea, [maxLength200], { defaultValue: profile.fullname })}\r\n            </div>\r\n            {/* contacts */}\r\n            <h3 >Contacts</h3>\r\n            <div>\r\n                <label htmlFor=\"\">GitHub</label>\r\n                {createField(profile.contacts.github, 'contacts_github', Input, [maxLength50], { defaultValue: profile.contacts.github })}\r\n            </div>\r\n            <div>\r\n                <label htmlFor=\"\">Vk</label>\r\n                {createField('vk', 'contacts_vk', Input, [maxLength50], { defaultValue: profile.contacts.vk })}\r\n            </div>\r\n            <div>\r\n                <label htmlFor=\"\">Facebook</label>\r\n                {createField('facebook', 'contacts_facebook', Input, [maxLength50], { defaultValue: profile.contacts.facebook })}\r\n            </div>\r\n            <div>\r\n                <label htmlFor=\"\">Instagram</label>\r\n                {createField('instagram', 'contacts_instagram', Input, [maxLength50], { defaultValue: profile.contacts.instagram })}\r\n            </div>\r\n            <div>\r\n                <label htmlFor=\"\">Twitter</label>\r\n                {createField('twitter', 'contacts_twitter', Input, [maxLength50], { defaultValue: profile.contacts.twitter })}\r\n            </div>\r\n            <div>\r\n                <label htmlFor=\"\">Website</label>\r\n                {createField('website', 'contacts_website', Input, [maxLength50], { defaultValue: profile.contacts.website })}\r\n            </div>\r\n            <div>\r\n                <label htmlFor=\"\">Youtube</label>\r\n                {createField('youtube', 'contacts_youtube', Input, [maxLength50], { defaultValue: profile.contacts.youtube })}\r\n            </div>\r\n            <div>\r\n                <label htmlFor=\"\">Mail</label>\r\n                {createField('mainLink', 'contacts_mainLink', Input, [maxLength50], { defaultValue: profile.contacts.mainLink })}\r\n            </div>\r\n            {\r\n                error &&\r\n                <div className={styles.formSummaryError}>\r\n                    {error}\r\n                </div>\r\n            }\r\n\r\n            <div>\r\n                <button type='button' disabled={pristine || submitting} onClick={reset}>Clear Values</button>\r\n                <button type='submit' disabled={pristine || submitting} >Update</button>\r\n            </div>\r\n        </form>\r\n    )\r\n}\r\n// if only for the first render i would use  {form: ... , initialValues: {}}\r\nconst UpdateProfileReduxForm = reduxForm({ form: 'updateProfile' })(UpdateProfileForm)\r\n\r\nconst UpdateProfile = props => {\r\n\r\n    useEffect(() => { props.getUserProfile(props.userId) }, []) //  если изменяется профайл - мы делаем эффект по получению профала из АПИ props.profile\r\n\r\n    let [profileRedirect, setProfileRedirect] = useState(false);\r\n    // те из полей полученных из формы \r\n    // которые не равны полям из пропсов добавляем в список и отправляем \r\n    // ( чтобы на апи изменялось только соответствующее знаение а не все \r\n    //     (будет удобно, когда будем загружать изображения и файлы  а не ссылки))\r\n    let addProfleFilledProperty = (obj, key, prop) => {\r\n        let subObjects = ['contacts', 'photos']\r\n        if (subObjects.every(start => !key.startsWith(start))) {\r\n            obj[key] = prop\r\n        }\r\n        else {\r\n            subObjects.map(start => {\r\n                if (key.startsWith(start)) {\r\n                    obj[start] = {}\r\n                    obj[start][key.split('_')[1]] = prop\r\n                }\r\n                return true\r\n            })\r\n        }\r\n    }\r\n    const onSubmit = (formData) => {\r\n        // console.log(profileRedirect)\r\n        let profileData = {}\r\n        for (let profProp in formData) {\r\n            addProfleFilledProperty(profileData, profProp, formData[profProp])\r\n        }\r\n        Object.keys(profileData).map(data => {\r\n            if (['contacts', 'photos'].includes(data)) {\r\n                profileData = {\r\n                    ...profileData, [data]: backupQuotes(Object.keys(props.profile[data])\r\n                        .reduce((res, key) => (res[key] = (key in profileData[data] ? profileData[data][key] : props.profile[data][key]), res), {}))\r\n                }\r\n            }\r\n        })\r\n        props.updateUserProfile(profileData)\r\n        setProfileRedirect(true)\r\n    }\r\n    // then redirect to profile page (add to store isProfileUpdated: true) // or right after submit redirect \r\n\r\n\r\n    if (profileRedirect) return <Redirect to='/profile' />\r\n    if (!props.profile) return <Preloader />\r\n    return (\r\n\r\n        <div className={profileStyles.profile_update} >\r\n            <h2 className={profileStyles.profile_update_header}>Profile Data Changing</h2>\r\n            <UpdateProfileReduxForm onSubmit={onSubmit} profile={props.profile} />\r\n        </div>\r\n    )\r\n}\r\n\r\nlet mapStateToProps = (state) => ({\r\n    profile: state.profilePage.profile,\r\n    userId: state.auth.userId,\r\n    isAuth: state.auth.isAuth,// for WithAuthRedirect\r\n});\r\nexport default compose(\r\n    withAuthRedirect,\r\n    connect(mapStateToProps, { updateUserProfile, getUserProfile }),  // getUserProfile\r\n    // withRouter\r\n)(UpdateProfile)\r\n","/* eslint-disable jsx-a11y/alt-text */\r\nimport React, { useState } from 'react';\r\nimport { useHotEditing } from '../../../customHooks/hotEditing';\r\nimport styleMessages from './Message.module.scss';\r\nimport { maxLength1000 } from '../../../utils/validators/validators';\r\n \r\nimport { useRef } from 'react';\r\nimport { useEffect } from 'react';\r\nimport Preloader from '../../common/Preloader/Preloader';\r\n\r\n\r\nconst EditMessageActive = ({isInvalid, onMBChange, deactivateEditMode, editedMessage, charCount}) => {\r\n    return (<div className={styleMessages.editMessage}>\r\n        <textarea className={isInvalid ? `${styleMessages.editField} ${styleMessages.error}`: `${styleMessages.editField}`} onChange={onMBChange} autoFocus={true} onBlur={deactivateEditMode}\r\n            value={editedMessage} />\r\n        {\r\n            isInvalid && <div className={styleMessages.errorField}>Invalid Data</div>\r\n        }\r\n        <div className={styleMessages.countChars}>{charCount}</div>\r\n    </div>)\r\n}\r\n\r\n// isFileFetching\r\n\r\nconst EditMessageInactive = ({fileId, activateEditMode, messageBody, fileImageURL, loadFile, ENSM }) => {  // , messageId => loadFile(messageId, fileId)\r\n    if (fileId){\r\n        return ( <div className={styleMessages.messageBody} onDoubleClick={!ENSM? activateEditMode: undefined}> {messageBody} \r\n            <div className={`${styleMessages.messageFile} ${fileImageURL===null ? styleMessages.fileImageDeactivate : styleMessages.fileImageActivate}`}>\r\n                        {loadFile && <>\r\n                            <span> + fileId: {fileId}</span>\r\n                            <button onClick={()=>loadFile(fileId)}>GetFile</button> \r\n                        </>}\r\n\r\n                        {/* <button onClick={()=>downloadFile(fileId)}>GetFile</button>  */}\r\n                        <img src={fileImageURL} />\r\n                        {/* {fileImageURL && <a  onClick={downloadFile} download={imageName}><img src={fileImageURL} /></a>} */}\r\n                </div>\r\n            </div>)\r\n    } else {\r\n        return (<div className={styleMessages.messageBody} onDoubleClick={!ENSM? activateEditMode: undefined}>{messageBody}</div>)\r\n    }\r\n    \r\n}\r\n\r\n \r\n\r\n\r\nexport const EditMessage = ({messageBody, editMessage, ENSM, \r\n    fileId, fileIDBKey,  loadImageFromIDB,  \r\n    getFile,\r\n                            }) => {\r\n    const [activateEditMode, deactivateEditMode, onMBChange, editMode, editedMessage, isInvalid, charCount] = useHotEditing(messageBody, editMessage, [maxLength1000], 1000) \r\n \r\n\r\n    const [isFetching, setIF] = useState(false)\r\n\r\n    const [fileImageURL, setFIU] = useState(null) // fileIDBValue in fileImageURL \r\n\r\n    useEffect(() => { \r\n        if(!isFetching){ \r\n            console.log(fileIDBKey)  \r\n            if( fileIDBKey && !fileImageURL){ \r\n                console.log(fileIDBKey)  \r\n                setIF(true)\r\n                async function loadFromIdb(fileIDBKey){  \r\n                    console.log('loadFromIdb')\r\n                    let fileIDBValue = await loadImageFromIDB(fileIDBKey) // like  image-chatTypeId-chatId-messageId\r\n                    console.log(\"fileIDBValue for file IDB key: \" + fileIDBKey)\r\n                    console.log(fileIDBValue)\r\n                    setFIU(fileIDBValue) \r\n                    setIF(false)\r\n                }\r\n                loadFromIdb(fileIDBKey)\r\n            }\r\n\r\n        } \r\n    },[fileIDBKey, loadImageFromIDB, fileImageURL, isFetching] ) // по идее запустится только 1 раз после открытия чатдитейл ( )\r\n\r\n\r\n    if(fileIDBKey && fileImageURL===null) return <Preloader/>\r\n\r\n    return ( \r\n            <>\r\n                {!editMode && \r\n                <EditMessageInactive fileId={fileId} activateEditMode={activateEditMode} messageBody={messageBody} \r\n                fileImageURL={fileImageURL} \r\n                // loadFile={loadFile.bind(this)} \r\n                // messageId={messageId}\r\n                loadFile={!fileImageURL ? getFile: undefined} // we cant get file if we already load from idb value for img:src\r\n                ENSM={ENSM}\r\n                \r\n                // downloadFile={downloadFile}\r\n                // imageName={imageName}\r\n                />\r\n                }\r\n                {editMode &&\r\n                <EditMessageActive isInvalid={isInvalid} onMBChange={onMBChange} deactivateEditMode={deactivateEditMode} editedMessage={editedMessage} charCount={charCount} />\r\n                }\r\n            </>  \r\n    )\r\n}\r\n\r\n// tasks\r\n\r\n// url browser add\r\n\r\n// scss change and add\r\n\r\n// validator create message make XoR-able\r\n\r\n// photo and tap open in that window\r\n\r\n","import React, {useRef, useImperativeHandle, forwardRef } from 'react';\r\nimport styleMessages from './Message.module.scss';\r\nimport { NavLink } from 'react-router-dom';\r\nimport { convertTime } from '../../common/utils/convertTime';\r\nimport { EditMessage } from './EditMessage';\r\n\r\n\r\n// add readed and local and functions to operate with msgs\r\nconst Message = (props, ref) => {\r\n    const inputRef = useRef();\r\n    useImperativeHandle(ref, (node) => {\r\n    //   focus: () => {\r\n    //     inputRef.current.focus();\r\n    //   }\r\n        // console.log('useImperativeHandle')\r\n        // console.log(node)\r\n        // console.log(inputRef.current)\r\n        return inputRef.current\r\n    });\r\n    \r\n    const { message, editMessageRequest, deleteMessageRequest, ENSM, chatTypeId, chatId, getFile, downloadFile} = props\r\n    // console.log( message.fileId)\r\n    const editMessage = (chatTypeId, chatId,  message) => (messageBody) => editMessageRequest(chatTypeId, chatId, message.id, messageBody)\r\n    \r\n    const onDeleteMsg = () => {\r\n        deleteMessageRequest(chatTypeId, chatId, message.id, message.fileId)\r\n    }\r\n\r\n    \r\n    // just add /br for unread msgs  \r\n    return <div className={`${styleMessages.message}`} ref={inputRef}>\r\n        <div className={styleMessages.messageAuthorName}>\r\n            <NavLink to={`/profile/${message.authorId}`}>{message.authorName}</NavLink>\r\n        </div>\r\n        <EditMessage ENSM={ENSM} editMessage={editMessage(chatTypeId, chatId, message)} messageBody={message.body} getFile={getFile} downloadFile={downloadFile} fileId={message.fileId}\r\n        \r\n        // saveImageToIDB={props.saveImageToIDB}\r\n        loadImageFromIDB={props.loadImageFromIDB}\r\n\r\n        fileIDBKey={message.fileIDBKey}\r\n\r\n        // messageId={message.id}\r\n        \r\n        />\r\n        <div className={styleMessages.messageSendedEdited}>\r\n            <div className={styleMessages.messageSended}>sended: {convertTime(message.sended)}</div>\r\n            <div className={styleMessages.messageEdited}>edited: {convertTime(message.edited)}</div>\r\n        </div>\r\n        <div className={styleMessages.deleteMessage}>{!ENSM && <a onClick={onDeleteMsg}>Delete Message</a>}</div>\r\n        </div>\r\n}\r\n\r\nexport default forwardRef(Message);\r\n","import React, {useState}  from 'react';\r\nimport styles from '../../common/FormsControls/FormsControls.module.scss'\r\nimport { createField, TextArea, FileInput, Input } from '../../common/FormsControls/FormsControls';\r\nimport { maxLength1000 } from '../../../utils/validators/validators';\r\nimport { reduxForm } from 'redux-form';\r\nimport { compose } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport withAuthRedirect from '../../../hoc/WithAuthRedirect';\r\nimport { createMessageRequest  } from '../../../redux/chats-reducer';\r\n\r\nimport styleMessages from './Message.module.scss'; \r\nimport { useRef } from 'react';\r\n\r\n\r\nconst styleButtons = {\r\n    visibility: \"hidden\"\r\n}\r\n\r\nconst CreateMessageForm = props => {\r\n    const { handleSubmit, pristine, reset, submitting, error } = props\r\n    \r\n    const refSubmit = useRef(null);\r\n\r\n    const onCTRLEnt = (e) => {\r\n        if(e.keyCode===13 && e.ctrlKey){  \r\n            e.target.value += '\\r\\n';\r\n        } else if(e.keyCode===13) { \r\n            refSubmit.current.click()\r\n        }\r\n    } \r\n\r\n    // TIP there is problems\r\n    return (\r\n        <form onSubmit={handleSubmit} className={styles.redux_form}  > \r\n            {createField('Write a message...', 'messageBody', TextArea, [maxLength1000], {onCTRLEnt: onCTRLEnt.bind(this)})}\r\n            {createField('Upload a file...', 'uploadedFile', FileInput, null, {type: \"file\"})}  \r\n            {\r\n            error && \r\n            <div className={styles.formSummaryError}>\r\n                {error}\r\n            </div>\r\n            }\r\n            <div className={ styles.formButtons}> \r\n                <button type='button' disabled={pristine || submitting} onClick={reset}>Clear</button>\r\n                <button type='submit' disabled={pristine || submitting} ref={refSubmit}>Send</button>\r\n            </div> \r\n        </form>\r\n    )\r\n}\r\n\r\n\r\n// const msgCreationStyleForm = {\r\n//     color: 'green'\r\n// }\r\n\r\nconst CreateMessageReduxForm = reduxForm({form: 'CreateMessage'})(CreateMessageForm)\r\n\r\nconst CreateMessage = (props) => {\r\n    const onSubmit = (formData) => {\r\n        if(!formData['messageBody'] && formData[\"uploadedFile\"]){\r\n            formData['messageBody'] = ' '\r\n        }\r\n        formData[\"uploadedFile\"] ?\r\n            props.createMessageRequest(props.chatTypeId, props.chatId, formData[\"messageBody\"], formData[\"uploadedFile\"]) :\r\n            props.createMessageRequest(props.chatTypeId, props.chatId, formData[\"messageBody\"])\r\n    }\r\n    return ( \r\n        <>\r\n            <div className={styleMessages.createMessageFormH}>Message</div>\r\n            <CreateMessageReduxForm onSubmit={onSubmit}/>   \r\n        </>\r\n    )\r\n}\r\n\r\n\r\nexport default compose(\r\n    withAuthRedirect,\r\n    connect(null, {createMessageRequest}),\r\n)(CreateMessage);\r\n","\r\n/* eslint-disable jsx-a11y/alt-text */\r\n/* eslint-disable no-sequences */\r\n/* eslint-disable jsx-a11y/anchor-is-valid */\r\nimport React, { useEffect, useState, useRef, useCallback, useReducer } from 'react';\r\nimport { compose } from 'redux';\r\nimport withAuthRedirect from '../../../hoc/WithAuthRedirect';\r\nimport { withRouter } from 'react-router-dom';\r\nimport { connect } from 'react-redux';\r\nimport { getMessages, editMessageRequest, deleteMessageRequest, getCurrentChatData,\r\n        clearChatMyLocal, clearChatMyGlobal, clearChatAllLocal, clearChatAllGlobal,\r\n        toogleMemberStatus, removeMemberMsgs, removeOneMemberMsg, removeMember,\r\n        setChatPhotoRequest, addMember, renameChatRequest, \r\n        getFile, setRefreshMessageCreating, \r\n        // saveImageToIDB, \r\n        loadImageFromIDB, \r\n        // setRefreshAfterDM,\r\n\r\n        // setOldMsgsDonwload, \r\n        // fetchMoreOldMsgs\r\n     } from '../../../redux/chats-reducer';\r\nimport Preloader from '../../common/Preloader/Preloader';\r\nimport { selectChatMessages, selectCIPS, selectCTIPS, selectCurrentChat, selectFocusedWindowAddUserForChat, selectFocusedWindowMembersForChat, selectFocusedWindowMemberOperationsForChat } from '../../../redux/chats-selector';\r\nimport Message from '../Message/Message';\r\n\r\n\r\nimport styleMessages from '../Message/Message.module.scss';\r\nimport styleChats from '../Chats.module.scss';\r\nimport CreateMessage from '../Message/CreateMessage'; \r\nimport { ChangeChatPhoto, RenameChat, Member, Members, SelectMemberToChat } from './ChatItem';\r\nimport { addFocusedWindow, clearCurrentFocusedWindow } from '../../../redux/app-reducer';\r\n\r\n\r\n\r\n\r\n\r\nconst getMessageTagWithRef = (data, refCondition, withNewMsgsTag=false, NMTRefCondition=null) => {\r\n    if(!withNewMsgsTag) return (<Message message={data.msg} key={data.msg.id}\r\n                                ref={refCondition} // OMD_PSR_CBCB(msg.id)\r\n                                deleteMessageRequest={data.deleteMessageRequest} \r\n                                editMessageRequest={data.editMessageRequest} ENSM={!data.msg.local}\r\n                                chatTypeId={data._chatTypeId} chatId={data._chatId} getFile={data.getFile}\r\n                                // saveImageToIDB={data.saveImageToIDB} \r\n                                loadImageFromIDB={data.loadImageFromIDB}/>)\r\n    \r\n    return [\r\n        <div className={`${styleMessages.newMsgsStartTag}`} \r\n        ref={NMTRefCondition}>----------UNREAD MESSAGES----------</div>,\r\n        // rasCBCB1()\r\n        <Message message={data.msg} key={data.msg.id} \r\n        ref={refCondition} // OMD_PSR_CBCB(msg.id)\r\n                deleteMessageRequest={data.deleteMessageRequest} \r\n                editMessageRequest={data.editMessageRequest} ENSM={!data.msg.local}\r\n                chatTypeId={data._chatTypeId} chatId={data._chatId} getFile={data.getFile}\r\n                // saveImageToIDB={data.saveImageToIDB} \r\n                loadImageFromIDB={data.loadImageFromIDB}/>\r\n        ]\r\n}\r\n\r\n// setRefreshAfterDM /\r\n\r\n\r\n\r\n\r\n// ......  numOfDeletedMsgs - счетчик удаленных сообщений чтоб послать в рефрещ\r\nconst ChatDetail = ({getCurrentChatData, getMessages, IsFetchingMsgs,  \r\n    setRefreshMessageCreating, \r\n    // setRefreshAfterDM, // functions\r\n    chatTypeId:_chatTypeId, chatId:_chatId, readFromIndexNext:_readFromIndexNext, readFromIndex:_readFromIndex, // state\r\n    windowScrollOnMsgCreate, isMessageCreating, isRefreshedAfterMC, \r\n    numOfDeletedMsgs,\r\n    \r\n    // saveImageToIDB,\r\n    loadImageFromIDB,\r\n\r\n    ...props}) => {  // other props\r\n\r\n    const [oldMsgsDonwload, setOldMsgsDonwload] = useState(false, 'oldMsgsDonwload'); \r\n    const [preFetch, setPreFetch] = useState(false, 'preFetch');  /// +\r\n    const [selectedMember, setSelectedMember] = useState(null, 'selectedMember') /// using in child functions (so dont check it now)   -\r\n    const [refToTopAtStart, setRTTAS] = useState(true,  'refToTopAtStart')  ///\r\n    const [positioningScrollRefScroll, setPSRS] = useState(false, 'positioningScrollRefScroll') \r\n    \r\n    // old message download positional scrol ref\r\n    const refOMDPSR = useRef(null) // this ref node always had loadOldMsgsDiv part of oclass ( we can write here not only node, but object {'node':node, classPart:'loadOldMsgsDiv'})\r\n    const refAtStart = useRef(null) // ref -> refAtStart\r\n    const refToObserve = useRef(null) // from refAtStartCB and \r\n\r\n    const [refreshIsRunning, setRIR] = useState(false)\r\n\r\n\r\n    // const [loadingOnScroll, setLoadingOnScroll] = useState(true) // _readFromIndex !=== _readFromIndexNext\r\n\r\n    // const getMessagesCB = useCallback( async (RFI) => (await getMessages(_chatTypeId, _chatId, RFI, _firstOfSetOfMsgsId )),\r\n    //                                     [ _chatTypeId, _chatId, _firstOfSetOfMsgsId, getMessages ] ) // _prop - mean its from props descruct\r\n\r\n\r\n    // const getRefreshMessagesCB = useCallback( async () => (await getMessagesCB( _readFromIndex )),  [_readFromIndex, getMessagesCB ] ) // _prop - mean its from props descruct\r\n\r\n    // const getOLDMessagesCB = useCallback( async () =>   (await getMessagesCB( _readFromIndexNext )), [ _readFromIndexNext, getMessagesCB ] ) // _prop - mean its from props descruct\r\n\r\n\r\n\r\n    const refLastMsg = useRef(null)\r\n    \r\n    // какой эффект первым напишут - тот первым и исполнится - все топ)))\r\n    // const isUltimateCallbackProcced = useRef(false)\r\n    // isUltimateCallbackProcced.current = false // to set to the aflse each render\r\n\r\n    useEffect(()=>{\r\n        if(preFetch){\r\n            ULTIMATE_CALLBACK( refToTopAtStart ? 'start' : 'notStart',\r\n                                refToTopAtStart ? refAtStart.current : refOMDPSR.current, \r\n                                refToTopAtStart ?  props.currentChat.firstNewMsgID === null : positioningScrollRefScroll && !oldMsgsDonwload,\r\n                                refToObserve.current)\r\n        }\r\n        // isUltimateCallbackProcced.current = true\r\n        // return () => isUltimateCallbackProcced.current === true\r\n    }) // [preFetch, props.currentChat.firstNewMsgID, ]\r\n\r\n    // const wSOMC = useRef(windowScrollOnMsgCreate) // will be last value of prop ( e.i. if we cleanup it data we will check newest data from props to not run it action more then should)\r\n    useEffect(() => {\r\n        // еси не успел исполнится эффект а юзер закрыл страницу - зануляем значение windowScrollOnMsgCreate в редаксе // но по идее этот то пропс будет слепком из прошлого рендера ( потому и будет тру - тоесть иногда мы мб будем зря занулять)\r\n        if(isRefreshedAfterMC){\r\n            if(refLastMsg.current){\r\n                refLastMsg.current.scrollIntoView()\r\n            } else {\r\n                console.log('some wierd error in ref creating for last msg after creation')\r\n            }\r\n            isRefreshedAfterMC && setRefreshMessageCreating(false)\r\n            // isRefreshedAfterDM && setRefreshAfterDM(false)\r\n        }\r\n        // return () => {if(windowScrollOnMsgCreate === true){shouldWindowScrollDown(false)}}\r\n    },[setRefreshMessageCreating, isRefreshedAfterMC]) // setRefreshAfterDM\r\n\r\n    useEffect(()=>{\r\n\r\n        let node = null;\r\n\r\n        const thresholdArray = steps => Array(steps + 1)\r\n            .fill(0)\r\n            .map((_, index) => index / steps || 0)\r\n\r\n        const handleIntersect = (entries, observer) => { // its async??? // no its callback!\r\n            entries.forEach(entry => {\r\n                const isIntersecting = entry.isIntersecting \r\n                console.log('only after scroll calling')\r\n                if(isIntersecting){ \r\n                    // debugger\r\n                    console.log('intersetcion of target(should be true) ')\r\n                    console.log(\"TOP DIV VIEWED: \" + entry.target.innerText) // refToObserve.current.innerText\r\n                    // entry.target.className = entry.target.className.replace(/[^\\s]*loadOldMsgsDiv[^\\s]*/g, ''); // change whole className but regex will take only a part of className (approp class)\r\n                    observer.unobserve(entry.target)\r\n                    \r\n                    setOldMsgsDonwload(true) // toggle proccess for loading old msgs\r\n                }\r\n            })\r\n        }\r\n\r\n        const observer = new IntersectionObserver(handleIntersect, {threshold: thresholdArray(2)})\r\n\r\n\r\n        \r\n        if(refToObserve.current && preFetch && ((!positioningScrollRefScroll && !oldMsgsDonwload) || (refToTopAtStart))){ \r\n            node = refToObserve.current\r\n            observer.observe(node); // its event.target\r\n        }\r\n\r\n\r\n        return () => node !==null && observer.unobserve(node);\r\n    }, [positioningScrollRefScroll, oldMsgsDonwload, refToTopAtStart, preFetch])// it will call every render and it okay//,[setOldMsgsDonwload, preFetch, refToTopAtStart]) \r\n\r\n\r\n\r\n    const ULTIMATE_CALLBACK = (nodeToScrollType, nodeToScroll, conditionNTS, nodeToObserve)=> {\r\n        if(nodeToScroll ==null) return \r\n            if(nodeToScrollType==='start'){\r\n                // debugger\r\n                if(conditionNTS){\r\n                    nodeToScroll.scrollTop = nodeToScroll.scrollHeight  \r\n                } else {\r\n                    nodeToScroll.scrollIntoView()\r\n                } \r\n                // refToObserveCB()\r\n                setRTTAS(false)\r\n            } else {\r\n                if(conditionNTS){\r\n                    // debugger\r\n                    nodeToScroll.scrollIntoView()\r\n                    setPSRS(false)\r\n                }\r\n            }\r\n    }\r\n\r\n\r\n    useEffect(() => { ////////////////////////////////////////////// (PF)\r\n        console.log('should run 2 times only (preFetch)') \r\n        if( !preFetch ){//&& !props.IsFetchingMsgs){ \r\n            const populatePreFetchData = async() => {\r\n                await getCurrentChatData();\r\n                setPreFetch(true);\r\n            }\r\n            populatePreFetchData();\r\n        }\r\n    }, [preFetch, getCurrentChatData])\r\n\r\n    useEffect(() => {/////////////////////////////////////////////////// (RD)\r\n            // if(preFetch) {\r\n            let sTOID = null\r\n            // console.log(\"refreshIsRunning\")\r\n            // console.log(refreshIsRunning)\r\n            if(!refreshIsRunning){\r\n            sTOID = setTimeout( async () => {\r\n                // setRIR(true)\r\n                if( !oldMsgsDonwload && preFetch && !IsFetchingMsgs && !positioningScrollRefScroll){\r\n                    // debugger\r\n                    setRIR(true)\r\n                    // let currentdate = new Date(); \r\n                    // let datetime = \"Last Sync: \" + currentdate.getDate() + \"/\"\r\n                    // + (currentdate.getMonth()+1)  + \"/\" \r\n                    // + currentdate.getFullYear() + \" @ \"  \r\n                    // + currentdate.getHours() + \":\"  \r\n                    // + currentdate.getMinutes() + \":\" \r\n                    // + currentdate.getSeconds();\r\n                    // console.log(datetime)\r\n                    await getMessages(_chatTypeId, _chatId, _readFromIndex, props.readFromIndexBefore, null, (windowScrollOnMsgCreate && !isMessageCreating), numOfDeletedMsgs )\r\n                    setRIR(false)\r\n                } \r\n            }\r\n            , 1500) }     \r\n            return () => { sTOID !== null && clearTimeout(sTOID); }; \r\n            //  но функция то мы запускаем иммидиатли(потому значения oldMsgsDonwload - текущие!!!!)\r\n        // if(!positioningScrollRefScroll && oldMsgsDonwload && !IsFetchingMsgs){ // если мы должны подгрузить старые сообщ + не грузится пока при рефреше сообщения, то запускаем асинх функцию\r\n        }, [preFetch, oldMsgsDonwload, IsFetchingMsgs, positioningScrollRefScroll,\r\n            _chatTypeId, _chatId, _readFromIndex, props.readFromIndexBefore, getMessages,\r\n            windowScrollOnMsgCreate, isMessageCreating, numOfDeletedMsgs, refreshIsRunning]) //  for what oldMsgsDonwload ???? if msgs not fetching yet ( but process of getOLDMessagesCB is started ( but async so can не успеть зарундерится))\r\n        // IsFetchingMsgs dont need (cause only 2 effects - FOM and RD -> if FOM processing (oldMsgsDonwload) => u can use RD and vise versa)\r\n\r\n\r\n    useEffect(() => { // (FOM)\r\n\r\n        if(!positioningScrollRefScroll && oldMsgsDonwload && !IsFetchingMsgs){ // если мы должны подгрузить старые сообщ + не грузится пока при рефреше сообщения, то запускаем асинх функцию\r\n            const fetchOldMsgs = async() => { \r\n                await getMessages(_chatTypeId, _chatId, _readFromIndexNext, _readFromIndex )\r\n                // setPSRS(false)\r\n                setOldMsgsDonwload(false) \r\n\r\n                // if(_readFromIndexNext === _readFromIndex){\r\n                //     setLoadingOnScroll(false) \r\n                // }\r\n            }\r\n            setPSRS(true)\r\n            // debugger\r\n            fetchOldMsgs()\r\n        }\r\n        // написать отмену загрузки данных (сообщений с АПИ)\r\n        // return () => {} // после того как заканчивается эффект в котором условие исполнилось но не успело заверишся действие \r\n    }, [IsFetchingMsgs, positioningScrollRefScroll, oldMsgsDonwload, setOldMsgsDonwload, setPSRS,\r\n        _chatTypeId, _chatId, _readFromIndexNext, _readFromIndex, getMessages])\r\n  \r\n//|| props.oldMsgsDonwload\r\n    if (!preFetch){ return <Preloader />} else {\r\n        if(numOfDeletedMsgs > 0){\r\n            console.log(\"numOfDeletedMsgs\")\r\n            console.log(numOfDeletedMsgs)\r\n        }\r\n    // ----------Get Older Messages----------\r\n    let beforeMsgsDiv = (_readFromIndexNext !== _readFromIndex) ? (<div className={`${styleMessages.loadOldMsgsDiv}`} ref={refToObserve}></div>) : \r\n                                                (<div className={`${styleMessages.startChatDiv}`}>----------Chat Start----------</div>)\r\n\r\n    // но после каждого updateUnreadMsgs - props.messages[index-1].msgViewed === true - потому делаем апдейт только после  выхода из чата ( в локалстейте хранится индекс последнего сообщения прочитанного и по нему обновление идет)\r\n    \r\n    let messages = props.messages.map((msg, index) => \r\n                                        {\r\n                                            let dataToMsg = {msg:msg, getFile:props.getFile, _chatId:_chatId, _chatTypeId:_chatTypeId,\r\n                                                editMessageRequest:props.editMessageRequest, deleteMessageRequest:props.deleteMessageRequest,\r\n                                                // saveImageToIDB:saveImageToIDB, \r\n                                                loadImageFromIDB:loadImageFromIDB }\r\n\r\n                                            if(props.currentChat.firstNewMsgID!==null && props.currentChat.firstNewMsgID <= msg.id && \r\n                                                (index === 0 || props.messages[index-1].id < props.currentChat.firstNewMsgID ))\r\n                                            {// return list of 2 elems\r\n                                                return getMessageTagWithRef(dataToMsg, (msg.id === props.readFromIndexBefore && positioningScrollRefScroll ? refOMDPSR : undefined),\r\n                                                true,  (props.currentChat.firstNewMsgID !== null && refToTopAtStart ? refAtStart : undefined))\r\n                                            } else {\r\n                                                if(index === props.messages.length - 1){\r\n                                                    // if message already created and we should after that scroll -> do that then discard wsomc value to false \r\n                                                    return getMessageTagWithRef(dataToMsg, (isRefreshedAfterMC  ? refLastMsg : undefined))\r\n                                                } else {\r\n                                                    return getMessageTagWithRef(dataToMsg, (msg.id === props.readFromIndexBefore && positioningScrollRefScroll ? refOMDPSR : undefined))\r\n                                                }\r\n                                            }\r\n                                            }).flat()  // if we create newMsgsStartTag additional tag\r\n    messages.unshift(beforeMsgsDiv) // add div before first msg                                           \r\n    // if(messages.length < 3){ // сообщений становится ноль после удаления (иногда) - после этого надо запустить процес прогрузки старых сообщений \r\n    //     debugger\r\n    // }\r\n    const prefetchOper = (method, chatTypeId, chatId) => (selectedMemberId)  => () => method(chatTypeId, chatId, selectedMemberId)\r\n    let memberOpers = [{method: props.toogleMemberStatus, name: 'Toogle Member'}, {method: props.removeMemberMsgs, name: 'Remove All Member Messages'}, {method: props.removeMember, name: 'Remove Member'}]\r\n    let chatUsersIds = props.currentChat.members.map(member => member.id)\r\n\r\n    \r\n    let members = _chatTypeId === 1 \r\n                    ? \r\n                    props.currentChat.members.map(member => <Member member={member} key={member.id} memberStyle={`${styleMessages.chatMember}`} \r\n                        chatMemberSettings={`${styleMessages.chatMemberSettings}`}\r\n                        setMemberOperShow={(event) => (event.stopPropagation(), props.addFocusedWindow(props.fWMOFC.id, true))}\r\n                        addFocusedWindow={props.addFocusedWindow}\r\n                        fWMOFC={props.fWMOFC}\r\n                        setSelectedMember={setSelectedMember}/>)\r\n                    :\r\n                    props.currentChat.members.map(member => <Member member={member} key={member.id}/>)\r\n\r\n                    \r\n    return (\r\n        <>\r\n        {\r\n        props.fWAUFC.data !== null  && \r\n        <div className={styleChats.addMember}>\r\n            <SelectMemberToChat addMember={props.addMember} chatTypeId={_chatTypeId} chatId={_chatId} chatUsersIds={chatUsersIds} \r\n            fWAUFC={props.fWAUFC} clearCurrentFocusedWindow={props.clearCurrentFocusedWindow} />\r\n        </div>\r\n        } \r\n        <div className={styleMessages.currentChat}>\r\n            \r\n                <Members members={members} \r\n                membersShow={props.fWMFC.data} \r\n                memberOperShow={props.fWMOFC.data} \r\n                selectedMember={selectedMember}\r\n                memberOpers={memberOpers\r\n                    .map(memberOper => ({...memberOper, \r\n                        method: prefetchOper(memberOper.method, _chatTypeId, _chatId) }))}/>\r\n \r\n            <div className={styleMessages.chatsHeader}>\r\n                <div className={styleMessages.chatsHeaderPhoto}> {props.currentChat.chatPhoto.small !== null ? <img src={props.currentChat.chatPhoto.small} /> : <div className={styleMessages.chatsHeaderPhotoAlt}>chatPhotoSmall</div>}</div>\r\n                <div className={styleMessages.chatsHeaderName}>{props.currentChat.name}</div>\r\n                <div className={styleMessages.chatsHeaderSettings}>\r\n                    Settings\r\n                    <div className={styleMessages.chatsSettings}>\r\n                    { _chatTypeId === 1 &&\r\n                        <>\r\n                            <div className={styleMessages.chatsSettingsItem}>\r\n                                {props.fWAUFC.data === null  &&\r\n                                    <a className={styleChats.getMemberList}\r\n                                        onClick={\r\n                                            (event) => (event.stopPropagation(), props.addFocusedWindow(props.fWAUFC.id, [_chatTypeId, _chatId]))\r\n                                         }\r\n                                        > \r\n                                            Add Member\r\n                                        </a>\r\n                                }\r\n                            </div>\r\n                            <div className={styleMessages.chatsSettingsItem}>\r\n                                <div className={styleMessages.chatsSettingsItemH}>Change Photo</div>\r\n                                <ChangeChatPhoto msgStyle={styleMessages.chatsSettingsItemForm} setChatPhotoRequest={props.setChatPhotoRequest} chatTypeId={_chatTypeId} chatId={_chatId} />\r\n                            </div> \r\n                            <div className={styleMessages.chatsSettingsItem}>\r\n                            <div className={styleMessages.chatsSettingsItemH}>Rename Chat</div>\r\n                                <RenameChat msgStyle={styleMessages.chatsSettingsItemForm} renameChatRequest={props.renameChatRequest} chatTypeId={_chatTypeId} chatId={_chatId}/>\r\n                            </div> \r\n                        </>\r\n                    } \r\n                        <div className={styleMessages.chatsSettingsItem}>\r\n                            < >\r\n                                {\r\n                                props.fWMFC.data === null &&\r\n                                <a onClick={(event)=>(event.stopPropagation(), props.addFocusedWindow(props.fWMFC.id, true))}>\r\n                                    Chat Members\r\n                                </a>\r\n                                }\r\n                            </ >\r\n                        </div>\r\n                    \r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n \r\n            {/* event or event.target TODO*/}\r\n            \r\n        <div className={styleMessages.messages} ref={\r\n            // delete this ref if refToTopAtStart is already precced before (cause we dont nedd to posit again) so use \"\"\"&& refToTopAtStart\"\"\"\r\n            // rasCBCB1(props.currentChat.firstNewMsgID , refToTopAtStart) /// ref={undefined} -> знач что наша ссыль оставила привзяку на старого рендера елемент(тег)\r\n            props.currentChat.firstNewMsgID === null && refToTopAtStart ? refAtStart : undefined }>\r\n                {messages}\r\n                {/* <h1>{refToTopAtStart + 'is it okay refToTopAtStart ??????'}</h1> */}\r\n        </div>\r\n            {/* { ULTIMATE_CALLBACK( refToTopAtStart ? 'start' : 'notStart',\r\n                            refToTopAtStart ? refAtStart.current : refOMDPSR.current, \r\n                            refToTopAtStart ?  props.currentChat.firstNewMsgID === null : positioningScrollRefScroll && !oldMsgsDonwload,\r\n                             refToObserve.current)} */}\r\n\r\n\r\n                             \r\n        {/* <h3 className={styleMessages.trash} ref={() => ULTIMATE_CALLBACK( refToTopAtStart ? 'start' : 'notStart',\r\n                            refToTopAtStart ? refAtStart.current : refOMDPSR.current, \r\n                            refToTopAtStart ?  props.currentChat.firstNewMsgID === null : positioningScrollRefScroll && !oldMsgsDonwload,\r\n                             refToObserve.current)}>Trash</h3> */}\r\n\r\n\r\n        {/* when all ref tag elems rendered call it -> to make operations over that refs */}\r\n        <div className={styleMessages.createMessageForm}><CreateMessage chatTypeId={_chatTypeId} chatId={_chatId} isAuth={props.isAuth}/></div>\r\n\r\n\r\n            \r\n        </div>\r\n        </>\r\n            )\r\n        }\r\n}\r\n\r\n\r\nlet mapStateToProps = (state) => ({\r\n    messages: selectChatMessages(state),\r\n    isAuth: state.auth.isAuth,\r\n    chatTypeId: selectCTIPS(state),\r\n    chatId: selectCIPS(state),\r\n    currentChat: selectCurrentChat(state),\r\n\r\n    fWAUFC: selectFocusedWindowAddUserForChat(state),\r\n    fWMFC: selectFocusedWindowMembersForChat(state),\r\n    fWMOFC: selectFocusedWindowMemberOperationsForChat(state),\r\n\r\n\r\n    readFromIndexNext: state.chatsPage.readFromIndexNext,\r\n    readFromIndex: state.chatsPage.readFromIndex,\r\n    readFromIndexBefore: state.chatsPage.readFromIndexBefore,\r\n    IsFetchingMsgs: state.chatsPage.IsFetchingMsgs,\r\n\r\n    windowScrollOnMsgCreate: state.chatsPage.windowScrollOnMsgCreate,\r\n    isMessageCreating: state.chatsPage.isMessageCreating,\r\n    isRefreshedAfterMC: state.chatsPage.isRefreshedAfterMC,\r\n    numOfDeletedMsgs: state.chatsPage.numOfDeletedMsgs,\r\n})\r\n\r\nexport default compose(\r\n    withAuthRedirect,\r\n    connect(mapStateToProps, { getMessages, editMessageRequest, deleteMessageRequest,\r\n                                getCurrentChatData,\r\n                                clearChatMyLocal, clearChatMyGlobal, clearChatAllLocal, clearChatAllGlobal,\r\n                                toogleMemberStatus, removeMemberMsgs, removeOneMemberMsg, removeMember,\r\n                                setChatPhotoRequest, addMember, renameChatRequest,\r\n\r\n                                addFocusedWindow, clearCurrentFocusedWindow,\r\n\r\n                                getFile,  \r\n                                setRefreshMessageCreating,\r\n\r\n                                // saveImageToIDB,\r\n                                loadImageFromIDB,\r\n\r\n\r\n                            }),\r\n    withRouter\r\n)(ChatDetail)\r\n\r\n \r\n\r\n// pre render page effect useLayoutEffect\r\n// post render page effect useEffect\r\n\r\n\r\n","import React, { useEffect } from 'react';\r\nimport './App.scss';\r\nimport Header from './components/Header/Header';\r\nimport Navbar from './components/Navbar/Navbar';\r\nimport { Route, withRouter } from \"react-router-dom\";\r\nimport ChatsContainer from './components/Chats/ChatsContainer';\r\nimport UsersContainer from './components/Users/UsersContainer';\r\nimport Profile from './components/Profile/Profile';\r\nimport Login from './components/Login/Login';\r\nimport UpdateProfile from './components/Profile/UpdateDeleteProfile/UpdateProfile';\r\nimport Preloader from './components/common/Preloader/Preloader';\r\nimport { initializeApp, clearAllFocusedWindows } from './redux/app-reducer';\r\nimport { compose } from 'redux';\r\nimport { connect } from 'react-redux';\r\nimport ChatDetail from './components/Chats/ChatItem/ChatDetail'; \r\n\r\nconst App = React.memo((props) => {\r\n\r\n        console.log('rerender') \r\n        console.log(props.initialized)\r\n        useEffect(() => {props.initializeApp()}, [])\r\n        if((!props.initialized)) return <Preloader/>\r\n        return (\r\n                <div className='whole-app-page-wrapper' onClick={()=>{ props.clearAllFocusedWindows()   }}>\r\n                <div className='app-wrapper'> \r\n                        <Header />\r\n                        <Navbar />\r\n                        <div className='app-wrapper-content'>\r\n                        <div className='content-background'></div>\r\n\r\n                        <Route path='/profile/:userId?'\r\n                                        render={() => <Profile />} />\r\n                        <Route path='/profile_update'\r\n                                render={() => <UpdateProfile />} />\r\n                        <Route path='/login' render={() => <Login />} />\r\n                        <Route path='/users'\r\n                                render={() => <UsersContainer />} />\r\n                        <Route exact path='/chats'\r\n                                render={() => <ChatsContainer  />} />\r\n                        <Route path='/chats/:chatType/:name?'\r\n                                render={() => <ChatDetail  />} />\r\n                        </div>\r\n                </div>\r\n                </div>\r\n\r\n        )\r\n})\r\n\r\nconst mapStateToProps = (state) => ({\r\n        initialized: state.app.initialized,\r\n});\r\n\r\nexport default compose( \r\n        withRouter,\r\n        connect(mapStateToProps, {initializeApp,\r\n                clearAllFocusedWindows\r\n        })\r\n )(App);\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","let initialState = {};\r\n\r\nconst sidebarReducer = (state = initialState, action) => {\r\n    return state;\r\n}\r\n\r\nexport default sidebarReducer;","import {applyMiddleware, combineReducers, createStore, compose} from \"redux\";\r\nimport {reducer as formReducer} from \"redux-form\";\r\n\r\nimport profileReducer from \"./profile-reducer\";\r\nimport chatsReducer from \"./chats-reducer\";\r\nimport sidebarReducer from \"./sidebar-reducer\";\r\nimport usersReducer from \"./users-reducer\";\r\nimport authReducer from \"./auth-reducer\";\r\nimport thunkMiddleware from \"redux-thunk\";\r\nimport appReducer from \"./app-reducer\";\r\n\r\nlet reducers = combineReducers({\r\n    profilePage: profileReducer,\r\n    chatsPage: chatsReducer,\r\n    sidebar: sidebarReducer,\r\n    usersPage: usersReducer,\r\n    auth: authReducer,\r\n    form: formReducer,\r\n    app: appReducer,\r\n});\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\nconst store = createStore(reducers, composeEnhancers(applyMiddleware(thunkMiddleware)));\r\n\r\nwindow.__store__ = store;\r\nexport default store;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nimport {BrowserRouter, HashRouter} from \"react-router-dom\"; \r\nimport store from './redux/redux-store';\r\nimport { Provider } from 'react-redux'; \r\n\r\nimport reactDebugHooks from 'react-debug-hooks'\r\nreactDebugHooks(React)\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\n \r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <HashRouter> \r\n\r\n    <Provider store={store} >\r\n      <App/>\r\n    </Provider>\r\n    </HashRouter>\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n  ); \r\n\r\nserviceWorker.unregister();\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"profile_info\":\"ProfileInfo_profile_info__26r6R\",\"landi_block\":\"ProfileInfo_landi_block__3C4fp\",\"descriptionBlock\":\"ProfileInfo_descriptionBlock__27yTJ\",\"ava_block\":\"ProfileInfo_ava_block__2Rpvd\",\"username\":\"ProfileInfo_username__1YfRh\",\"userinfo\":\"ProfileInfo_userinfo__25_Nl\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"currentChat\":\"Message_currentChat__1ON5H\",\"chatsHeaderPhoto\":\"Message_chatsHeaderPhoto__3KmFL\",\"message\":\"Message_message__XbAWd\",\"chatsHeader\":\"Message_chatsHeader__3_7BC\",\"chatsHeaderPhotoAlt\":\"Message_chatsHeaderPhotoAlt__345-N\",\"chatsHeaderName\":\"Message_chatsHeaderName__1p2HE\",\"chatsHeaderSettings\":\"Message_chatsHeaderSettings__4TgjU\",\"chatsSettings\":\"Message_chatsSettings__2ENur\",\"chatsSettingsItem\":\"Message_chatsSettingsItem__2SVEL\",\"chatsSettingsItemForm\":\"Message_chatsSettingsItemForm__aVO9o\",\"chatsSettingsItemH\":\"Message_chatsSettingsItemH__2o63j\",\"messages\":\"Message_messages__3HWZ0\",\"messageAuthorName\":\"Message_messageAuthorName__1cVdS\",\"messageBody\":\"Message_messageBody__2Wdgx\",\"messageSendedEdited\":\"Message_messageSendedEdited__3373j\",\"messageSended\":\"Message_messageSended__H2dY7\",\"messageEdited\":\"Message_messageEdited__92HVJ\",\"messageFile\":\"Message_messageFile__2S4Qt\",\"deleteMessage\":\"Message_deleteMessage__3FS2L\",\"createMessageForm\":\"Message_createMessageForm__3DdyB\",\"createMessageFormH\":\"Message_createMessageFormH__1b5Ip\",\"editMessage\":\"Message_editMessage__1TmwA\",\"editField\":\"Message_editField__2EuAr\",\"errorField\":\"Message_errorField__3g5s-\",\"countChars\":\"Message_countChars__3nCoj\",\"chatsMembersActive\":\"Message_chatsMembersActive__1DOqr\",\"chatMember\":\"Message_chatMember__zXlWp\",\"chatMemberSettings\":\"Message_chatMemberSettings__1K7u5\",\"chatsMembers\":\"Message_chatsMembers__1cNBf\",\"fileImageActivate\":\"Message_fileImageActivate__3RbsQ\",\"fileImageDeactivate\":\"Message_fileImageDeactivate__1M42n\",\"usersForChatActive\":\"Message_usersForChatActive__1VVh3\",\"userForChat\":\"Message_userForChat__8hQzz\",\"loadOldMsgsDiv\":\"Message_loadOldMsgsDiv__3w6Hg\",\"startChatDiv\":\"Message_startChatDiv__30ils\",\"newMsgsStartTag\":\"Message_newMsgsStartTag__bWpwv\",\"smthElseListActive\":\"Message_smthElseListActive__2LMiK\",\"infoItemMSBs\":\"Message_infoItemMSBs__193yQ\",\"subElemMSBs\":\"Message_subElemMSBs__d_qe5\",\"membOperLink\":\"Message_membOperLink__2DVEZ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"profile_wrapper\":\"Profile_profile_wrapper__1hZ3w\",\"profile_update\":\"Profile_profile_update__2LMYG\",\"profile_update_header\":\"Profile_profile_update_header__3eGmb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"chats\":\"Chats_chats__1TXJD\",\"chats_header\":\"Chats_chats_header__39r5-\",\"chatsItems\":\"Chats_chatsItems__1zzrp\",\"createChat\":\"Chats_createChat__dOG1Y\",\"addMember\":\"Chats_addMember__2ZiZA\",\"getMemberList\":\"Chats_getMemberList__22K5E\",\"addMemberHeader\":\"Chats_addMemberHeader__i-mHV\",\"createChatHeader\":\"Chats_createChatHeader__35c86\",\"createChatForm\":\"Chats_createChatForm__2Fe3r\",\"chatItem\":\"Chats_chatItem__XzdbY\",\"chatItemData\":\"Chats_chatItemData__3E3Yr\",\"chatItemPhoto\":\"Chats_chatItemPhoto__3_Xxx\",\"chatLMBody\":\"Chats_chatLMBody__Sw_M_\",\"chatLMSended\":\"Chats_chatLMSended__20eE7\",\"chatLMAuthorName\":\"Chats_chatLMAuthorName__1ioDB\",\"chatLMAuthorNameDotted\":\"Chats_chatLMAuthorNameDotted__-UvRr\",\"chatItemNewMsgsNum\":\"Chats_chatItemNewMsgsNum__16sqK\",\"chatItemName\":\"Chats_chatItemName__B8lls\",\"member\":\"Chats_member__YJosT\",\"memberName\":\"Chats_memberName__15vrK\",\"memberPhoto\":\"Chats_memberPhoto__1exYC\",\"chatSettings\":\"Chats_chatSettings__3IskM\",\"chatSettingsMembersList\":\"Chats_chatSettingsMembersList__1LgvV\",\"smthElseList\":\"Chats_smthElseList__3SIbd\",\"subElem\":\"Chats_subElem__1qLPF\",\"subElem2\":\"Chats_subElem2__3OATs\",\"infoItem\":\"Chats_infoItem__wxWf6\",\"deleteChat\":\"Chats_deleteChat__36l2A\",\"renameChatItem\":\"Chats_renameChatItem__3q6ZS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"postsBlock\":\"MyPosts_postsBlock__1mvnH\",\"myPostsHeader\":\"MyPosts_myPostsHeader__3o287\",\"createPost\":\"MyPosts_createPost__1aopr\",\"posts\":\"MyPosts_posts__286uv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__u1mKG\",\"loginBlock\":\"Header_loginBlock__1KTXr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"paginator\":\"paginator_paginator__1CS79\",\"pageNumber\":\"paginator_pageNumber__3o5RD\",\"selectedPage\":\"paginator_selectedPage__NP13K\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"userPhoto\":\"Users_userPhoto__3DatX\",\"userChoosePhoto\":\"Users_userChoosePhoto__28RG5\",\"bottom\":\"Users_bottom__3K9cG\",\"selectedPage\":\"Users_selectedPage__31GKb\"};"],"sourceRoot":""}